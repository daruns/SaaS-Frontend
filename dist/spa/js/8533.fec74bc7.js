"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[8533],{68533:(e,l,a)=>{a.r(l),a.d(l,{default:()=>X});var t=a(83673),o=a(98880);const s={class:"full-width flex justify-between items-center header-height-standard q-px-md",style:{"border-bottom":"1px solid lightgrey"}},i=(0,t._)("div",{class:"text-h4"},"Payslips",-1),n={class:"flex items-center"};function r(e,l,a,r,p,d){const u=(0,t.up)("q-btn"),m=(0,t.up)("tbl"),y=(0,t.up)("payslipModal"),c=(0,t.up)("q-dialog"),g=(0,t.up)("q-scroll-area"),f=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(f,{class:"q-py-none q-my-none"},{default:(0,t.w5)((()=>[(0,t._)("div",s,[i,(0,t._)("div",n,[(0,t.Wm)(u,{onClick:l[0]||(l[0]=e=>p.payslipDialogue=!0),color:"primary",label:"Add "+r.tab[0].toUpperCase()+r.tab.substr(1,r.tab.length),unelevated:"",rounded:"","no-caps":""},null,8,["label"])])]),(0,t.Wm)(g,{style:{"max-height":"auto !important","min-height":"auto !important",height:"calc(100vh - 131px)"},class:"q-px-md"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(m,null,null,512),[[o.F8,!p.table]]),(0,t.Wm)(c,{seamless:"",position:"right",modelValue:p.payslipDialogue,"onUpdate:modelValue":l[2]||(l[2]=e=>p.payslipDialogue=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{onCloseDialogue:l[1]||(l[1]=e=>p.payslipDialogue=!1),actionType:"Add",id:{}})])),_:1},8,["modelValue"])])),_:1})])),_:1})}var p=a(61959),d=a(62323);const u=(0,t._)("h6",{class:"q-pa-md"},"All Employees Payslips",-1),m={class:"q-mr-sm"},y=["src"],c={style:{"font-size":"17px"}},g={style:{"font-size":"17px"}},f={style:{"font-size":"17px"}},h={style:{"font-size":"17px"}},w={style:{"font-size":"17px"}},b=(0,t.Uk)("Generate Slip"),v=(0,t._)("hr",null,null,-1);function _(e,l,a,o,s,i){const n=(0,t.up)("q-avatar"),r=(0,t.up)("q-td"),p=(0,t.up)("q-btn"),_=(0,t.up)("q-tr"),D=(0,t.up)("q-table"),q=(0,t.up)("modal"),x=(0,t.up)("q-dialog"),k=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)("div",null,[u,(0,t.Wm)(D,{rows:i.data,columns:s.columns,"rows-per-page-options":[5,50,100,0],"row-key":"id",loading:s.loading,flat:"",class:"bg-secondary q-pa-md"},{body:(0,t.w5)((l=>[(0,t.Wm)(_,{class:(0,d.C_)(l.rowIndex%2!==0&&"bg-white"),props:l},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{class:"",key:"employeeName",props:l},{default:(0,t.w5)((()=>{var e,a;return[(0,t._)("span",m,[null!==(e=l.row.employee.user)&&void 0!==e&&e.avatar?((0,t.wg)(),(0,t.j4)(n,{key:0},{default:(0,t.w5)((()=>{var e;return[(0,t._)("img",{src:null===(e=l.row.employee.user)||void 0===e?void 0:e.avatar},null,8,y)]})),_:2},1024)):((0,t.wg)(),(0,t.j4)(n,{key:1,color:"grey","text-color":"white",icon:"person"}))]),(0,t._)("span",c,(0,d.zw)(null===(a=l.row.employee)||void 0===a?void 0:a.name),1)]})),_:2},1032,["props"]),(0,t.Wm)(r,{class:"",key:"employeeEmail",props:l},{default:(0,t.w5)((()=>{var e,a;return[(0,t._)("p",g,(0,d.zw)(null===(e=l.row.employee)||void 0===e||null===(a=e.user)||void 0===a?void 0:a.email),1)]})),_:2},1032,["props"]),(0,t.Wm)(r,{class:"",key:"fromDate",props:l},{default:(0,t.w5)((()=>[(0,t._)("p",f,(0,d.zw)(s.dateFunc.formatDate(new Date(l.row.fromDate),"YYYY MMM")),1)])),_:2},1032,["props"]),(0,t.Wm)(r,{class:"",key:"salary",props:l},{default:(0,t.w5)((()=>[(0,t._)("p",h,(0,d.zw)(l.row.employee.salary),1)])),_:2},1032,["props"]),(0,t.Wm)(r,{class:"",key:"createdAt",props:l},{default:(0,t.w5)((()=>[(0,t._)("p",w,(0,d.zw)(s.dateFunc.formatDate(new Date(l.row.createdAt),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,t.Wm)(r,{class:"justify-end text-right",key:"actions",props:l},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(p,{flat:"",to:"/payroll/payslip/"+l.row.id,style:{},class:"q-mx-sm bg-warning text-white",clickable:""},{default:(0,t.w5)((()=>[b])),_:2},1032,["to"]),[[k]]),(0,t.wy)((0,t.Wm)(p,{round:"",flat:"",color:"red",icon:"delete",onClick:a=>e.deletePayslip({id:l.row.id}),style:{},class:"q-mx-sm",clickable:""},null,8,["onClick"]),[[k]])])),_:2},1032,["props"])])),_:2},1032,["class","props"])])),_:1},8,["rows","columns","loading"]),v,(0,t.Wm)(x,{onCloseDialogue:l[1]||(l[1]=e=>s.dialogue=!1),inProfile:!1,seamless:"",position:"right",modelValue:s.dialogue,"onUpdate:modelValue":l[2]||(l[2]=e=>s.dialogue=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{onCloseDialogue:l[0]||(l[0]=e=>s.dialogue=!1),currentUser:a.currentUser,body:s.body,id:s.id,actionType:"Edit"},null,8,["currentUser","body","id"])])),_:1},8,["modelValue"])])}a(7098);var D=a(93617),q=a(25616);const x={computed:{...(0,D.rn)("payrollStore",["payslips"]),data(){let e=JSON.parse(JSON.stringify(this.payslips)).sort(((e,l)=>l["id"]-e["id"]));return e}},props:["currentUser"],data(){return{body:null,id:null,dateFunc:q.ZP,dialogue:!1,loading:!1,columns:[{name:"employeeName",label:"Employee Name",align:"left",sortable:!0,field:"employeeName"},{name:"employeeEmail",label:"Employee Email",align:"left",sortable:!0,field:"employeeEmail"},{name:"fromDate",label:"Date",align:"left",sortable:!0,field:"fromDate"},{name:"salary",label:"Salary",align:"left",sortable:!0,field:"salary"},{name:"createdAt",label:"Created Date",align:"left",sortable:!0,field:"issuedAt"},{name:"actions",label:"Actions",align:"right",field:"actions"}]}},components:{},methods:{...(0,D.nv)("payrollStore",["getPayslips","deletePayslip"]),...(0,D.nv)("example",["getUser"]),editOvertime(e){if(!0===this.dialogue)return this.dialogue=!1,void setTimeout((()=>{this.body=e,this.dialogue=!0}),200);this.body=e,this.dialogue=!0},rowColor(e){if(e.rowIndex%2!==0||0!==e.rowIndex)return"background: #fff;"}},async mounted(){this.loading=!0,await this.getUser(),await this.getPayslips(),this.loading=!1}};var k=a(57678),W=a(18186),Z=a(83884),Q=a(75096),V=a(2165),C=a(46778),S=a(60677),P=a(7518),U=a.n(P);x.render=_;const A=x;U()(x,"components",{QTable:k.Z,QTr:W.Z,QTd:Z.Z,QAvatar:Q.Z,QBtn:V.Z,QDialog:C.Z}),U()(x,"directives",{ClosePopup:S.Z});const E=(0,t._)("br",null,null,-1),T={class:"flex col-12"};function z(e,l,a,o,s,i){const n=(0,t.up)("q-toolbar-title"),r=(0,t.up)("q-btn"),p=(0,t.up)("q-toolbar"),u=(0,t.up)("q-select"),m=(0,t.up)("q-input"),y=(0,t.up)("q-date"),c=(0,t.up)("q-card-section"),g=(0,t.up)("q-card"),f=(0,t.up)("q-layout"),h=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(f,{style:{width:"500px !important"}},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{style:{"max-width":"500px","min-height":"100vh"},flat:"",square:""},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{class:"q-pa-md bg-grey-3",style:{position:"sticky !important",top:"0","z-index":"15",height:"63px !important"}},{default:(0,t.w5)((()=>[(0,t.Wm)(n,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(a.actionType)+" Salary ",1)])),_:1}),(0,t.wy)((0,t.Wm)(r,{icon:"close",flat:"",round:"",dense:""},null,512),[[h]])])),_:1}),(0,t.Wm)(c,{class:"q-gutter-sm scroll"},{default:(0,t.w5)((()=>[E,(0,t.Wm)(u,{modelValue:s.employee,"onUpdate:modelValue":[l[0]||(l[0]=e=>s.employee=e),l[1]||(l[1]=e=>{s.salary=null===e||void 0===e?void 0:e.salary,s.credentials.employeeId=null===e||void 0===e?void 0:e.id})],"no-caps":"",label:"Employee",loading:s.employeeLoading,outlined:"",ref:"employeeRef",rules:[e=>null!==s.credentials.employeeId||"Please type the Employee"],clearable:"",options:s.employeeOptions},null,8,["modelValue","loading","rules","options"]),(0,t.Wm)(m,{outlined:"",disable:"",type:"number",modelValue:s.salary,"onUpdate:modelValue":l[2]||(l[2]=e=>s.salary=e),modelModifiers:{number:!0},label:"Basic Salary"},null,8,["modelValue"]),(0,t._)("div",T,[(0,t.Wm)(y,{subtitle:"Pick Duration",mask:"YYYY-MM",class:"col-12","onUpdate:modelValue":[i.setFromDate,l[3]||(l[3]=e=>s.credentials.fromDate=e)],modelValue:s.credentials.fromDate,"emit-immediately":"",ref:"fromDateRef",rules:[e=>null!==e||"Please type the Employee"]},null,8,["onUpdate:modelValue","modelValue","rules"])])])),_:1})])),_:1}),(0,t.Wm)(p,{class:"bg-grey-3 submitBtnClass",style:{position:"sticky !important",bottom:"0","z-index":"5"}},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{loading:s.loading,onClick:i.submit,class:"full-width",color:"primary",label:"Submit","no-caps":""},null,8,["loading","onClick"])])),_:1})])),_:1})}a(10071);var I=a(49549),Y=(a(11488),a(94789));const M={components:{VueTelInput:I.VueTelInput,Datepicker:Y.Z},props:["currentUser","actionType","body"],data(){return{loading:!1,employeeOptions:[],employee:null,salary:0,employeeLoading:!1,credentials:{fromDate:null,employeeId:null}}},computed:{...(0,D.rn)("payrollStore",["payslips"]),...(0,D.rn)("hrmStore",["allEmployees"])},methods:{...(0,D.nv)("payrollStore",["createPayslip"]),...(0,D.nv)("hrmStore",["getEmployees"]),setFromDate(e){console.log(e)},async submit(){if(this.$refs.employeeRef.validate(),null!==this.credentials.fromDate&&null!==this.credentials.employeeId){this.loading=!0;let l={employeeId:Number(this.credentials.employeeId),fromDate:this.credentials.fromDate},a=this;try{await this.createPayslip(l),a.$q.notify({type:"positive",message:"Department created",color:"positive",position:"top",timeout:"500"})}catch(e){a.$q.notify({type:"negative",message:"Something went wrong while requesting Leave!",color:"negative",position:"top",timeout:"500"})}finally{this.loading=!1,this.$emit("closeDialogue")}}},getValuesFromApiAsync(e){return new Promise((async l=>{l(await e)}))}},async mounted(){"Add"===this.actionType&&(this.employee={label:"",id:null,salary:0},this.employeeLoading=!0,this.getValuesFromApiAsync(this.getEmployees()).then((()=>{for(let e of this.allEmployees)this.employeeOptions.push({label:e.name,id:e.id,salary:e.salary});this.employeeLoading=!1})))}};var F=a(19214),N=a(10151),j=a(39570),L=a(13747),O=a(25589),B=a(63314),$=a(64689),R=a(85626);M.render=z;const J=M;U()(M,"components",{QLayout:F.Z,QCard:N.Z,QToolbar:j.Z,QToolbarTitle:L.Z,QBtn:V.Z,QCardSection:O.Z,QSelect:B.Z,QInput:$.Z,QDate:R.Z}),U()(M,"directives",{ClosePopup:S.Z});const G={components:{tbl:A,payslipModal:J},data(){return{table:!1,payslipDialogue:!1}},setup(){return{tab:(0,p.iH)("Salary")}}};var H=a(24379),K=a(47704);G.render=r;const X=G;U()(G,"components",{QPage:H.Z,QBtn:V.Z,QScrollArea:K.Z,QDialog:C.Z})}}]);