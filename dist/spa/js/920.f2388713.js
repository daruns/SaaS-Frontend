"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[920],{1920:(e,l,t)=>{t.r(l),t.d(l,{default:()=>he});t(246);var a=t(3673),s=t(2323),n=t(8880),i=t(3402),o=t.n(i);const d=e=>((0,a.dD)("data-v-6f3dd88c"),e=e(),(0,a.Cn)(),e),m={class:"row justify-between"},r={class:"column col-lg-6 col-md-6 col-sm-12 col-xs-12 q-gutter-lg"},u=d((()=>(0,a._)("img",{src:o()},null,-1))),c={class:"column col-lg-6 col-md-6 col-xs-12 col-sm-12 items-end q-mt-md"},p={class:"text-h6"},f={class:"text-subtitle2"},x={class:"text-subtitle2"},g={key:0,style:{"justify-content":"start !important"},class:"row q-mt-xl"},h={class:"column"},_=d((()=>(0,a._)("p",null,"Supplier:",-1))),w={class:"text-bold"},b={class:"q-mt-xl"},y=d((()=>(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{class:"text-left"},"#"),(0,a._)("th",{class:"text-left"},"Item"),(0,a._)("th",{class:"text-left"},"Description"),(0,a._)("th",{class:"text-left"},"Unit price"),(0,a._)("th",{class:"text-left"},"Quantity"),(0,a._)("th",{class:"text-left"},"Amount")])],-1))),q={class:"text-left"},k={class:"text-left"},v={class:"text-left"},W={class:"text-left"},E={class:"text-left"},z={class:"text-left"},C={class:"row q-mt-xl"},F=d((()=>(0,a._)("div",{class:"col-9"},null,-1))),V={class:"col-lg-3 col-md-3 col-sm-12 col-xs-12 column q-gutter-sm"},D={class:"text-grey q-pa-none"},I=["innerHTML"],Q={class:"text-h6 text-grey q-mt-lg"},Z={class:"text-subtitle1 text-grey-5"},R={class:"row q-pb-xl"},U={class:"flex column flex-center q-pr-md q-pt-md"},j=["src"],N={class:"text-center text-caption text-black",style:{"max-width":"100px"}},T=["href"],A={class:"text-h6 text-grey q-mt-lg"},S={class:"text-subtitle1 text-grey-5"},P={class:"row q-pb-xl"},H={class:"flex column flex-center q-pr-md q-pt-md"},L={class:"text-center text-caption text-black",style:{"max-width":"100px"}},$=["href"],B=d((()=>(0,a._)("div",{class:"text-h6"},"Are you sure?",-1)));function K(e,l,t,i,o,d){const K=(0,a.up)("q-spinner"),M=(0,a.up)("q-page"),Y=(0,a.up)("q-avatar"),O=(0,a.up)("q-markup-table"),G=(0,a.up)("q-input"),J=(0,a.up)("q-separator"),X=(0,a.up)("q-card"),ee=(0,a.up)("q-btn"),le=(0,a.up)("q-badge"),te=(0,a.up)("q-icon"),ae=(0,a.up)("q-file"),se=(0,a.up)("q-banner"),ne=(0,a.up)("q-popup-proxy"),ie=(0,a.up)("q-card-section"),oe=(0,a.up)("q-card-actions"),de=(0,a.up)("q-dialog"),me=(0,a.Q2)("close-popup");return o.isLoaded?((0,a.wg)(),(0,a.j4)(M,{key:1,class:"q-pa-xl"},{default:(0,a.w5)((()=>[(0,a.Wm)(X,{class:"q-pa-xl"},{default:(0,a.w5)((()=>[(0,a._)("div",m,[(0,a._)("div",r,[(0,a.Wm)(Y,{size:"100px","font-size":"52px"},{default:(0,a.w5)((()=>[u])),_:1})]),(0,a._)("div",c,[(0,a._)("p",p,(0,s.zw)(e.oneExpense.expenseNumber),1),(0,a._)("p",f,"Expense Date: "+(0,s.zw)(d.dateConversion(e.oneExpense.date)),1),(0,a._)("p",x,"Due Date: "+(0,s.zw)(d.dateConversion(e.oneExpense.dueDate)),1)])]),e.oneExpense.supplier?((0,a.wg)(),(0,a.iD)("div",g,[(0,a._)("div",h,[_,(0,a._)("p",w,(0,s.zw)(e.oneExpense.supplier.name),1),(0,a._)("p",null,(0,s.zw)(e.oneExpense.supplier.email),1),(0,a._)("p",null,(0,s.zw)(e.oneExpense.supplier.phoneNumbers),1)])])):(0,a.kq)("",!0),(0,a._)("div",b,[(0,a.Wm)(O,{flat:"",bordered:""},{default:(0,a.w5)((()=>[y,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.oneExpense.expenseItems,((e,l)=>((0,a.wg)(),(0,a.iD)("tr",{style:(0,s.j5)(d.rowColor(l)),key:l},[(0,a._)("td",q,(0,s.zw)(l+1),1),(0,a._)("td",k,(0,s.zw)(e.name),1),(0,a._)("td",v,(0,s.zw)(e.description),1),(0,a._)("td",W,(0,s.zw)(e.unitPrice),1),(0,a._)("td",E,(0,s.zw)(e.qty),1),(0,a._)("td",z,(0,s.zw)(e.qty*e.unitPrice),1)],4)))),128))])])),_:1})]),(0,a._)("div",C,[F,(0,a._)("div",V,[(0,a.Wm)(G,{mask:"#","fill-mask":"0","reverse-fill-mask":"","model-value":"Number",readonly:"",modelValue:o.stotal,"onUpdate:modelValue":l[0]||(l[0]=e=>o.stotal=e),label:"Subtotal"},null,8,["modelValue"]),(0,a.Wm)(G,{mask:"#","fill-mask":"0","reverse-fill-mask":"","model-value":"Number",readonly:"",rules:[e=>Number(e)<=100||"Not more than 100!"],modelValue:o.taxRatio,"onUpdate:modelValue":l[1]||(l[1]=e=>o.taxRatio=e),label:"Tax Ratio%"},null,8,["rules","modelValue"]),(0,a.Wm)(G,{mask:"#","fill-mask":"0","reverse-fill-mask":"",readonly:"","model-value":"Number",modelValue:o.discount,"onUpdate:modelValue":l[2]||(l[2]=e=>o.discount=e),label:"Discount%"},null,8,["modelValue"]),(0,a.Wm)(G,{readonly:"",modelValue:o.total,"onUpdate:modelValue":l[3]||(l[3]=e=>o.total=e),label:"Grand total",type:"number"},null,8,["modelValue"])])]),(0,a.Wm)(J,{class:"q-mt-lg"}),(0,a._)("div",D,[(0,a._)("p",{class:"q-mt-md",innerHTML:e.oneExpense.description},null,8,I)])])),_:1}),(0,a.wy)((0,a._)("p",Q,"Uploaded images",512),[[n.F8,0!==o.images.length]]),(0,a.Wm)(X,{class:"q-pa-md q-mt-md"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("p",Z,"No images has been uploaded.",512),[[n.F8,0===o.images.length]]),(0,a.wy)((0,a._)("div",R,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.images,((e,l)=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[(0,a._)("div",U,[(0,a.Wm)(Y,{square:"",size:"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(le,{style:{background:"transparent !important"},transparent:"",floating:""},{default:(0,a.w5)((()=>[(0,a.Wm)(ee,{onClick:l=>(o.fileId=e.id,o.confirm=!0),round:"",size:"7.5px",icon:"delete",color:"negative",class:"absolute-top-right"},null,8,["onClick"])])),_:2},1024),(0,a._)("img",{src:e.url},null,8,j)])),_:2},1024),(0,a._)("p",N,(0,s.zw)(e.name),1),(0,a._)("a",{href:e.url,target:"_blank"},[(0,a.Wm)(ee,{class:"text-primary bg-blue-1",unelevated:"",label:"Download","no-caps":""})],8,T)])])))),128))],512),[[n.F8,0!==o.images.length]]),(0,a.Wm)(ee,{label:"Upload images",icon:"backup",color:"grey","no-caps":"",push:"",flat:"",unelevated:"",class:"absolute-bottom-right q-mr-sm q-mb-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(ne,null,{default:(0,a.w5)((()=>[(0,a.Wm)(se,null,{default:(0,a.w5)((()=>[(0,a.Wm)(ae,{filter:d.checkType,onRejected:d.onRejectedImage,clearable:"",label:"Image",outlined:"",modelValue:o.image,"onUpdate:modelValue":l[4]||(l[4]=e=>o.image=e)},{prepend:(0,a.w5)((()=>[(0,a.Wm)(te,{name:"attach_file"})])),_:1},8,["filter","onRejected","modelValue"]),(0,a.wy)((0,a.Wm)(ee,{label:"Upload",onClick:l[5]||(l[5]=e=>{d.addExpFile("image"),o.image=null}),disable:!o.image,"no-caps":"",flat:"",color:"primary",class:"q-mt-sm",size:"md"},null,8,["disable"]),[[me]])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.wy)((0,a._)("p",A,"Uploaded files",512),[[n.F8,0!==o.files.length]]),(0,a.Wm)(X,{class:"q-pa-md q-mt-md"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("p",S,"No files has been uploaded.",512),[[n.F8,0===o.files.length]]),(0,a.wy)((0,a._)("div",P,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.files,((e,l)=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[(0,a._)("div",H,[(0,a.Wm)(Y,{square:"",size:"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(le,{style:{background:"transparent !important"},transparent:"",floating:""},{default:(0,a.w5)((()=>[(0,a.Wm)(ee,{onClick:l=>(o.fileId=e.id,o.confirm=!0),round:"",size:"7.5px",icon:"delete",color:"negative",class:"absolute-top-right"},null,8,["onClick"])])),_:2},1024),(0,a.Wm)(te,{color:"grey",name:"attach_file"})])),_:2},1024),(0,a._)("p",L,(0,s.zw)(e.name),1),(0,a._)("a",{href:e.url,target:"_blank"},[(0,a.Wm)(ee,{class:"text-primary bg-blue-1",unelevated:"",label:"Download","no-caps":""})],8,$)])])))),128))],512),[[n.F8,0!==o.files.length]]),(0,a.Wm)(ee,{label:"Upload files",icon:"backup",color:"grey","no-caps":"",push:"",flat:"",unelevated:"",class:"absolute-bottom-right q-mr-sm q-mb-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(ne,null,{default:(0,a.w5)((()=>[(0,a.Wm)(se,null,{default:(0,a.w5)((()=>[(0,a.Wm)(ae,{filter:d.checkFileType,onRejected:d.onRejectedFile,clearable:"",label:"File",outlined:"",modelValue:o.file,"onUpdate:modelValue":l[6]||(l[6]=e=>o.file=e)},{prepend:(0,a.w5)((()=>[(0,a.Wm)(te,{name:"attach_file"})])),_:1},8,["filter","onRejected","modelValue"]),(0,a.wy)((0,a.Wm)(ee,{label:"Upload",onClick:l[7]||(l[7]=e=>{d.addExpFile("file"),o.file=null}),"no-caps":"",disable:!o.file,flat:"",color:"primary",class:"q-mt-sm",size:"md"},null,8,["disable"]),[[me]])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(de,{modelValue:o.confirm,"onUpdate:modelValue":l[8]||(l[8]=e=>o.confirm=e),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(X,{style:{width:"300px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(ie,null,{default:(0,a.w5)((()=>[B])),_:1}),(0,a.Wm)(oe,{align:"right"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(ee,{flat:"",label:"Cancel",color:"negative"},null,512),[[me]]),(0,a.wy)((0,a.Wm)(ee,{flat:"",label:"Delete",onClick:d.deleteExpenseFile,color:"primary"},null,8,["onClick"]),[[me]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})):((0,a.wg)(),(0,a.j4)(M,{key:0,class:"flex flex-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(K,{color:"primary",size:"md"})])),_:1}))}var M=t(3617),Y=t(52),O=t.n(Y);const G={data(){return{files:[],file:null,image:null,images:[],confirm:!1,fileId:null,isLoaded:!1,taxRatio:0,total:0,discount:0,stotal:0}},computed:{...(0,M.rn)("financeStore",["oneExpense"])},methods:{...(0,M.nv)("financeStore",["getExpense","addExpenseFile"]),async deleteExpenseFile(){await O().post("https://onconnect-backend-api.herokuapp.com/api/v1/expenses/removeFile",{id:this.oneExpense.id,attachId:this.fileId},{headers:{Authorization:localStorage.getItem("accessToken")}});await this.getExpense(this.$route.params.id),this.fileAndImages()},dateConversion(e){return" "+e.split("T")[0]},rowColor(e){if(e%2===0)return"background: #f2f2f2 !important;"},checkType(e){return e.filter((e=>e.type.includes("image")))},checkFileType(e){return e.filter((e=>!e.type.includes("image")))},onRejectedImage(){this.$q.notify({type:"negative",message:"Only images are allowed!"})},onRejectedFile(){this.$q.notify({type:"negative",message:"Only files are allowed!"})},async addExpFile(e){let l=new FormData;l.append("id",this.oneExpense.id),"file"===e?l.append("files",this.file):l.append("files",this.image),await this.addExpenseFile(l),await this.getExpense(this.$route.params.id),this.fileAndImages()},fileAndImages(){this.files=[],this.images=[];for(let e=0;e<this.oneExpense.attachments.length;e++)this.oneExpense.attachments[e].contentType.includes("image")?this.images.push(this.oneExpense.attachments[e]):this.files.push(this.oneExpense.attachments[e])}},async mounted(){await this.getExpense(this.$route.params.id),this.isLoaded=!0,this.discount=100*Number(this.oneExpense.discount),this.taxRatio=100*Number(this.oneExpense.taxRate),this.stotal=Number(this.oneExpense.subTotalAmount),this.total=Number(this.oneExpense.totalAmount),this.fileAndImages()}};var J=t(4379),X=t(6833),ee=t(151),le=t(2165),te=t(3944),ae=t(5607),se=t(4974),ne=t(4554),ie=t(5096),oe=t(481),de=t(4689),me=t(5869),re=t(9721),ue=t(6778),ce=t(5589),pe=t(9367),fe=t(677),xe=t(7518),ge=t.n(xe);G.render=K,G.__scopeId="data-v-6f3dd88c";const he=G;ge()(G,"components",{QPage:J.Z,QSpinner:X.Z,QCard:ee.Z,QBtn:le.Z,QPopupProxy:te.Z,QBanner:ae.Z,QFile:se.Z,QIcon:ne.Z,QAvatar:ie.Z,QMarkupTable:oe.Z,QInput:de.Z,QSeparator:me.Z,QBadge:re.Z,QDialog:ue.Z,QCardSection:ce.Z,QCardActions:pe.Z}),ge()(G,"directives",{ClosePopup:fe.Z})}}]);