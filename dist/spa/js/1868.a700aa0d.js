"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[1868],{21868:(e,t,a)=>{a.r(t),a.d(t,{default:()=>te});var n=a(83673);const l=(0,n._)("div",{class:"full-width flex justify-between items-center header-height-standard q-px-md",style:{"border-bottom":"1px solid lightgrey"}},[(0,n._)("div",{class:"text-h4"},"Attendances"),(0,n._)("div",{class:"flex items-center"})],-1);function r(e,t,a,r,s,o){const i=(0,n.up)("tbl"),d=(0,n.up)("modal"),c=(0,n.up)("q-dialog"),u=(0,n.up)("q-scroll-area"),m=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(m,{class:"q-py-none q-my-none"},{default:(0,n.w5)((()=>[l,(0,n.Wm)(u,{style:{"max-height":"auto !important","min-height":"auto !important",height:"calc(100vh - 131px)"},class:"q-px-md"},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{currentUser:e.user},null,8,["currentUser"]),(0,n.Wm)(c,{seamless:"",position:"right",modelValue:s.dialogue,"onUpdate:modelValue":t[1]||(t[1]=e=>s.dialogue=e)},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{onCloseDialogue:t[0]||(t[0]=e=>s.dialogue=!1),type:r.tab,actionType:"Add",id:{}},null,8,["type"])])),_:1},8,["modelValue"])])),_:1})])),_:1})}a(7565),a(34364);var s=a(62323);const o={key:0,class:"q-py-sm"},i=(0,n._)("h6",null,"This Month Attendances",-1),d={class:"q-mr-sm"},c=["src"],u={style:{"font-size":"17px"}},m={key:1,class:"q-py-sm"},p={class:"rounded-borders bg-white q-pa-sm col"},h={class:"text-left text-h4"},y=(0,n.Uk)(" Time Sheet "),g={color:"grey-3"},w={class:"flex q-pa-md justify-center item-center flex items-center"},f={class:"justify-center flex"},v={class:"q-py-lg row",style:{width:"100%"}},b={class:"q-mr-xs rounded-borders text-h6 q-py-md col bg-grey text-center text-white"},_=(0,n._)("span",{class:"q-ml-xs rounded-borders text-h6 q-py-md col bg-grey text-center text-white"},"Over Time 0 hrs",-1),x={class:"rounded-borders q-pa-md bg-white col"},k={class:"text-h4"},A=(0,n.Uk)(" Today Activity "),D={color:"grey-3"},q={verticalScrollPosition:"0",style:{height:"300px","overflow-y":"scroll"}},I=(0,n._)("br",null,null,-1),Y=(0,n._)("div",{class:"text-h6"},"All Attendances",-1),j={style:{"font-size":"20px"}},C={style:{"font-size":"20px"}},H={style:{"font-size":"20px"}},M={style:{"font-size":"20px"}};function T(e,t,a,l,r,T){const z=(0,n.up)("q-avatar"),W=(0,n.up)("q-td"),P=(0,n.up)("q-icon"),N=(0,n.up)("q-tr"),O=(0,n.up)("q-table"),Q=(0,n.up)("q-circular-progress"),U=(0,n.up)("q-btn"),Z=(0,n.up)("q-timeline-entry"),S=(0,n.up)("q-timeline"),F=(0,n.up)("q-card");return(0,n.wg)(),(0,n.iD)(n.HY,null,[r.attends?((0,n.wg)(),(0,n.iD)("div",o,[i,(0,n.Wm)(O,{rows:T.attendancesData,columns:r.allcolumns,"row-key":"id",loading:r.loading,flat:"",filter:r.filter,class:"bg-secondary q-py-md"},{body:(0,n.w5)((e=>[(0,n.Wm)(N,{class:(0,s.C_)(e.rowIndex%2!==0&&"bg-white"),props:e},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{props:e,key:"employeeId",class:(0,s.C_)("items-center")},{default:(0,n.w5)((()=>{var t,a,l;return[(0,n._)("span",d,[null!==(t=e.row.employee)&&void 0!==t&&null!==(a=t.user)&&void 0!==a&&a.avatar?((0,n.wg)(),(0,n.j4)(z,{key:0},{default:(0,n.w5)((()=>{var t,a;return[(0,n._)("img",{src:null===(t=e.row.employee)||void 0===t||null===(a=t.user)||void 0===a?void 0:a.avatar},null,8,c)]})),_:2},1024)):((0,n.wg)(),(0,n.j4)(z,{key:1,color:"grey","text-color":"white",icon:"person"}))]),(0,n._)("span",u,(0,s.zw)(null===(l=e.row.employee)||void 0===l?void 0:l.name),1)]})),_:2},1032,["props"]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.row.attendances,(t=>((0,n.wg)(),(0,n.j4)(W,{key:t.day,props:e,class:(0,s.C_)("items-center justify-center")},{default:(0,n.w5)((()=>[t.checked?((0,n.wg)(),(0,n.j4)(P,{key:0,class:"text-primary text-bold",name:"done"})):((0,n.wg)(),(0,n.j4)(P,{key:1,class:"text-red text-bold",name:"close"}))])),_:2},1032,["props"])))),128))])),_:2},1032,["class","props"])])),_:1},8,["rows","columns","loading","filter"])])):(0,n.kq)("",!0),r.myattends?((0,n.wg)(),(0,n.iD)("div",m,[(0,n.Wm)(F,{class:"q-gutter-md bg-transparent row",flat:""},{default:(0,n.w5)((()=>[(0,n._)("div",p,[(0,n._)("div",h,[y,(0,n._)("span",g,(0,s.zw)(r.todayDateFull),1)]),(0,n._)("div",w,[(0,n._)("div",f,[(0,n.Wm)(Q,{thickness:.05,"track-color":"grey-3","show-value":"",class:"q-ma-lg","font-size":"30px",value:r.todayHoursPercentage,size:"200px",color:"grey"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(r.todayHours)+" Hrs",1)])),_:1},8,["thickness","value"]),r.lastAttend?((0,n.wg)(),(0,n.j4)(U,{key:1,loading:r.btnloading,class:"q-pa-md text-h6",style:{width:"100%"},label:"Punch Out",color:"red",onClick:t[1]||(t[1]=e=>T.autoCloseDialogue())},null,8,["loading"])):((0,n.wg)(),(0,n.j4)(U,{key:0,loading:r.btnloading,class:"q-pa-md text-h6",style:{width:"100%"},label:"Punch In",color:"primary",onClick:t[0]||(t[0]=e=>T.autoCloseDialogue())},null,8,["loading"])),(0,n._)("div",v,[(0,n._)("span",b,"Break "+(0,s.zw)(r.breakTime)+" hrs",1),_])])])]),(0,n._)("div",x,[(0,n._)("div",k,[A,(0,n._)("span",D,(0,s.zw)(r.todayDate),1)]),(0,n.Wm)(S,{color:"grey"},{default:(0,n.w5)((()=>[(0,n._)("div",q,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(T.attendancesData,(e=>{var t,a;return(0,n.wg)(),(0,n.j4)(Z,{key:e.id,title:1===e.checkedIn?"Punch In":"Punch Out",subtitle:null===(t=e.createdAt)||void 0===t||null===(a=t.match(/([0-1]?[0-9]|2[0-3]):[0-5][0-9]/))||void 0===a?void 0:a.at(0),color:1===e.checkedIn?"primary":"red"},null,8,["title","subtitle","color"])})),128))])])),_:1})])])),_:1}),I,Y,(0,n.Wm)(O,{rows:T.myattendancesData,columns:r.columns,"row-key":"id",loading:r.loading,flat:"",filter:r.filter,class:"bg-secondary q-py-md"},{body:(0,n.w5)((e=>[(0,n.Wm)(N,{class:(0,s.C_)(e.rowIndex%2!==0&&"bg-white"),props:e},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{class:"items-center justify-start",key:"indx",props:e},{default:(0,n.w5)((()=>[(0,n._)("p",j,(0,s.zw)(e.row.id),1)])),_:2},1032,["props"]),(0,n.Wm)(W,{class:"items-center justify-start",key:"duration",props:e},{default:(0,n.w5)((()=>{var t;return[(0,n._)("p",C,(0,s.zw)(null===(t=e.row)||void 0===t?void 0:t.duration),1)]})),_:2},1032,["props"]),(0,n.Wm)(W,{class:(0,s.C_)("items-center justify-center"),key:"punchInAt",props:e},{default:(0,n.w5)((()=>[(0,n._)("p",H,(0,s.zw)(e.row.punchInAt),1)])),_:2},1032,["props"]),(0,n.Wm)(W,{class:(0,s.C_)("items-center justify-center"),key:"punchOutAt",props:e},{default:(0,n.w5)((()=>[(0,n._)("p",M,(0,s.zw)(e.row.punchOutAt),1)])),_:2},1032,["props"])])),_:2},1032,["class","props"])])),_:1},8,["rows","columns","loading","filter"])])):(0,n.kq)("",!0)],64)}a(7098),a(17070),a(10071);var z=a(93617),W=a(61959),P=a(11488);const N={computed:{...(0,z.rn)("hrmStore",["attendances"]),attendancesData(){let e=JSON.parse(JSON.stringify(this.attendances)).sort(((e,t)=>t["id"]-e["id"]));var t;this.myattends&&(e[0]&&(this.lastAttend=null===(t=e[0])||void 0===t?void 0:t.checkedIn));return e},myattendancesData(){let e=JSON.parse(JSON.stringify(this.attendances)).sort(((e,t)=>t["id"]-e["id"]));if(this.myattends){var t;let a=[],n=1,l=0,r=e.sort().reverse();r.length&&r.reduce(((e,t)=>{if(1!==e.checkedIn&&1===t.checkedIn){let a=Number(new Date(t.createdAt))/36e5,n=Number(new Date(e.createdAt))/36e5;console.log("difff: ",a,n,e.createdAt,t.createdAt),l+=Number(a-n)}if(1===e.checkedIn&&e.checkedIn!==t.checkedIn){let l=Number(new Date(t.createdAt))/36e5,r=Number(new Date(e.createdAt))/36e5;a.push({id:n,duration:Number(l-r).toFixed(2),punchInAt:P(e.createdAt).format("YYYY-MM-DD HH:mm"),punchOutAt:P(t.createdAt).format("YYYY-MM-DD HH:mm")}),n++}return t}));let s=a.filter((e=>Number(new Date(e.punchInAt.split(".")[0]))>Number(new Date(P().format("YYYY-MM-DD")))));console.log("this duration hours: ",s);let o=0;for(let e of s)o+=Number(e.duration);return this.breakTime=null===(t=l)||void 0===t?void 0:t.toFixed(2),this.todayHoursPercentage=o/8*100,this.todayHours=o.toFixed(2),a}return[]}},props:["currentUser"],data(){var e;return{filter:(0,W.iH)(""),attends:!1,todayDateFull:P().format("DD MMM YYYY"),todayHours:0,todayHoursPercentage:0,breakTime:0,todayDate:P().format("DD, MMM"),myattends:!1,btnloading:!1,lastAttend:!1,id:null,loading:!1,columns:[{name:"indx",label:"#",align:"left",field:"indx"},{name:"duration",label:"Attended Duration Hours",align:"left",field:"duration"},{name:"punchInAt",label:"Punch In At",align:"left",field:"punchInAt"},{name:"punchOutAt",label:"Punch Out At",align:"left",field:"punchOutAt"}],allcolumns:[{name:"employeeId",label:"Employee",align:"left",field:"employeeId"},...null===(e=this.daysInThisMonth())||void 0===e?void 0:e.map((e=>({name:e,label:e,align:"right",field:e})))]}},methods:{...(0,z.nv)("hrmStore",["createAttendance","getAttendances"]),daysInThisMonth(){let e=new Date,t=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();return Array.from({length:t},((e,t)=>t+1))},async autoCloseDialogue(){this.btnloading=!0,await this.createAttendance(),await this.getAttendances(),this.btnloading=!1},rowColor(e){if(e.rowIndex%2!==0||0!==e.rowIndex)return"background: #fff;"}},async mounted(){this.loading=!0,this.getAttendances().then((()=>{console.log(this.attendances),this.loading=!1})),this.currentUser&&("owner"===this.currentUser.userType||this.currentUser.myEmployeeProfile&&this.currentUser.myEmployeeProfile.hrMember)?(this.myattends=!1,this.attends=!0):(this.attends=!1,this.myattends=!0)}};var O=a(57678),Q=a(18186),U=a(83884),Z=a(75096),S=a(24554),F=a(10151),E=a(86122),J=a(2165),V=a(1432),B=a(23424),K=a(7518),G=a.n(K);N.render=T;const L=N;G()(N,"components",{QTable:O.Z,QTr:Q.Z,QTd:U.Z,QAvatar:Z.Z,QIcon:S.Z,QCard:F.Z,QCircularProgress:E.Z,QBtn:J.Z,QTimeline:V.Z,QTimelineEntry:B.Z});const R={components:{tbl:L},computed:{...(0,z.rn)("example",["user"])},data(){return{dialogue:!1}},methods:{...(0,z.nv)("example",["getUser"])},setup(){return{tab:(0,W.iH)("leaveType")}},async mounted(){await this.getUser()}};var X=a(24379),$=a(47704),ee=a(46778);R.render=r;const te=R;G()(R,"components",{QPage:X.Z,QScrollArea:$.Z,QDialog:ee.Z})}}]);