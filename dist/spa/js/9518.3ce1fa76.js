"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[9518],{79518:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Bt});var o=r(83673);const a={class:"full-width flex justify-between items-center header-height-standard q-px-md",style:{"border-bottom":"1px solid lightgrey"}},l=(0,o._)("div",{class:"text-h4"},"Overtimes",-1),s={class:"flex items-center"};function i(e,t,r,i,n,m){const d=(0,o.up)("q-btn"),u=(0,o.up)("overtimesTable"),p=(0,o.up)("overtimeApprovalsTable"),c=(0,o.up)("myOvertimesTable"),y=(0,o.up)("modal"),v=(0,o.up)("q-dialog"),g=(0,o.up)("q-scroll-area"),w=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(w,{class:"q-py-none q-my-none"},{default:(0,o.w5)((()=>[(0,o._)("div",a,[l,(0,o._)("div",s,[(0,o.Wm)(d,{onClick:t[0]||(t[0]=e=>n.dialogue=!0),color:"primary",label:"Add "+i.tab[0].toUpperCase()+i.tab.substr(1,i.tab.length),unelevated:"",rounded:"","no-caps":""},null,8,["label"])])]),(0,o.Wm)(g,{style:{"max-height":"auto !important","min-height":"auto !important",height:"calc(100vh - 131px)"},class:"q-px-md"},{default:(0,o.w5)((()=>[n.overtimesView?((0,o.wg)(),(0,o.j4)(u,{key:0,currentUser:e.user},null,8,["currentUser"])):(0,o.kq)("",!0),n.overtimeApprovalsView?((0,o.wg)(),(0,o.j4)(p,{key:1,currentUser:e.user},null,8,["currentUser"])):(0,o.kq)("",!0),n.myOvertimesView?((0,o.wg)(),(0,o.j4)(c,{key:2,currentUser:e.user},null,8,["currentUser"])):(0,o.kq)("",!0),(0,o.Wm)(v,{seamless:"",position:"right",modelValue:n.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>n.dialogue=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{onCloseDialogue:t[1]||(t[1]=e=>n.dialogue=!1),type:i.tab,currentUser:e.user,actionType:"Add",id:{}},null,8,["type","currentUser"])])),_:1},8,["modelValue"])])),_:1})])),_:1})}r(90246);var n=r(62323),m=r(98880);const d=(0,o._)("h6",{class:"q-pa-md"},"All Employees Overtimes",-1),u={class:"q-mr-sm"},p=["src"],c={style:{"font-size":"17px"}},y={style:{"font-size":"17px"}},v={style:{"font-size":"17px"}},g={style:{"font-size":"17px"}},w={style:{"font-size":"17px"}},h={style:{"font-size":"17px"}},f=(0,o.Uk)("Rejected"),b=(0,o.Uk)("Completed"),_=(0,o.Uk)("Pending"),k={style:{"font-size":"17px"}},x={style:{"font-size":"17px"}},T=(0,o._)("div",{class:"q-mb-sm"},"Approval Stage",-1),j={class:"col-12 flex"},D={key:0,class:"flex items-center q-mx-md",style:{width:"80px"}},W={class:"text-center justify-center"},q=["src"],B={key:2},A={key:3},U=(0,o._)("hr",null,null,-1);function z(e,t,r,a,l,s){const i=(0,o.up)("q-th"),z=(0,o.up)("q-tr"),V=(0,o.up)("q-btn"),Y=(0,o.up)("q-td"),M=(0,o.up)("q-avatar"),N=(0,o.up)("q-badge"),O=(0,o.up)("q-linear-progress"),C=(0,o.up)("q-icon"),Z=(0,o.up)("q-table"),Q=(0,o.up)("modal"),P=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.iD)("div",null,[d,(0,o.Wm)(Z,{rows:s.data,columns:l.columns,"rows-per-page-options":[5,50,100,0],"row-key":"id",loading:l.loading,flat:"",class:"bg-secondary q-pa-md"},{header:(0,o.w5)((e=>[(0,o.Wm)(z,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{"auto-width":""}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(t=>((0,o.wg)(),(0,o.j4)(i,{key:t.name,props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(t.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,o.w5)((e=>[(0,o.Wm)(z,{class:(0,n.C_)(e.rowIndex%2!==0&&"bg-white"),props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(Y,{key:"colspan","auto-width":""},{default:(0,o.w5)((()=>[(0,o.Wm)(V,{size:"sm",color:"primary",round:"",dense:"",onClick:t=>e.expand=!e.expand,icon:e.expand?"remove":"add"},null,8,["onClick","icon"])])),_:2},1024),(0,o.Wm)(Y,{class:"items-center justify-start",key:"employeeName",props:e},{default:(0,o.w5)((()=>{var t,r;return[(0,o._)("span",u,[null!==(t=e.row.employee.user)&&void 0!==t&&t.avatar?((0,o.wg)(),(0,o.j4)(M,{key:0},{default:(0,o.w5)((()=>{var t;return[(0,o._)("img",{src:null===(t=e.row.employee.user)||void 0===t?void 0:t.avatar},null,8,p)]})),_:2},1024)):((0,o.wg)(),(0,o.j4)(M,{key:1,color:"grey","text-color":"white",icon:"person"}))]),(0,o._)("span",c,(0,n.zw)(null===(r=e.row.employee)||void 0===r?void 0:r.name),1)]})),_:2},1032,["props"]),(0,o.Wm)(Y,{class:"items-center justify-start",key:"overtimeTypeName",props:e},{default:(0,o.w5)((()=>{var t;return[(0,o._)("p",y,(0,n.zw)(null===(t=e.row.overtimeType)||void 0===t?void 0:t.name),1)]})),_:2},1032,["props"]),(0,o.Wm)(Y,{class:"items-center justify-start",key:"currentBalance",props:e},{default:(0,o.w5)((()=>[(0,o._)("p",v,(0,n.zw)(Number(e.row.currentBalance)),1)])),_:2},1032,["props"]),(0,o.Wm)(Y,{class:"items-center justify-start",key:"remainBalance",props:e},{default:(0,o.w5)((()=>[(0,o._)("p",g,(0,n.zw)(Number(e.row.remainBalance)),1)])),_:2},1032,["props"]),(0,o.Wm)(Y,{class:"items-center justify-start",key:"from",props:e},{default:(0,o.w5)((()=>[(0,o._)("p",w,(0,n.zw)(l.dateFunc.formatDate(new Date(e.row.from),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,o.Wm)(Y,{class:"items-center justify-start",key:"to",props:e},{default:(0,o.w5)((()=>[(0,o._)("p",h,(0,n.zw)(l.dateFunc.formatDate(new Date(e.row.to),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,o.Wm)(Y,{class:"items-center justify-start",key:"status",props:e},{default:(0,o.w5)((()=>["rejected"===e.row.status?((0,o.wg)(),(0,o.j4)(N,{key:0,rounded:"",class:"q-pa-sm bg-red text-white"},{default:(0,o.w5)((()=>[f])),_:1})):"completed"===e.row.status?((0,o.wg)(),(0,o.j4)(N,{key:1,rounded:"",class:"q-pa-sm bg-primary text-white"},{default:(0,o.w5)((()=>[b])),_:1})):"pending"===e.row.status?((0,o.wg)(),(0,o.j4)(N,{key:2,rounded:"",class:"q-pa-sm bg-warning text-white"},{default:(0,o.w5)((()=>[_])),_:1})):(0,o.kq)("",!0)])),_:2},1032,["props"]),(0,o.Wm)(Y,{class:"items-center justify-start",key:"description",props:e},{default:(0,o.w5)((()=>[(0,o._)("p",k,(0,n.zw)(e.row.description),1)])),_:2},1032,["props"]),(0,o.Wm)(Y,{class:"items-center justify-start",key:"createdAt",props:e},{default:(0,o.w5)((()=>[(0,o._)("p",x,(0,n.zw)(l.dateFunc.formatDate(new Date(e.row.createdAt),"YYYY-MM-DD")),1)])),_:2},1032,["props"])])),_:2},1032,["class","props"]),(0,o.wy)((0,o.Wm)(z,{class:(0,n.C_)(e.rowIndex%2!==0&&"bg-white")},{default:(0,o.w5)((()=>[(0,o.Wm)(Y,{colspan:"100%"},{default:(0,o.w5)((()=>[T,(0,o._)("div",j,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.row.overtimeApprovals,((t,r)=>{var a;return(0,o.wg)(),(0,o.iD)("span",{key:t,class:"flex text-center justify-center"},[0!==r?((0,o.wg)(),(0,o.iD)("span",D,[(0,o.Wm)(O,{rounded:"",color:"completed"===t.status?"primary":"grey",size:"3px",value:1},null,8,["color"])])):(0,o.kq)("",!0),(0,o._)("span",W,[null!==(a=t.manager)&&void 0!==a&&a.user.avatar?((0,o.wg)(),(0,o.j4)(M,{key:0,size:"35px"},{default:(0,o.w5)((()=>{var e;return[(0,o._)("img",{src:null===(e=t.manager)||void 0===e?void 0:e.user.avatar},null,8,q)]})),_:2},1024)):((0,o.wg)(),(0,o.j4)(M,{key:1,size:"35px",color:"grey","text-color":"white",icon:"person"})),(0,o._)("div",null,(0,n.zw)(t.manager.name),1),1===t.manager.hrMember?((0,o.wg)(),(0,o.iD)("span",B,[e.row.overtimeApprovals.every((e=>"rejected"!==e.status))&&"rejected"===e.row.status?((0,o.wg)(),(0,o.j4)(N,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{name:"close"})])),_:1})):e.row.overtimeApprovals.every((e=>"completed"===e.status))&&"completed"===e.row.status?((0,o.wg)(),(0,o.j4)(N,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{name:"done"})])),_:1})):e.row.overtimeApprovals.every((e=>"completed"===e.status))&&"pending"===e.row.status?((0,o.wg)(),(0,o.j4)(N,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{name:"more_horiz"})])),_:1})):((0,o.wg)(),(0,o.j4)(N,{key:3,rounded:"",class:"bg-grey text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{name:"more_horiz"})])),_:1}))])):((0,o.wg)(),(0,o.iD)("span",A,["rejected"===t.status?((0,o.wg)(),(0,o.j4)(N,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{name:"close"})])),_:1})):(0,o.kq)("",!0),"completed"===t.status?((0,o.wg)(),(0,o.j4)(N,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{name:"done"})])),_:1})):(0,o.kq)("",!0),"pending"===t.status?((0,o.wg)(),(0,o.j4)(N,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{name:"more_horiz"})])),_:1})):(0,o.kq)("",!0),""===t.status?((0,o.wg)(),(0,o.j4)(N,{key:3,rounded:"",class:"bg-warning text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{name:"more_horiz"})])),_:1})):(0,o.kq)("",!0)]))])])})),128))])])),_:2},1024)])),_:2},1032,["class"]),[[m.F8,e.expand]])])),_:1},8,["rows","columns","loading"]),U,(0,o.Wm)(P,{onCloseDialogue:t[1]||(t[1]=e=>l.dialogue=!1),inProfile:!1,seamless:"",position:"right",modelValue:l.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>l.dialogue=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(Q,{onCloseDialogue:t[0]||(t[0]=e=>l.dialogue=!1),currentUser:r.currentUser,body:l.body,id:l.id,actionType:"Edit"},null,8,["currentUser","body","id"])])),_:1},8,["modelValue"])])}r(7098),r(17070);var V=r(93617);const Y=(0,o._)("br",null,null,-1),M={class:"flex col-12"},N={key:0,class:"text-red"},O={key:1,class:"text-red"},C={key:2,class:"text-red"},Z={class:"q-gutter-xs"},Q={class:"row items-center justify-end"},P={class:"row items-center justify-end"};function E(e,t,r,a,l,s){const i=(0,o.up)("q-toolbar-title"),m=(0,o.up)("q-btn"),d=(0,o.up)("q-toolbar"),u=(0,o.up)("q-select"),p=(0,o.up)("q-checkbox"),c=(0,o.up)("q-input"),y=(0,o.up)("q-date"),v=(0,o.up)("q-time"),g=(0,o.up)("q-popup-proxy"),w=(0,o.up)("q-icon"),h=(0,o.up)("q-card-section"),f=(0,o.up)("q-card"),b=(0,o.up)("q-layout"),_=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(b,{style:{width:"500px !important"}},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{style:{"max-width":"500px","min-height":"100vh"},flat:"",square:""},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{class:"q-pa-md bg-grey-3",style:{position:"sticky !important",top:"0","z-index":"15",height:"63px !important"}},{default:(0,o.w5)((()=>[(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(r.actionType)+" Overtime ",1)])),_:1}),(0,o.wy)((0,o.Wm)(m,{icon:"close",flat:"",round:"",dense:""},null,512),[[_]])])),_:1}),(0,o.Wm)(h,{class:"q-gutter-sm scroll"},{default:(0,o.w5)((()=>{var e,a;return[Y,(0,o.Wm)(u,{modelValue:l.overtimeType,"onUpdate:modelValue":[t[0]||(t[0]=e=>l.overtimeType=e),t[1]||(t[1]=e=>s.setRemainingDays({from:l.credentials.from,to:l.credentials.to}))],ref:"overtimeTypeRef","no-caps":"",label:"Overtime Type",loading:l.overtimeTypeLoading,outlined:"",options:l.overtimeTypeOptions,"lazy-rules":"",rules:[e=>e&&e.id||"Please type the Overtime Type"]},null,8,["modelValue","loading","options","rules"]),null!==(e=r.currentUser)&&void 0!==e&&e.myEmployeeProfile.hrMember?((0,o.wg)(),(0,o.j4)(p,{key:0,ref:"forMeRef",outlined:"","onUpdate:modelValue":[s.trigchkbxfrme,t[2]||(t[2]=e=>l.forMe=e)],modelValue:l.forMe,label:"My overtime (Overtime Request for my self)"},null,8,["onUpdate:modelValue","modelValue"])):(0,o.kq)("",!0),null!==(a=r.currentUser)&&void 0!==a&&a.myEmployeeProfile.hrMember?((0,o.wg)(),(0,o.j4)(u,{key:1,modelValue:l.employee,"onUpdate:modelValue":[t[3]||(t[3]=e=>l.employee=e),s.setCurrentBalance],disable:r.currentUser.myEmployeeProfile&&l.forMe,"no-caps":"",label:"Employee",loading:l.employeeLoading,outlined:"",clearable:"",options:l.employeeOptions},null,8,["modelValue","disable","onUpdate:modelValue","loading","options"])):(0,o.kq)("",!0),(0,o.Wm)(c,{outlined:"",disable:"",type:"number",modelValue:l.currentBalance,"onUpdate:modelValue":t[4]||(t[4]=e=>l.currentBalance=e),modelModifiers:{number:!0},label:"Current Balance"},null,8,["modelValue"]),(0,o.Wm)(c,{outlined:"",disable:"",modelValue:l.remainBalanceHours,"onUpdate:modelValue":t[5]||(t[5]=e=>l.remainBalanceHours=e),label:"Remain Balance"},null,8,["modelValue"]),(0,o._)("div",M,[(0,o.Wm)(y,{subtitle:"Pick Duration",mask:"YYYY-MM-DD",class:"my-2 col-12",disable:null==l.overtimeType,"onUpdate:modelValue":[s.setdatetimeDate,t[6]||(t[6]=e=>l.datetimeDate=e)],modelValue:l.datetimeDate,"emit-immediately":"",ref:"fromToRef","lazy-rules":"",rules:[e=>e||"Please type the Employee"]},{default:(0,o.w5)((()=>[l.fromtToToggle?((0,o.wg)(),(0,o.iD)("div",N,"* pick a date")):(0,o.kq)("",!0),l.fromtToDaysExceedToggle?((0,o.wg)(),(0,o.iD)("div",O,"* Days exceeded the balance limit")):(0,o.kq)("",!0),l.fromtToovertimetypeDaysExceedToggle?((0,o.wg)(),(0,o.iD)("div",C,"* Days exceeded the Overtime Type limit")):(0,o.kq)("",!0)])),_:1},8,["disable","onUpdate:modelValue","modelValue","rules"])]),(0,o._)("div",Z,[(0,o.Wm)(c,{class:"col-6",label:"from:",rules:["time"],"onUpdate:modelValue":[s.setdatetimeFrom,t[8]||(t[8]=e=>l.datetimeFrom=e)],filled:"",modelValue:l.datetimeFrom},{prepend:(0,o.w5)((()=>[(0,o.Wm)(w,{name:"access_time",class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{"now-btn":"","onUpdate:modelValue":[s.setdatetimeFrom,t[7]||(t[7]=e=>l.datetimeFrom=e)],modelValue:l.datetimeFrom,mask:"HH:mm",format24h:""},{default:(0,o.w5)((()=>[(0,o._)("div",Q,[(0,o.wy)((0,o.Wm)(m,{label:"Close",color:"primary",flat:""},null,512),[[_]])])])),_:1},8,["onUpdate:modelValue","modelValue"])])),_:1})])),_:1})])),_:1},8,["onUpdate:modelValue","modelValue"]),(0,o.Wm)(c,{class:"col-6",label:"to:",rules:["time"],"onUpdate:modelValue":[s.setdatetimeTo,t[10]||(t[10]=e=>l.datetimeTo=e)],filled:"",modelValue:l.datetimeTo},{prepend:(0,o.w5)((()=>[(0,o.Wm)(w,{name:"access_time",class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{"now-btn":"","onUpdate:modelValue":[s.setdatetimeTo,t[9]||(t[9]=e=>l.datetimeTo=e)],modelValue:l.datetimeTo,mask:"HH:mm",format24h:""},{default:(0,o.w5)((()=>[(0,o._)("div",P,[(0,o.wy)((0,o.Wm)(m,{label:"Close",color:"primary",flat:""},null,512),[[_]])])])),_:1},8,["onUpdate:modelValue","modelValue"])])),_:1})])),_:1})])),_:1},8,["onUpdate:modelValue","modelValue"])]),(0,o.Wm)(c,{ref:"descriptionRef",outlined:"",modelValue:l.credentials.description,"onUpdate:modelValue":t[11]||(t[11]=e=>l.credentials.description=e),label:"Remark"},null,8,["modelValue"])]})),_:1})])),_:1}),(0,o.Wm)(d,{class:"bg-grey-3 submitBtnClass",style:{position:"sticky !important",bottom:"0","z-index":"5"}},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{loading:l.loading,onClick:s.submit,class:"full-width",color:"primary",label:"Submit","no-caps":""},null,8,["loading","onClick"])])),_:1})])),_:1})}r(10071);var R=r(61959),F=r(49549),I=r(11488),S=r(94789);const $={components:{VueTelInput:F.VueTelInput,Datepicker:S.Z},props:["currentUser","actionType","body"],data(){return{show:!0,fromto:(0,R.iH)({from:null,to:null}),id:null,fromtToDaysExceedToggle:!1,datetimeDate:(0,R.iH)(I().format("YYYY-MM-DD")),datetimeFrom:(0,R.iH)(I().format("HH:mm")),datetimeTo:(0,R.iH)(I().format("HH:mm")),fromtToovertimetypeDaysExceedToggle:!1,loading:!1,fromtToToggle:!1,overtimeTypeDuration:"hours",overtimeTypeOptions:[],employeeOptions:[],employee:null,currentBalance:0,forMe:!0,overtimeType:null,overtimeTypeLoading:!1,employeeLoading:!1,remainBalance:(0,R.iH)(0),remainBalanceHours:"",credentials:{description:null,from:null,to:null,currentBalance:0,employeeId:null,overtimeTypeId:null}}},computed:{...(0,V.rn)("hrmStore",["allEmployees","overtimeTypes"])},methods:{...(0,V.nv)("hrmStore",["createOvertime","updateOvertime","getOvertimes","getEmployees","getOvertimeTypes"]),trigchkbxfrme(e){this.employee=null,!1===e&&(this.currentBalance=0,this.remainBalance=0),!0===e&&this.currentUser.myEmployeeProfile&&(this.currentBalance=Number(this.currentUser.myEmployeeProfile.overtimeBalance),this.remainBalance=Number(this.currentBalance),this.setRemainingDays({from:this.credentials.from,to:this.credentials.to}))},toggleShow(){this.show=!this.show},setdatetimeDate(e){let t=`${e} ${this.datetimeFrom}`,r=`${e} ${this.datetimeTo}`;this.fromto={from:t,to:r},this.setRemainingDays({from:t,to:r})},setdatetimeTo(e){let t=`${this.datetimeDate} ${this.datetimeFrom}`,r=`${this.datetimeDate} ${e}`;this.fromto={from:t,to:r},this.setRemainingDays({from:t,to:r})},setdatetimeFrom(e){let t=`${this.datetimeDate} ${e}`,r=`${this.datetimeDate} ${this.datetimeTo}`;this.fromto={from:t,to:r},this.setRemainingDays({from:t,to:r})},setCurrentBalance(e){let t=this.currentBalance-this.remainBalance;this.currentBalance=Number(null===e||void 0===e?void 0:e.overtimeBalance),this.remainBalance=Number((null===e||void 0===e?void 0:e.overtimeBalance)-t),this.setRemainingDays({from:this.credentials.from,to:this.credentials.to})},setRemainingDays(e){var t,r,o;if(null===e&&(e={}),console.log("typeof: ",typeof e,e,"overtimetype: ",this.overtimeType.durationType),"object"===typeof e&&!Object.values(e).includes(null)&&Object.keys(e).includes("from")){var a,l;let t=null===(a=e)||void 0===a?void 0:a.from,r=null===(l=e)||void 0===l?void 0:l.to;"hours"===this.overtimeType.durationType?this.remainBalance=Number(new Date(r)/864e5)-Number(new Date(t))/864e5:this.remainBalance=Number(new Date(r)/864e5)-Number(new Date(t))/864e5+1,console.log("remaining balance in above: ",this.remainBalance),this.remainBalance=Number(this.currentBalance-this.remainBalance),this.credentials.from=e.from,this.credentials.to=e.to}else"string"===typeof e&&""!==e?(console.log("remaining balance in ----: ",this.currentBalance),this.credentials.from=e,this.credentials.to=e,"hours"===this.overtimeType.durationType?this.remainBalance=0:this.remainBalance=1,this.remainBalance=this.currentBalance-this.remainBalance):(this.credentials.from=null,this.credentials.to=null);if(console.log("this remaining balance",this.remainBalance),this.remainBalanceHours=this.currentBalance,"number"===typeof this.remainBalance){var s;let e=this.remainBalance.toFixed(2),t=null===(s=`${e}`)||void 0===s?void 0:s.split("."),r=Number(t[0]),o=(24*(e-r)).toFixed(0);console.log("remaininghours: ",o,r,e),this.remainBalanceHours=r+" Days "+o+" Hours"}this.fromtToovertimetypeDaysExceedToggle=Number(this.currentBalance)-Number(this.remainBalance)>Number(null===(t=this.overtimeType)||void 0===t?void 0:t.hours),console.log("balance: "+Number(this.currentBalance),"remain: "+Number(this.remainBalance),"overtimetype: "+Number(null===(r=this.overtimeType)||void 0===r?void 0:r.hours)),this.fromtToDaysExceedToggle=Number(this.remainBalance)<0&&1!=(null===(o=this.overtimeType)||void 0===o?void 0:o.urgent),this.fromtToToggle=!0===(null===this.credentials.from||null===this.credentials.to)},async submit(){var e,t,r,o,a,l;(null!==this.credentials.from&&null!==this.credentials.to||(this.fromtToToggle=!0),Number(this.currentBalance)-Number(this.remainBalance)>Number(this.overtimeType.hours)&&(this.fromtToovertimetypeDaysExceedToggle=!0),Number(this.remainBalance)<0&&1!=(null===(e=this.overtimeType)||void 0===e?void 0:e.urgent)&&(this.fromtToDaysExceedToggle=!0),this.$refs.overtimeTypeRef.validate(),null!==(t=this.currentUser)&&void 0!==t&&t.myEmployeeProfile)||(this.$refs.employeeRef.validate(),this.forMe&&(this.credentials.employeeId=Number(null===(l=this.currentUser.myEmployeeProfile)||void 0===l?void 0:l.id)));if(!(null!==(r=this.$refs.overtimeTypeRef)&&void 0!==r&&r.hasError||null===this.credentials.from||null===this.credentials.to||!this.forMe&&null!==(o=this.$refs.employeeRef)&&void 0!==o&&o.hasError||Number(this.currentBalance)-Number(this.remainBalance)>Number(this.overtimeType.hours)||Number(this.remainBalance)<0&&1==!(null!==(a=this.overtimeType)&&void 0!==a&&a.urgent))){var s;this.loading=!0;let e={description:this.credentials.description,from:this.credentials.from,to:this.credentials.to,overtimeTypeId:Number(null===(s=this.overtimeType)||void 0===s?void 0:s.id)};var i;if(!this.forMe)e["employeeId"]=Number(null===(i=this.employee)||void 0===i?void 0:i.id);if("Add"===this.actionType){this.overtimeType&&(e["overtimeTypeId"]=Number(this.overtimeType.id)),this.employee&&(this.currentUser.myEmployeeProfile||(e["employeeId"]=Number(this.employee.id)));let t=this;try{await this.createOvertime(e),t.$q.notify({type:"positive",message:"Department created",color:"positive",position:"top",timeout:"500"})}catch(n){t.$q.notify({type:"negative",message:"Something went wrong while requesting Overtime!",color:"negative",position:"top",timeout:"500"})}finally{this.loading=!1,this.$emit("closeDialogue")}}else e["id"]=Number(this.id),await this.updateOvertime(e),this.getOvertimes(),selfout.$q.notify({type:"positive",message:"Department updated",color:"positive",position:"top",timeout:"500"})}},getValuesFromApiAsync(e){return new Promise((async t=>{t(await e)}))}},async mounted(){if("Add"===this.actionType){var e;if(this.employee={label:this.currentUser.myEmployeeProfile.name,id:this.currentUser.myEmployeeProfile.id,overtimeBalance:this.currentUser.myEmployeeProfile.overtimeBalance},this.currentUser.myEmployeeProfile)this.currentBalance=Number(null===(e=this.currentUser.myEmployeeProfile)||void 0===e?void 0:e.overtimeBalance),this.remainBalance=this.currentBalance;this.overtimeTypeLoading=!0,this.getValuesFromApiAsync(this.getOvertimeTypes()).then((()=>{for(let e of this.overtimeTypes)this.overtimeTypeOptions.push({label:`${e.name} - ${Number(e.hours)} ${e.durationType}${e.urgent?" - Urgent":""}`,id:e.id,hours:e.hours,urgent:e.urgent,durationType:e.durationType});this.overtimeTypeLoading=!1})),this.employeeLoading=!0,this.getValuesFromApiAsync(this.getEmployees()).then((()=>{for(let e of this.allEmployees)this.employeeOptions.push({label:e.name,id:e.id,overtimeBalance:e.overtimeBalance});this.employeeLoading=!1}))}if("Edit"===this.actionType){this.id=this.body.id,this.credentials.description=this.body.description;let e=I(this.body.from).format("YYYY-MM-DD").toString(),o=I(this.body.to).format("YYYY-MM-DD").toString();var t,r;if(this.fromto={from:I(this.body.from).format("YYYY-MM-DD"),to:I(this.body.to).format("YYYY-MM-DD").toString()},e===o&&(this.fromto=I(this.body.from).format("YYYY-MM-DD")),this.credentials.from=this.body.from,this.credentials.to=this.body.to,this.credentials.currentBalance=this.body.currentBalance,this.credentials.remainBalance=this.body.remainBalance,this.overtimeTypeLoading=!0,this.getValuesFromApiAsync(this.getOvertimeTypes()).then((()=>{for(let t of this.overtimeTypes)this.overtimeTypeOptions.push({label:`${t.name} - ${Number(t.hours)} ${t.durationType}${t.urgent?" - Urgent":""}`,id:t.id,hours:t.hours,urgent:t.urgent,durationType:t.durationType});var e;(this.overtimeType={label:`${this.body.overtimeType.name} - ${Number(this.body.overtimeType.hours)} ${overtimeType.durationType}${this.body.overtimeType.urgent?" - Urgent":""}`,id:this.body.overtimeType.id,hours:this.body.overtimeType.hours,urgent:this.body.overtimeType.urgent,durationType:overtimeType.durationType},this.overtimeTypeLoading=!1,this.employee={label:this.currentUser.myEmployeeProfile.name,id:this.currentUser.myEmployeeProfile.id,overtimeBalance:this.currentUser.myEmployeeProfile.overtimeBalance},this.currentUser.myEmployeeProfile)&&(this.currentBalance=Number(null===(e=this.currentUser.myEmployeeProfile)||void 0===e?void 0:e.overtimeBalance),this.remainBalance=this.currentBalance,this.setRemainingDays(this.fromto))})),this.currentUser.myEmployeeProfile)this.employee={label:null===(t=this.currentUser.myEmployeeProfile)||void 0===t?void 0:t.name,id:null===(r=this.currentUser.myEmployeeProfile)||void 0===r?void 0:r.id};else this.employeeLoading=!0,this.getValuesFromApiAsync(this.getEmployees()).then((()=>{var e,t,r,o;for(let a of this.allEmployees)this.employeeOptions.push({label:a.name,id:a.id,overtimeBalance:a.overtimeBalance});this.employee={label:null===(e=this.body.employee)||void 0===e?void 0:e.name,id:null===(t=this.body.employee)||void 0===t?void 0:t.id,overtimeBalance:null===(r=this.body.employee)||void 0===r?void 0:r.overtimeBalance},this.currentBalance=null===(o=this.body.employee)||void 0===o?void 0:o.overtimeBalance,this.employeeLoading=!1}))}console.log("overtimetpye----",this.employee)}};var H=r(19214),L=r(10151),J=r(39570),K=r(13747),G=r(2165),X=r(25589),ee=r(63314),te=r(66271),re=r(64689),oe=r(85626),ae=r(24554),le=r(83944),se=r(35990),ie=r(60677),ne=r(7518),me=r.n(ne);$.render=E;const de=$;me()($,"components",{QLayout:H.Z,QCard:L.Z,QToolbar:J.Z,QToolbarTitle:K.Z,QBtn:G.Z,QCardSection:X.Z,QSelect:ee.Z,QCheckbox:te.Z,QInput:re.Z,QDate:oe.Z,QIcon:ae.Z,QPopupProxy:le.Z,QTime:se.Z}),me()($,"directives",{ClosePopup:ie.Z});var ue=r(25616);const pe={computed:{...(0,V.rn)("hrmStore",["overtimes"]),data(){let e=JSON.parse(JSON.stringify(this.overtimes)).sort(((e,t)=>t["id"]-e["id"])),t=e.map((e=>{const t={status:"",manager:{name:"HR",hrMember:1,user:{name:"HR",avatar:null}}};if(e.overtimeApprovals.some((e=>1===e.manager.hrMember)))return e;{let r=e;return e.overtimeApprovals.every((e=>"completed"===e.status))&&(t.status="pending"),e.overtimeApprovals.every((e=>"completed"===e.status))&&"completed"===e.status&&(t.status="completed"),r.overtimeApprovals=r.overtimeApprovals.reverse(),r.overtimeApprovals.push(t),r}}));return console.log("overtimes: ",t),t}},props:["currentUser"],data(){return{body:null,id:null,dateFunc:ue.ZP,dialogue:!1,loading:!1,columns:[{name:"employeeName",label:"Employee Name",align:"left",sortable:!0,field:"employeeName"},{name:"overtimeTypeName",label:"Overtime Type",align:"left",sortable:!0,field:"overtimeTypeName"},{name:"currentBalance",label:"Previouse Balance",align:"left",sortable:!0,field:"currentBalance"},{name:"remainBalance",label:"Remained Balance",align:"left",sortable:!0,field:"remainBalance"},{name:"from",label:"From",align:"left",sortable:!0,field:"from"},{name:"to",label:"To",align:"left",sortable:!0,field:"to"},{name:"status",label:"Status",align:"left",sortable:!0,field:"status"},{name:"description",label:"Remark",align:"left",sortable:!0,field:"description"},{name:"createdAt",label:"Requested Date",align:"left",sortable:!0,field:"issuedAt"}]}},components:{modal:de},methods:{...(0,V.nv)("hrmStore",["getOvertimes","deleteOvertime"]),...(0,V.nv)("example",["getUser"]),editOvertime(e){if(!0===this.dialogue)return this.dialogue=!1,void setTimeout((()=>{this.body=e,this.dialogue=!0}),200);this.body=e,this.dialogue=!0},rowColor(e){if(e.rowIndex%2!==0||0!==e.rowIndex)return"background: #fff;"}},async mounted(){this.loading=!0,await this.getOvertimes(),this.loading=!1}};var ce=r(57678),ye=r(18186),ve=r(92414),ge=r(83884),we=r(75096),he=r(69721),fe=r(20811),be=r(27011),_e=r(83414),ke=r(52035),xe=r(65869),Te=r(51598),je=r(46778);pe.render=z;const De=pe;me()(pe,"components",{QTable:ce.Z,QTr:ye.Z,QTh:ve.Z,QTd:ge.Z,QBtn:G.Z,QAvatar:we.Z,QBadge:he.Z,QMenu:fe.Z,QList:be.Z,QItem:_e.Z,QItemSection:ke.Z,QIcon:ae.Z,QSeparator:xe.Z,QLinearProgress:Te.Z,QDialog:je.Z}),me()(pe,"directives",{ClosePopup:ie.Z});const We=(0,o._)("h6",{class:"q-pa-md"},"Pending Approval Overtimes",-1),qe={class:"q-mr-sm"},Be=["src"],Ae={style:{"font-size":"17px"}},Ue={style:{"font-size":"17px"}},ze={style:{"font-size":"17px"}},Ve={style:{"font-size":"17px"}},Ye={style:{"font-size":"17px"}},Me={style:{"font-size":"17px"}},Ne=(0,o.Uk)("Rejected"),Oe=(0,o.Uk)("Completed"),Ce=(0,o.Uk)("Pending"),Ze={style:{"font-size":"17px"}},Qe={style:{"font-size":"17px"}},Pe={key:0,class:"row",style:{"min-width":"75px"}},Ee=(0,o.Uk)("Approve hr "),Re=(0,o.Uk)("Reject hr "),Fe={key:1,class:"flex align-items-center"},Ie=(0,o.Uk)("Approve "),Se=(0,o.Uk)("Reject "),$e=(0,o._)("div",{class:"q-mb-sm"},"Approval Stage",-1),He={class:"col-12 flex"},Le={key:0,class:"flex items-center q-mx-md",style:{width:"80px"}},Je={class:"text-center justify-center"},Ke=["src"],Ge={key:2},Xe={key:3},et=(0,o._)("hr",null,null,-1);function tt(e,t,r,a,l,s){const i=(0,o.up)("q-th"),d=(0,o.up)("q-tr"),u=(0,o.up)("q-btn"),p=(0,o.up)("q-td"),c=(0,o.up)("q-avatar"),y=(0,o.up)("q-badge"),v=(0,o.up)("q-icon"),g=(0,o.up)("q-linear-progress"),w=(0,o.up)("q-table"),h=(0,o.up)("modal"),f=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.iD)("div",null,[We,(0,o.Wm)(w,{rows:s.data,columns:l.columns,"rows-per-page-options":[5,50,100,0],"row-key":"id",loading:l.loading,flat:"",class:"bg-secondary q-pa-md"},{header:(0,o.w5)((e=>[(0,o.Wm)(d,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{"auto-width":""}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(t=>((0,o.wg)(),(0,o.j4)(i,{key:t.name,props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(t.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,o.w5)((t=>[(0,o.Wm)(d,{class:(0,n.C_)(t.rowIndex%2!==0&&"bg-white"),props:t},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{key:"colspan","auto-width":""},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{size:"sm",color:"primary",round:"",dense:"",onClick:e=>t.expand=!t.expand,icon:t.expand?"remove":"add"},null,8,["onClick","icon"])])),_:2},1024),(0,o.Wm)(p,{class:"items-center justify-start",key:"employeeName",props:t},{default:(0,o.w5)((()=>{var e,r,a;return[(0,o._)("span",qe,[null!==(e=t.row.employee)&&void 0!==e&&null!==(r=e.user)&&void 0!==r&&r.avatar?((0,o.wg)(),(0,o.j4)(c,{key:0},{default:(0,o.w5)((()=>{var e,r;return[(0,o._)("img",{src:null===(e=t.row.employee)||void 0===e||null===(r=e.user)||void 0===r?void 0:r.avatar},null,8,Be)]})),_:2},1024)):((0,o.wg)(),(0,o.j4)(c,{key:1,color:"grey","text-color":"white",icon:"person"}))]),(0,o._)("span",Ae,(0,n.zw)(null===(a=t.row.employee)||void 0===a?void 0:a.name),1)]})),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"overtimeTypeName",props:t},{default:(0,o.w5)((()=>{var e;return[(0,o._)("p",Ue,(0,n.zw)(null===(e=t.row.overtimeType)||void 0===e?void 0:e.name),1)]})),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"currentBalance",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",ze,(0,n.zw)(Number(t.row.currentBalance)),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"remainBalance",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",Ve,(0,n.zw)(Number(t.row.remainBalance)),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"from",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",Ye,(0,n.zw)(l.dateFunc.formatDate(new Date(t.row.from),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"to",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",Me,(0,n.zw)(l.dateFunc.formatDate(new Date(t.row.to),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"status",props:t},{default:(0,o.w5)((()=>["rejected"===t.row.status?((0,o.wg)(),(0,o.j4)(y,{key:0,rounded:"",class:"q-pa-sm bg-red text-white"},{default:(0,o.w5)((()=>[Ne])),_:1})):"completed"===t.row.status?((0,o.wg)(),(0,o.j4)(y,{key:1,rounded:"",class:"q-pa-sm bg-primary text-white"},{default:(0,o.w5)((()=>[Oe])),_:1})):"pending"===t.row.status?((0,o.wg)(),(0,o.j4)(y,{key:2,rounded:"",class:"q-pa-sm bg-warning text-white"},{default:(0,o.w5)((()=>[Ce])),_:1})):(0,o.kq)("",!0)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"description",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",Ze,(0,n.zw)(t.row.description),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"createdAt",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",Qe,(0,n.zw)(l.dateFunc.formatDate(new Date(t.row.createdAt),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"text-right",key:"actions",props:t},{default:(0,o.w5)((()=>{var a,i;return[1===(null===(a=r.currentUser)||void 0===a||null===(i=a.myEmployeeProfile)||void 0===i?void 0:i.hrMember)?((0,o.wg)(),(0,o.iD)("div",Pe,[(0,o.Wm)(u,{class:"col",size:"sm",loading:l.approveLoading===t.row.id,onClick:e=>s.approveOvertimeMiddle({id:t.row.id,status:"completed"}),flat:"","no-caps":"",disable:t.row.isRejectCompleted||t.row.overtimeApprovals.some((e=>"rejected"===e.status))||"rejected"===t.row.status},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"text-bold",name:"done",color:t.row.isRejectCompleted||t.row.overtimeApprovals.some((e=>"rejected"===e.status))||"rejected"===t.row.status?"grey":"primary",size:"xs"},null,8,["color"]),Ee])),_:2},1032,["loading","onClick","disable"]),(0,o.Wm)(u,{class:"col",loading:l.rejectLoading===t.row.id,onClick:r=>e.approveOvertime({id:t.row.id,status:"rejected"}),size:"sm",flat:"","no-caps":"",disable:t.row.isRejectCompleted||t.row.overtimeApprovals.some((e=>"rejected"===e.status))||"rejected"===t.row.status},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"text-bold",name:"close",color:t.row.isRejectCompleted||t.row.overtimeApprovals.some((e=>"rejected"===e.status))||"rejected"===t.row.status?"grey":"red",size:"xs"},null,8,["color"]),Re])),_:2},1032,["loading","onClick","disable"])])):((0,o.wg)(),(0,o.iD)("div",Fe,[(0,o.Wm)(u,{class:"col",loading:l.approveLoading===t.row.id,onClick:e=>s.updateApprovalMiddle({id:t.row.id,status:"completed"}),size:"sm",flat:"","no-caps":"",disable:t.row.isRejectCompleted},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"text-bold",name:"done",color:t.row.isRejectCompleted?"grey":"primary",size:"xs"},null,8,["color"]),Ie])),_:2},1032,["loading","onClick","disable"]),(0,o.Wm)(u,{loading:l.rejectLoading===t.row.id,class:"col",onClick:e=>s.updateApprovalMiddle({id:t.row.id,status:"rejected"}),size:"sm",flat:"","no-caps":"",disable:t.row.isRejectCompleted},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"text-bold",name:"close",color:t.row.isRejectCompleted?"grey":"red",size:"xs"},null,8,["color"]),Se])),_:2},1032,["loading","onClick","disable"])]))]})),_:2},1032,["props"])])),_:2},1032,["class","props"]),(0,o.wy)((0,o.Wm)(d,{class:(0,n.C_)(t.rowIndex%2!==0&&"bg-white")},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{colspan:"100%"},{default:(0,o.w5)((()=>[$e,(0,o._)("div",He,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.row.overtimeApprovals,((e,r)=>{var a;return(0,o.wg)(),(0,o.iD)("span",{key:e,class:"flex text-center justify-center"},[0!==r?((0,o.wg)(),(0,o.iD)("span",Le,[(0,o.Wm)(g,{rounded:"",color:"completed"===e.status?"primary":"grey",size:"3px",value:1},null,8,["color"])])):(0,o.kq)("",!0),(0,o._)("span",Je,[null!==(a=e.manager)&&void 0!==a&&a.user.avatar?((0,o.wg)(),(0,o.j4)(c,{key:0,size:"35px"},{default:(0,o.w5)((()=>{var t;return[(0,o._)("img",{src:null===(t=e.manager)||void 0===t?void 0:t.user.avatar},null,8,Ke)]})),_:2},1024)):((0,o.wg)(),(0,o.j4)(c,{key:1,size:"35px",color:"grey","text-color":"white",icon:"person"})),(0,o._)("div",null,(0,n.zw)(e.manager.name),1),1===e.manager.hrMember?((0,o.wg)(),(0,o.iD)("span",Ge,[t.row.overtimeApprovals.every((e=>"rejected"!==e.status))&&"rejected"===t.row.status?((0,o.wg)(),(0,o.j4)(y,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{name:"close"})])),_:1})):t.row.overtimeApprovals.every((e=>"completed"===e.status))&&"completed"===t.row.status?((0,o.wg)(),(0,o.j4)(y,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{name:"done"})])),_:1})):t.row.overtimeApprovals.every((e=>"completed"===e.status))&&"pending"===t.row.status?((0,o.wg)(),(0,o.j4)(y,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{name:"more_horiz"})])),_:1})):((0,o.wg)(),(0,o.j4)(y,{key:3,rounded:"",class:"bg-grey text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{name:"more_horiz"})])),_:1}))])):((0,o.wg)(),(0,o.iD)("span",Xe,["rejected"===e.status?((0,o.wg)(),(0,o.j4)(y,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{name:"close"})])),_:1})):(0,o.kq)("",!0),"completed"===e.status?((0,o.wg)(),(0,o.j4)(y,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{name:"done"})])),_:1})):(0,o.kq)("",!0),"pending"===e.status?((0,o.wg)(),(0,o.j4)(y,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{name:"more_horiz"})])),_:1})):(0,o.kq)("",!0),""===e.status?((0,o.wg)(),(0,o.j4)(y,{key:3,rounded:"",class:"bg-warning text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{name:"more_horiz"})])),_:1})):(0,o.kq)("",!0)]))])])})),128))])])),_:2},1024)])),_:2},1032,["class"]),[[m.F8,t.expand]])])),_:1},8,["rows","columns","loading"]),et,(0,o.Wm)(f,{onCloseDialogue:t[1]||(t[1]=e=>l.dialogue=!1),inProfile:!1,seamless:"",position:"right",modelValue:l.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>l.dialogue=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{onCloseDialogue:t[0]||(t[0]=e=>l.dialogue=!1),currentUser:r.currentUser,body:l.body,id:l.id,actionType:"Edit"},null,8,["currentUser","body","id"])])),_:1},8,["modelValue"])])}const rt={computed:{...(0,V.rn)("hrmStore",["overtimeApprovals"]),data(){let e=JSON.parse(JSON.stringify(this.overtimeApprovals)).sort(((e,t)=>t["id"]-e["id"])),t=e.map((e=>{const t={status:"",manager:{name:"HR",hrMember:1,user:{name:"HR",avatar:null}}};if(e.overtimeApprovals.some((e=>1===e.manager.hrMember)))return e;{let r=e;return e.overtimeApprovals.every((e=>"completed"===e.status))&&(t.status="pending"),e.overtimeApprovals.every((e=>"completed"===e.status))&&"completed"===e.status&&(t.status="completed"),r.overtimeApprovals=r.overtimeApprovals.reverse(),r.overtimeApprovals.push(t),r["isRejectCompleted"]=this.checkInApprovals(r.overtimeApprovals),r}}));return console.log("overtime approvals: ",t),t}},props:["currentUser"],data(){return{body:null,id:null,approveLoading:null,rejectLoading:null,dateFunc:ue.ZP,dialogue:!1,loading:!1,columns:[{name:"employeeName",label:"Employee Name",align:"left",sortable:!0,field:"employeeName"},{name:"overtimeTypeName",label:"Overtime Type",align:"left",sortable:!0,field:"overtimeTypeName"},{name:"currentBalance",label:"Previouse Balance",align:"left",sortable:!0,field:"currentBalance"},{name:"remainBalance",label:"Remained Balance",align:"left",sortable:!0,field:"remainBalance"},{name:"from",label:"From",align:"left",sortable:!0,field:"from"},{name:"to",label:"To",align:"left",sortable:!0,field:"to"},{name:"status",label:"Status",align:"left",sortable:!0,field:"status"},{name:"description",label:"Remark",align:"left",sortable:!0,field:"description"},{name:"createdAt",label:"Requested Date",align:"left",sortable:!0,field:"issuedAt"},{name:"actions",label:"Actions",align:"right",field:"actions"}]}},components:{modal:de},methods:{...(0,V.nv)("hrmStore",["getOvertimeApprovals","updateApproval","approveOvertime"]),...(0,V.nv)("example",["getUser"]),async approveOvertimeMiddle(e){"rejected"===e.status&&(this.rejectLoading=e.id,await this.approveOvertime(e),this.rejectLoading=null),"completed"===e.status&&(this.approveLoading=e.id,await this.approveOvertime(e),this.approveLoading=null)},async updateApprovalMiddle(e){"rejected"===e.status&&(this.rejectLoading=e.id,await this.updateApproval(e),this.rejectLoading=null),"completed"===e.status&&(this.approveLoading=e.id,await this.updateApproval(e),this.approveLoading=null)},checkInApprovals(e){return 1===this.currentUser.myEmployeeProfile.hrMember?e.some((e=>1===e.manager.hrMember&&["completed","rejected"].includes(e.status)))&&e.some((e=>!["pending",""].includes(e.status))):e.some((e=>{var t;return e.managerId===(null===(t=this.currentUser.myEmployeeProfile)||void 0===t?void 0:t.id)&&["completed","rejected"].includes(e.status)}))&&e.some((e=>!["pending",""].includes(e.status)))},rowColor(e){if(e.rowIndex%2!==0||0!==e.rowIndex)return"background: #fff;"}},async mounted(){this.loading=!0,await this.getOvertimeApprovals(),this.loading=!1}};rt.render=tt;const ot=rt;me()(rt,"components",{QTable:ce.Z,QTr:ye.Z,QTh:ve.Z,QTd:ge.Z,QBtn:G.Z,QAvatar:we.Z,QBadge:he.Z,QIcon:ae.Z,QLinearProgress:Te.Z,QDialog:je.Z});const at=(0,o._)("h6",{class:"q-pa-md"},"My Overtimes",-1),lt={style:{"font-size":"17px"}},st={style:{"font-size":"17px"}},it={style:{"font-size":"17px"}},nt={style:{"font-size":"17px"}},mt={style:{"font-size":"17px"}},dt=(0,o.Uk)("Rejected"),ut=(0,o.Uk)("Completed"),pt=(0,o.Uk)("Pending"),ct={style:{"font-size":"17px"}},yt={style:{"font-size":"17px"}},vt=(0,o._)("div",{class:"q-mb-sm"},"Approval Stage",-1),gt={class:"col-12 flex"},wt={key:0,class:"flex items-center q-mx-md",style:{width:"80px"}},ht={class:"text-center justify-center"},ft=["src"],bt={key:2},_t={key:3},kt=(0,o._)("hr",null,null,-1);function xt(e,t,r,a,l,s){const i=(0,o.up)("q-th"),d=(0,o.up)("q-tr"),u=(0,o.up)("q-btn"),p=(0,o.up)("q-td"),c=(0,o.up)("q-badge"),y=(0,o.up)("q-icon"),v=(0,o.up)("q-item-section"),g=(0,o.up)("q-item"),w=(0,o.up)("q-separator"),h=(0,o.up)("q-list"),f=(0,o.up)("q-menu"),b=(0,o.up)("q-linear-progress"),_=(0,o.up)("q-avatar"),k=(0,o.up)("q-table"),x=(0,o.up)("modal"),T=(0,o.up)("q-dialog"),j=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)("div",null,[at,(0,o.Wm)(k,{rows:s.data,columns:l.columns,"rows-per-page-options":[5,50,100,0],"row-key":"id",loading:l.loading,flat:"",class:"bg-secondary q-pa-md"},{header:(0,o.w5)((e=>[(0,o.Wm)(d,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{"auto-width":""}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(t=>((0,o.wg)(),(0,o.j4)(i,{key:t.name,props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(t.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,o.w5)((t=>[(0,o.Wm)(d,{class:(0,n.C_)(t.rowIndex%2!==0&&"bg-white"),props:t},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{key:"colspan","auto-width":""},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{size:"sm",color:"primary",round:"",dense:"",onClick:e=>t.expand=!t.expand,icon:t.expand?"remove":"add"},null,8,["onClick","icon"])])),_:2},1024),(0,o.Wm)(p,{class:"items-center justify-start",key:"overtimeTypeName",props:t},{default:(0,o.w5)((()=>{var e;return[(0,o._)("p",lt,(0,n.zw)(null===(e=t.row.overtimeType)||void 0===e?void 0:e.name),1)]})),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"currentBalance",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",st,(0,n.zw)(Number(t.row.currentBalance)),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"remainBalance",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",it,(0,n.zw)(Number(t.row.remainBalance)),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"from",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",nt,(0,n.zw)(l.dateFunc.formatDate(new Date(t.row.from),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"to",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",mt,(0,n.zw)(l.dateFunc.formatDate(new Date(t.row.to),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"status",props:t},{default:(0,o.w5)((()=>["rejected"===t.row.status?((0,o.wg)(),(0,o.j4)(c,{key:0,rounded:"",class:"q-pa-sm bg-red text-white"},{default:(0,o.w5)((()=>[dt])),_:1})):"completed"===t.row.status?((0,o.wg)(),(0,o.j4)(c,{key:1,rounded:"",class:"q-pa-sm bg-primary text-white"},{default:(0,o.w5)((()=>[ut])),_:1})):"pending"===t.row.status?((0,o.wg)(),(0,o.j4)(c,{key:2,rounded:"",class:"q-pa-sm bg-warning text-white"},{default:(0,o.w5)((()=>[pt])),_:1})):(0,o.kq)("",!0)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"description",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",ct,(0,n.zw)(t.row.description),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"items-center justify-start",key:"createdAt",props:t},{default:(0,o.w5)((()=>[(0,o._)("p",yt,(0,n.zw)(l.dateFunc.formatDate(new Date(t.row.createdAt),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,o.Wm)(p,{class:"text-right",key:"actions",props:t},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{dense:"",round:"",flat:"",icon:"more_vert"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{"transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{style:{"min-width":"75px"}},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(g,{onClick:r=>e.deleteOvertime({id:t.row.id}),style:{},clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"flex flex-center"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"delete",color:"negative",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[j]]),(0,o.Wm)(w),(0,o.wy)((0,o.Wm)(g,{onClick:e=>s.editOvertime(t.row),clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"flex flex-center"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"edit",color:"warning",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[j]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["class","props"]),(0,o.wy)((0,o.Wm)(d,{class:(0,n.C_)(t.rowIndex%2!==0&&"bg-white")},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{colspan:"100%"},{default:(0,o.w5)((()=>[vt,(0,o._)("div",gt,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.row.overtimeApprovals,((e,r)=>{var a;return(0,o.wg)(),(0,o.iD)("span",{key:e,class:"flex text-center justify-center"},[0!==r?((0,o.wg)(),(0,o.iD)("span",wt,[(0,o.Wm)(b,{rounded:"",color:"completed"===e.status?"primary":"grey",size:"3px",value:1},null,8,["color"])])):(0,o.kq)("",!0),(0,o._)("span",ht,[null!==(a=e.manager)&&void 0!==a&&a.user.avatar?((0,o.wg)(),(0,o.j4)(_,{key:0,size:"35px"},{default:(0,o.w5)((()=>{var t;return[(0,o._)("img",{src:null===(t=e.manager)||void 0===t?void 0:t.user.avatar},null,8,ft)]})),_:2},1024)):((0,o.wg)(),(0,o.j4)(_,{key:1,size:"35px",color:"grey","text-color":"white",icon:"person"})),(0,o._)("div",null,(0,n.zw)(e.manager.name),1),1===e.manager.hrMember?((0,o.wg)(),(0,o.iD)("span",bt,[t.row.overtimeApprovals.every((e=>"rejected"!==e.status))&&"rejected"===t.row.status?((0,o.wg)(),(0,o.j4)(c,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"close"})])),_:1})):t.row.overtimeApprovals.every((e=>"completed"===e.status))&&"completed"===t.row.status?((0,o.wg)(),(0,o.j4)(c,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"done"})])),_:1})):t.row.overtimeApprovals.every((e=>"completed"===e.status))&&"pending"===t.row.status?((0,o.wg)(),(0,o.j4)(c,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"more_horiz"})])),_:1})):((0,o.wg)(),(0,o.j4)(c,{key:3,rounded:"",class:"bg-grey text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"more_horiz"})])),_:1}))])):((0,o.wg)(),(0,o.iD)("span",_t,["rejected"===e.status?((0,o.wg)(),(0,o.j4)(c,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"close"})])),_:1})):(0,o.kq)("",!0),"completed"===e.status?((0,o.wg)(),(0,o.j4)(c,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"done"})])),_:1})):(0,o.kq)("",!0),"pending"===e.status?((0,o.wg)(),(0,o.j4)(c,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"more_horiz"})])),_:1})):(0,o.kq)("",!0),""===e.status?((0,o.wg)(),(0,o.j4)(c,{key:3,rounded:"",class:"bg-warning text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"more_horiz"})])),_:1})):(0,o.kq)("",!0)]))])])})),128))])])),_:2},1024)])),_:2},1032,["class"]),[[m.F8,t.expand]])])),_:1},8,["rows","columns","loading"]),kt,(0,o.Wm)(T,{onCloseDialogue:t[1]||(t[1]=e=>l.dialogue=!1),inProfile:!1,seamless:"",position:"right",modelValue:l.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>l.dialogue=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{onCloseDialogue:t[0]||(t[0]=e=>l.dialogue=!1),currentUser:r.currentUser,body:l.body,id:l.id,actionType:"Edit"},null,8,["currentUser","body","id"])])),_:1},8,["modelValue"])])}const Tt={computed:{...(0,V.rn)("hrmStore",["myOvertimes"]),data(){const e={status:"",manager:{name:"HR",hrMember:1,user:{name:"HR",avatar:null}}};let t=JSON.parse(JSON.stringify(this.myOvertimes)).sort(((e,t)=>t["id"]-e["id"])),r=t.map((t=>{if(t.overtimeApprovals.some((e=>1===e.manager.hrMember)))return t;{let r=t;return t.overtimeApprovals.every((e=>"completed"===e.status))&&(e.status="pending"),t.overtimeApprovals.every((e=>"completed"===e.status))&&"completed"===t.status&&(e.status="completed"),r.overtimeApprovals=r.overtimeApprovals.reverse(),r.overtimeApprovals.push(e),console.log("copy overtimes: ",r),r}}));return r}},props:["currentUser"],data(){return{body:null,id:null,dateFunc:ue.ZP,dialogue:!1,loading:!1,columns:[{name:"overtimeTypeName",label:"Overtime Type",align:"left",sortable:!0,field:"overtimeTypeName"},{name:"currentBalance",label:"Previouse Balance",align:"left",sortable:!0,field:"currentBalance"},{name:"remainBalance",label:"Remained Balance",align:"left",sortable:!0,field:"remainBalance"},{name:"from",label:"From",align:"left",sortable:!0,field:"from"},{name:"to",label:"To",align:"left",sortable:!0,field:"to"},{name:"status",label:"Status",align:"left",sortable:!0,field:"status"},{name:"description",label:"Remark",align:"left",sortable:!0,field:"description"},{name:"createdAt",label:"Requested Date",align:"left",sortable:!0,field:"issuedAt"},{name:"actions",label:"Actions",align:"right",field:"actions"}]}},components:{modal:de},methods:{...(0,V.nv)("hrmStore",["getMyOvertimes","deleteOvertime"]),...(0,V.nv)("example",["getUser"]),editOvertime(e){if(!0===this.dialogue)return this.dialogue=!1,void setTimeout((()=>{this.body=e,this.dialogue=!0}),200);this.body=e,this.dialogue=!0},rowColor(e){if(e.rowIndex%2!==0||0!==e.rowIndex)return"background: #fff;"}},async mounted(){this.loading=!0,await this.getMyOvertimes(),this.loading=!1}};Tt.render=xt;const jt=Tt;me()(Tt,"components",{QTable:ce.Z,QTr:ye.Z,QTh:ve.Z,QTd:ge.Z,QBtn:G.Z,QBadge:he.Z,QMenu:fe.Z,QList:be.Z,QItem:_e.Z,QItemSection:ke.Z,QIcon:ae.Z,QSeparator:xe.Z,QLinearProgress:Te.Z,QAvatar:we.Z,QDialog:je.Z}),me()(Tt,"directives",{ClosePopup:ie.Z});const Dt={components:{modal:de,overtimesTable:De,overtimeApprovalsTable:ot,myOvertimesTable:jt},computed:{...(0,V.rn)("example",["user"])},data(){return{myOvertimesView:!1,overtimeApprovalsView:!1,overtimesView:!1,dialogue:!1,hrMember:!1}},methods:{...(0,V.nv)("example",["getUser"])},setup(){return{tab:(0,R.iH)("overtime")}},async mounted(){var e,t,r,o,a,l,s,i;(await this.getUser(),console.log("user permission: ",this.user.userType,this.user.myEmployeeProfile),"owner"===(null===(e=this.user)||void 0===e?void 0:e.userType)&&(this.overtimeApprovalsView=!0,this.overtimesView=!0),"admin"===(null===(t=this.user)||void 0===t?void 0:t.userType))&&(null!==(o=this.user)&&void 0!==o&&o.myEmployeeProfile&&1===(null===(a=this.user)||void 0===a?void 0:a.myEmployeeProfile.hrMember)&&(console.log("hrmanager"),this.overtimeApprovalsView=!0,this.overtimesView=!0),null!==(l=this.user)&&void 0!==l&&l.myEmployeeProfile&&0===(null===(s=this.user)||void 0===s?void 0:s.myEmployeeProfile.hrMember)&&(this.myOvertimesView=!0,this.overtimeApprovalsView=!0));"agent"===(null===(r=this.user)||void 0===r?void 0:r.userType)&&(console.log("employee"),null!==(i=this.user)&&void 0!==i&&i.myEmployeeProfile&&(this.myOvertimesView=!0));console.log("manager",this.myOvertimesView,this.overtimeApprovalsView,this.overtimesView)}};var Wt=r(24379),qt=r(47704);Dt.render=i;const Bt=Dt;me()(Dt,"components",{QPage:Wt.Z,QBtn:G.Z,QScrollArea:qt.Z,QDialog:je.Z})}}]);