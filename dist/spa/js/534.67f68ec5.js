"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[534],{9541:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Ce});var l=i(3673);const o={class:"flex justify-between items-center"},n=(0,l._)("p",{class:"text-h4"},"Quotation",-1);function s(e,t,i,s,a,d){const c=(0,l.up)("breadcrumps"),u=(0,l.up)("q-btn"),r=(0,l.up)("q-tab"),m=(0,l.up)("q-tabs"),p=(0,l.up)("tbl"),h=(0,l.up)("q-tab-panel"),b=(0,l.up)("q-tab-panels"),f=(0,l.up)("modal"),v=(0,l.up)("q-dialog"),y=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(y,{class:"q-pa-md"},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l._)("div",null,[n,(0,l.Wm)(c,{map:s.crumps},null,8,["map"])]),(0,l.Wm)(u,{onClick:t[0]||(t[0]=e=>a.prompt=!0),color:"primary",label:"Create Record",unelevated:"",rounded:"","no-caps":""})]),(0,l.Wm)(m,{modelValue:a.tab,"onUpdate:modelValue":t[1]||(t[1]=e=>a.tab=e),dense:"",class:"text-grey q-mt-md bg-white rounded-borders bordered","active-color":"primary","indicator-color":"primary",align:"justify"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{"no-caps":"",name:"Sent",label:"Sent"}),(0,l.Wm)(r,{"no-caps":"",name:"Accepted",label:"Accepted"}),(0,l.Wm)(r,{"no-caps":"",name:"Rejected",label:"Rejected"})])),_:1},8,["modelValue"]),(0,l.Wm)(b,{class:"bg-secondary",modelValue:a.tab,"onUpdate:modelValue":t[2]||(t[2]=e=>a.tab=e),animated:""},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{name:"Sent",class:"q-pa-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{type:"Sent"})])),_:1}),(0,l.Wm)(h,{class:"bg-secondary",name:"Accepted"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{type:"Accepted"})])),_:1}),(0,l.Wm)(h,{class:"bg-secondary",name:"Rejected"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{type:"Rejected"})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(v,{seamless:"",position:"right",modelValue:a.prompt,"onUpdate:modelValue":t[4]||(t[4]=e=>a.prompt=e),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{onCloseDialogue:t[3]||(t[3]=e=>a.prompt=!1),action:"Add",invoiceType:a.tab},null,8,["invoiceType"])])),_:1},8,["modelValue"])])),_:1})}var a=i(6303),d=i(2323);const c={class:"text-h6",style:{"font-size":"15px",margin:"0 !important"}};function u(e,t,i,o,n,s){const a=(0,l.up)("router-link"),u=(0,l.up)("q-td"),r=(0,l.up)("q-icon"),m=(0,l.up)("q-item-section"),p=(0,l.up)("q-item"),h=(0,l.up)("q-separator"),b=(0,l.up)("q-list"),f=(0,l.up)("q-menu"),v=(0,l.up)("q-btn"),y=(0,l.up)("q-tr"),g=(0,l.up)("q-table"),w=(0,l.up)("modal"),C=(0,l.up)("q-dialog"),_=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(g,{rows:s.data,columns:n.columns,"row-key":"id",loading:n.loading,flat:"",class:"bg-secondary q-pt-md"},{body:(0,l.w5)((t=>[(0,l.Wm)(y,{class:(0,d.C_)(t.rowIndex%2!==0&&"bg-white"),props:t},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{key:"quoteNumber",props:t},{default:(0,l.w5)((()=>[(0,l.Wm)(a,{style:{color:"black"},to:`/finance/quote/${t.row.id}`},{default:(0,l.w5)((()=>[(0,l._)("p",c,(0,d.zw)(t.row.quoteNumber),1)])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,l.Wm)(u,{key:"client",props:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(t.row.client.name),1)])),_:2},1032,["props"]),(0,l.Wm)(u,{key:"date",props:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(s.dateConversion(t.row.date)),1)])),_:2},1032,["props"]),(0,l.Wm)(u,{key:"dueDate",props:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(s.dateConversion(t.row.dueDate)),1)])),_:2},1032,["props"]),(0,l.Wm)(u,{key:"status",props:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(t.row.status),1)])),_:2},1032,["props"]),(0,l.Wm)(u,{key:"actions",props:t},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{style:{"z-index":"10"},dense:"",round:"",flat:"",icon:"more_vert"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{"transition-show":"scale","transition-hide":"scale"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{style:{"min-width":"75px"}},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(p,{onClick:i=>e.deleteQuote(t.row.id),style:{},clickable:""},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{class:"flex flex-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"delete",color:"negative",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[_]]),(0,l.Wm)(h),"Paid"!==t.row.status?(0,l.wy)(((0,l.wg)(),(0,l.j4)(p,{key:0,onClick:e=>s.edit(t.row),clickable:""},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{class:"flex flex-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"edit",color:"warning",size:"xs"})])),_:1})])),_:2},1032,["onClick"])),[[_]]):(0,l.kq)("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["class","props"])])),_:1},8,["rows","columns","loading"]),(0,l.Wm)(C,{seamless:"",position:"right",modelValue:n.prompt,"onUpdate:modelValue":t[1]||(t[1]=e=>n.prompt=e),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{onCloseDialogue:t[0]||(t[0]=e=>n.prompt=!1),action:n.action,body:n.body},null,8,["action","body"])])),_:1},8,["modelValue"])])}var r=i(3617),m=i(1082),p=(i(246),i(8880));const h={class:"row"},b={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 column q-pa-sm"},f={class:"q-pt-xs"},v={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 column q-pa-sm"},y={class:"q-pt-xs"},g={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},w=(0,l._)("div",{class:"q-ma-none absolute q-ml-sm text-grey-7",style:{"z-index":"10","font-size":"12px","line-height":"20px","font-weight":"400"}},"Quote date",-1),C={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},_=(0,l._)("div",{class:"q-ma-none absolute q-ml-sm text-grey-7",style:{"z-index":"10","font-size":"12px","line-height":"20px","font-weight":"400"}},"Due date",-1),q={class:"q-pa-sm"},V=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{class:"text-left"},"#"),(0,l._)("th",{class:"text-left"},"Item"),(0,l._)("th",{class:"text-left"},"Description"),(0,l._)("th",{class:"text-left"},"Unit price"),(0,l._)("th",{class:"text-left"},"Quantity"),(0,l._)("th",{class:"text-left"},"Amount"),(0,l._)("th")])],-1),x={style:{"min-width":"20rem !important"}},I={style:{width:"7rem !important"}},W={style:{width:"5rem !important"}},k={style:{width:"7rem !important"}},Q={style:{width:"2rem !important"}},D=(0,l._)("div",{class:"row q-gutter-md"},null,-1),R={class:"q-pa-sm"},T={class:"row bg-white q-pa-lg",style:{"border-radius":"4px"}},A=(0,l._)("div",{class:"col-9"},null,-1),U={class:"col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pb-md column q-gutter-sm"},Z={class:"q-pa-sm"};function N(e,t,i,o,n,s){const a=(0,l.up)("q-toolbar-title"),c=(0,l.up)("q-btn"),u=(0,l.up)("q-toolbar"),r=(0,l.up)("q-item-label"),m=(0,l.up)("q-item-section"),N=(0,l.up)("q-item"),E=(0,l.up)("q-select"),z=(0,l.up)("q-input"),S=(0,l.up)("Datepicker"),P=(0,l.up)("q-badge"),M=(0,l.up)("q-markup-table"),Y=(0,l.up)("q-editor"),j=(0,l.up)("q-card-section"),$=(0,l.up)("q-card"),L=(0,l.up)("modal"),H=(0,l.up)("q-dialog"),O=(0,l.up)("modalc"),F=(0,l.up)("q-layout"),B=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(F,{style:{width:"80vw !important"}},{default:(0,l.w5)((()=>[(0,l.Wm)($,{class:"bg-secondary",style:{"max-width":"80vw"},flat:"",square:""},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{class:"bg-grey-3",style:{position:"sticky !important",top:"0","z-index":"15"}},{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(i.action+" ")+" Quote ",1)])),_:1}),(0,l.wy)((0,l.Wm)(c,{icon:"close",flat:"",round:"",dense:""},null,512),[[B]])])),_:1}),(0,l.Wm)(j,{class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l._)("div",h,[(0,l._)("div",b,[(0,l.Wm)(E,{ref:"clientRef",rules:[e=>null!==e||"This field is required"],"bg-color":"white",outlined:"",modelValue:n.client,"onUpdate:modelValue":t[0]||(t[0]=e=>n.client=e),options:n.options,label:"Choose client",class:"select",loading:n.isLoaded,"use-input":"","input-debounce":"10",onFilter:s.filterClients},{option:(0,l.w5)((e=>[(0,l.Wm)(N,(0,l.dG)({onClick:t=>s.retrievClientContacts(e.opt.id,!1)},e.itemProps),{default:(0,l.w5)((()=>[(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040,["onClick"])])),_:1},8,["rules","modelValue","options","loading","onFilter"]),(0,l._)("div",null,[(0,l._)("div",f,[(0,l.Wm)(c,{size:"sm","no-caps":"",flat:"",color:"primary",label:"Add Client",onClick:t[1]||(t[1]=e=>n.prompt=!0)})])])]),(0,l._)("div",v,[(0,l.Wm)(E,{ref:"clientCRef",class:"select",rules:[e=>null!==e||"This field is required"],"bg-color":"white",disable:0===n.options0.length,outlined:"",modelValue:n.clientContacts,"onUpdate:modelValue":t[2]||(t[2]=e=>n.clientContacts=e),options:n.options0,label:"Client Contact"},{option:(0,l.w5)((e=>[(0,l.Wm)(N,(0,l.dG)({onClick:t=>s.clientEmail(e.opt.id)},e.itemProps),{default:(0,l.w5)((()=>[(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040,["onClick"])])),_:1},8,["rules","disable","modelValue","options"]),(0,l._)("div",null,[(0,l._)("div",y,[(0,l.Wm)(c,{disable:!n.client,ripple:!1,size:"sm","no-caps":"",flat:"",color:"primary",label:"Add Contact Person",onClick:t[3]||(t[3]=e=>n.dialogue=!0)},null,8,["disable"])])])]),(0,l.Wm)(z,{ref:"cEmailRef","bg-color":"white",class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm",outlined:"",modelValue:n.clientEMAIL,"onUpdate:modelValue":t[4]||(t[4]=e=>n.clientEMAIL=e),label:"Contact E-mail"},null,8,["modelValue"]),(0,l.Wm)(z,{ref:"billingRef","bg-color":"white",class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm",outlined:"",modelValue:n.invoice.billingAddress,"onUpdate:modelValue":t[5]||(t[5]=e=>n.invoice.billingAddress=e),label:"Billing address"},null,8,["modelValue"]),(0,l.Wm)(z,{modelValue:n.tax,"onUpdate:modelValue":t[6]||(t[6]=e=>n.tax=e),"bg-color":"white",class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm",outlined:"",label:"Tax"},null,8,["modelValue"]),(0,l.Wm)(z,{ref:"paymentRef",rules:[e=>e&&e.length>0||"This field is required"],"bg-color":"white",class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm",modelValue:n.invoice.paymentMethod,"onUpdate:modelValue":t[7]||(t[7]=e=>n.invoice.paymentMethod=e),outlined:"",label:"Payment method"},null,8,["rules","modelValue"]),(0,l._)("div",g,[w,(0,l.Wm)(S,{modelValue:n.invoice.date,"onUpdate:modelValue":t[8]||(t[8]=e=>n.invoice.date=e),showNowButton:""},null,8,["modelValue"])]),(0,l._)("div",C,[_,(0,l.Wm)(S,{modelValue:n.invoice.dueDate,"onUpdate:modelValue":t[9]||(t[9]=e=>n.invoice.dueDate=e),showNowButton:""},null,8,["modelValue"])]),(0,l.Wm)(E,{ref:"statusRef",rules:[e=>e&&e.length>0||"This field is required"],"bg-color":"white",class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm",outlined:"",modelValue:n.invoice.status,"onUpdate:modelValue":t[10]||(t[10]=e=>n.invoice.status=e),options:["Sent","Accepted","Rejected"],label:"Status"},null,8,["rules","modelValue"]),(0,l.Wm)(z,{ref:"currencyRef",rules:[e=>e&&e.length>0||"This field is required"],"bg-color":"white",class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm",outlined:"",modelValue:n.invoice.currencyCode,"onUpdate:modelValue":t[11]||(t[11]=e=>n.invoice.currencyCode=e),label:"Currency code"},null,8,["rules","modelValue"]),(0,l.Wm)(z,{"bg-color":"white",class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm",mask:"#","fill-mask":"0","reverse-fill-mask":"","model-value":"Number",outlined:"",modelValue:n.invoice.exchangeRate,"onUpdate:modelValue":t[12]||(t[12]=e=>n.invoice.exchangeRate=e),label:"Exchange rate"},null,8,["modelValue"])]),(0,l._)("div",null,[(0,l._)("div",q,[(0,l.Wm)(M,{flat:"",bordered:"",class:"q-mt-xl"},{default:(0,l.w5)((()=>[V,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.invoice.items,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:t},[(0,l._)("td",null,(0,d.zw)(t+1),1),(0,l._)("td",null,[(0,l.Wm)(E,{style:{"min-width":"10rem !important"},outlined:"",label:"item",modelValue:n.invoice.items[t].label,"onUpdate:modelValue":e=>n.invoice.items[t].label=e,options:n.options1,loading:n.isLoaded,"bg-color":"white","use-input":"","input-debounce":"10",onFilter:s.filterItems},{option:(0,l.w5)((e=>[(0,l.Wm)(N,(0,l.dG)({onKeypress:(0,p.D2)((i=>n.invoice.items[t].description=e.opt.description),["enter"]),onClick:i=>n.invoice.items[t].description=e.opt.description},e.itemProps),{default:(0,l.w5)((()=>[(0,l.Wm)(P,{class:"absolute-top-right q-ma-xs",style:{"font-size":"10px"}},{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)("serviceItem"===e.opt.category?"service":"item"),1)])),_:2},1024),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040,["onKeypress","onClick"])])),_:2},1032,["modelValue","onUpdate:modelValue","options","loading","onFilter"])]),(0,l._)("td",x,[(0,l.Wm)(z,{"bg-color":"white",outlined:"",modelValue:n.invoice.items[t].description,"onUpdate:modelValue":e=>n.invoice.items[t].description=e},null,8,["modelValue","onUpdate:modelValue"])]),(0,l._)("td",I,[(0,l.Wm)(z,{style:{width:"7rem !important"},mask:"#","fill-mask":"0","reverse-fill-mask":"","model-value":"Number","bg-color":"white",onInputCapture:e=>s.evaluate(t),outlined:"",modelValue:n.invoice.items[t].unitPrice,"onUpdate:modelValue":e=>n.invoice.items[t].unitPrice=e},null,8,["onInputCapture","modelValue","onUpdate:modelValue"])]),(0,l._)("td",W,[(0,l.Wm)(z,{style:{width:"5rem !important"},"bg-color":"white",mask:"#","fill-mask":"0","reverse-fill-mask":"","model-value":"Number",readonly:"inventoryItem"!==n.invoice.items[t].label.category,onInputCapture:e=>s.evaluate(t),outlined:"",modelValue:n.invoice.items[t].qty,"onUpdate:modelValue":e=>n.invoice.items[t].qty=e},null,8,["readonly","onInputCapture","modelValue","onUpdate:modelValue"])]),(0,l._)("td",k,[(0,l.Wm)(z,{style:{width:"7rem !important"},"bg-color":"white",readonly:"",outlined:"",modelValue:n.invoice.items[t].amount,"onUpdate:modelValue":e=>n.invoice.items[t].amount=e,type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),(0,l._)("td",Q,[(0,l.Wm)(c,{"no-caps":"",icon:"add",flat:"",color:"primary",onClick:s.updateOptions},null,8,["onClick"]),0!==t?((0,l.wg)(),(0,l.j4)(c,{key:0,flat:"",icon:"delete",size:"md",color:"negative",onClick:e=>{n.invoice.items.splice(t,1),s.findTotal()}},null,8,["onClick"])):(0,l.kq)("",!0)])])))),128))])])),_:1})])]),D,(0,l._)("div",R,[(0,l._)("div",T,[A,(0,l._)("div",U,[(0,l.Wm)(z,{mask:"#","fill-mask":"0","reverse-fill-mask":"","model-value":"Number",readonly:"",onInputCapture:s.updateValues,modelValue:n.subtotal,"onUpdate:modelValue":t[13]||(t[13]=e=>n.subtotal=e),label:"Subtotal"},null,8,["onInputCapture","modelValue"]),(0,l.Wm)(z,{mask:"#","fill-mask":"0","reverse-fill-mask":"","model-value":"Number",onInputCapture:s.updateValues,modelValue:n.invoice.taxRate,"onUpdate:modelValue":t[14]||(t[14]=e=>n.invoice.taxRate=e),label:"Tax Rate%"},null,8,["onInputCapture","modelValue"]),(0,l.Wm)(z,{mask:"#","fill-mask":"0","reverse-fill-mask":"","model-value":"Number",onInputCapture:s.updateValues,modelValue:n.invoice.discount,"onUpdate:modelValue":t[15]||(t[15]=e=>n.invoice.discount=e),label:"Discount%"},null,8,["onInputCapture","modelValue"]),(0,l.Wm)(z,{readonly:"",modelValue:n.total,"onUpdate:modelValue":t[16]||(t[16]=e=>n.total=e),label:"Grand total",type:"number"},null,8,["modelValue"])])])]),(0,l._)("div",Z,[(0,l.Wm)(Y,{modelValue:n.invoice.description,"onUpdate:modelValue":t[17]||(t[17]=e=>n.invoice.description=e),dense:e.$q.screen.lt.md,toolbar:[[{label:e.$q.lang.editor.align,icon:e.$q.iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]}],["bold","italic","strike","underline","subscript","superscript"],["token","hr","link","custom_btn"],["print","fullscreen"],[{label:e.$q.lang.editor.formatting,icon:e.$q.iconSet.editor.formatting,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{label:e.$q.lang.editor.fontSize,icon:e.$q.iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:e.$q.lang.editor.defaultFont,icon:e.$q.iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","dense","toolbar"])])])),_:1})])),_:1}),(0,l.Wm)(u,{style:{position:"sticky !important",bottom:"0","z-index":"5"},class:"bg-grey-3"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(c,{loading:n.loading,onClick:s.submit,label:"Submit","no-caps":"",type:"reset",color:"primary",unelevated:"",class:"full-width"},null,8,["loading","onClick"]),[[B,n.close]])])),_:1}),(0,l.Wm)(H,{seamless:"",position:"right",modelValue:n.prompt,"onUpdate:modelValue":t[19]||(t[19]=e=>n.prompt=e),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(L,{onCloseDialogue:t[18]||(t[18]=e=>n.prompt=!1),onUpdateForInvoice:s.updateClients,actionType:"Add",type:"client"},null,8,["onUpdateForInvoice"])])),_:1},8,["modelValue"]),(0,l.Wm)(H,{seamless:"",position:"right",modelValue:n.dialogue,"onUpdate:modelValue":t[21]||(t[21]=e=>n.dialogue=e),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{onCloseDialogue:t[20]||(t[20]=e=>n.dialogue=!1),onUpdateForInvoice:s.updateContacts,actionType:"Add",clId:Number(n.client.id)},null,8,["onUpdateForInvoice","clId"])])),_:1},8,["modelValue"])])),_:1})}var E=i(7474),z=i(6052),S=i(4789);const P={props:["action","body","invoiceType"],data(){return{close:!1,isLoaded:!1,loading:!1,prompt:!1,dialogue:!1,id:null,subtotal:0,total:0,tax:"",options:[],clientContacts:null,clientOptions:[],itemOptions:[],clientContactsOptions:[],options0:[],options1:[],clientEMAIL:"",client:null,otherInfo:"Description",invoice:{clientId:null,date:"",exchangeRate:null,taxRate:null,discount:null,billingAddress:"",clientContactId:null,currencyCode:"",status:"Sent",paymentMethod:"",dueDate:"",description:"",items:[]},invoiceToAddEdit:{clientId:null,date:"",exchangeRate:null,taxRate:null,discount:null,billingAddress:"",clientContactId:null,currencyCode:"",status:"Sent",paymentMethod:"",dueDate:"",description:"",items:[]}}},computed:{...(0,r.rn)("crmStore",["allClients"]),...(0,r.rn)("accountingStore",["joinedItems"])},components:{modal:E.Z,modalc:z.Z,Datepicker:S.Z},methods:{filterClients(e,t,i){t((()=>{const t=e.toLowerCase();this.options=this.clientOptions.filter((e=>{if(e.label.toLowerCase().indexOf(t)>-1)return e}))}))},filterItems(e,t,i){t((()=>{const t=e.toLowerCase();this.options1=this.itemOptions.filter((e=>{if(e.label.toLowerCase().indexOf(t)>-1)return e}))}))},async findTotal(){this.total=0;for(let e=0;e<this.invoice.items.length;e++)this.total+=this.invoice.items[e].amount;this.subtotal=this.total},async retrievClientContacts(e,t){this.options0=[],this.clientContacts=[],this.clientEMAIL="";for(let i=0;i<this.allClients.length;i++)if(Number(this.allClients[i].id)===Number(e))for(let e=0;e<this.allClients[i].clientContacts.length;e++)this.options0.push({label:this.allClients[i].clientContacts[e].name,id:Number(this.allClients[i].clientContacts[e].id)}),this.clientContactsOptions.push({label:this.allClients[i].clientContacts[e].name,id:Number(this.allClients[i].clientContacts[e].id)});t&&(this.clientContacts={label:this.options0[this.options0.length-1].label,id:this.options0[this.options0.length-1].id},await this.clientEmail(this.clientContacts.id))},clientEmail(e){setTimeout((()=>{for(let t=0;t<this.allClients.length;t++)if(Number(this.client.id)===Number(this.allClients[t].id))for(let i=0;i<this.allClients[t].clientContacts.length;i++)Number(this.allClients[t].clientContacts[i].id)===Number(e)&&(this.clientEMAIL=this.allClients[t].clientContacts[i].email)}),200)},async updateValues(){setTimeout((async()=>{await this.findTotal();let e=Number(this.invoice.discount)/100*this.total,t=Number(this.invoice.taxRate)/100*this.total;this.total=this.total+Number(t),this.total=this.total-Number(e)}),100)},async evaluate(e){await setTimeout((()=>{this.invoice.taxRate>100||this.invoice.discount}),100),setTimeout((()=>{this.invoice.items[e].amount=Number(this.invoice.items[e].unitPrice)*Number(this.invoice.items[e].qty),this.updateValues()}),100)},...(0,r.nv)("financeStore",["addQuote","editQuote"]),...(0,r.nv)("accountingStore",["getJoinedItems"]),...(0,r.nv)("crmStore",["getClients"]),async submit(){if(this.$refs.clientRef.validate(),this.$refs.clientCRef.validate(),this.$refs.cEmailRef.validate(),this.$refs.billingRef.validate(),this.$refs.paymentRef.validate(),this.$refs.statusRef.validate(),this.$refs.currencyRef.validate(),!(this.$refs.clientRef.hasError||this.$refs.clientCRef.hasError||this.$refs.cEmailRef.hasError||this.$refs.billingRef.hasError||this.$refs.paymentRef.hasError||this.$refs.statusRef.hasError||this.$refs.currencyRef.hasError))if(""!==this.invoice.items[0].label){this.close=!0,this.invoiceToAddEdit.discount=Number(this.invoice.discount)/100,this.invoiceToAddEdit.exchangeRate=Number(this.invoice.exchangeRate),this.invoiceToAddEdit.taxRate=Number(this.invoice.taxRate)/100,this.invoiceToAddEdit.clientId=Number(this.client.id),this.invoiceToAddEdit.currencyCode=this.invoice.currencyCode,this.invoiceToAddEdit.billingAddress=this.invoice.billingAddress,this.invoiceToAddEdit.status=this.invoice.status,this.invoiceToAddEdit.paymentMethod=this.invoice.paymentMethod,this.invoiceToAddEdit.description=this.invoice.description,this.invoiceToAddEdit.clientContactId=Number(this.clientContacts.id);for(let e=0;e<this.invoice.items.length;e++)this.invoiceToAddEdit.items[e]={itemId:this.invoice.items[e].label.itemId,name:this.invoice.items[e].label.label,qty:Number(this.invoice.items[e].qty),unitPrice:Number(this.invoice.items[e].unitPrice),category:this.invoice.items[e].label.category,description:this.invoice.items[e].description};this.invoiceToAddEdit.taxRate=Number(this.invoice.taxRate),this.invoiceToAddEdit.date=m.ZP.formatDate(new Date(this.invoice.date),"YYYY-MM-DD HH:mm"),this.invoiceToAddEdit.dueDate=m.ZP.formatDate(new Date(this.invoice.dueDate),"YYYY-MM-DD HH:mm"),"Edit"===this.action?await this.editQuote({...this.invoiceToAddEdit,id:this.body.id}):await this.addQuote(this.invoiceToAddEdit)}else alert("Please choose at least one item !")},async delInvoice(e){this.deleteInvoice(e)},updateOptions(){this.options1.length=0;for(let e=0;e<this.joinedItems.length;e++)this.options1.push({label:this.joinedItems[e].name,itemId:this.joinedItems[e].id,category:this.joinedItems[e].category,description:this.joinedItems[e].description,qty:0,unitPrice:0,amount:0}),this.itemOptions.push({label:this.joinedItems[e].name,itemId:this.joinedItems[e].id,category:this.joinedItems[e].category,description:this.joinedItems[e].description,qty:0,unitPrice:0,amount:0});this.invoice.items.push({label:"",itemId:null,category:"",qty:1,unitPrice:0,amount:0,description:""})},updateClients(){this.options=[];for(let e=0;e<this.allClients.length;e++)this.options.push({label:this.allClients[e].name,id:this.allClients[e].id}),this.clientOptions.push({label:this.allClients[e].name,id:this.allClients[e].id})},async updateContacts(){await this.getClients(),await this.retrievClientContacts(Number(this.client.id),!0)},dateConversion(e){let t=new Date(e);return t.setHours(t.getHours()-3),m.ZP.formatDate(t,"YYYY-MM-DD HH:mm")}},async mounted(){if("Add"===this.action&&(this.invoice.status=this.invoiceType),this.isLoaded=!0,await this.getJoinedItems(),await this.getClients(),this.updateOptions(),this.updateClients(),"Edit"===this.action){this.invoice.clientId=this.body.clientId,this.invoice.date=this.dateConversion(this.body.date),this.invoice.dueDate=this.dateConversion(this.body.dueDate),this.invoice.billingAddress=this.body.billingAddress,this.invoice.paymentMethod=this.body.paymentMethod,this.invoice.description=this.body.description,this.invoice.currencyCode=this.body.currencyCode,this.invoice.status=this.body.status,this.invoice.taxRate=Number(this.body.taxRate),this.invoice.exchangeRate=Number(this.body.exchangeRate),this.invoice.discount=Number(this.body.discount),this.client={label:this.body.client.name,id:this.body.client.id},await this.updateValues(),await this.retrievClientContacts(Number(this.body.clientId),!1),this.body.clientContact&&(this.clientContacts={label:this.body.clientContact.name,id:this.body.clientContact.id},this.clientEMAIL=this.body.clientContact.email);for(let e=0;e<this.body.invoiceItems.length;e++)e+1!==this.body.invoiceItems.length&&this.invoice.items.push({itemId:null,qty:null,category:"",label:{label:"",itemId:null,category:"",description:""},unitPrice:null,amount:0}),this.invoice.items[e].label={label:"",itemId:null,category:"",description:""},this.invoice.items[e].label.itemId=this.body.invoiceItems[e].itemId,this.invoice.items[e].qty=Number(this.body.invoiceItems[e].qty),this.invoice.items[e].label.category=this.body.invoiceItems[e].category,this.invoice.items[e].label.label=this.body.invoiceItems[e].name,this.invoice.items[e].unitPrice=Number(this.body.invoiceItems[e].unitPrice),this.invoice.items[e].amount=this.invoice.items[e].qty*this.invoice.items[e].unitPrice,this.invoice.items[e].description=this.body.invoiceItems[e].description}else this.invoice.date=m.ZP.formatDate(new Date,"YYYY-MM-DD HH:mm"),this.invoice.dueDate=m.ZP.formatDate(new Date,"YYYY-MM-DD HH:mm");this.isLoaded=!1}};var M=i(9214),Y=i(151),j=i(9570),$=i(3747),L=i(2165),H=i(5589),O=i(3314),F=i(3414),B=i(2035),G=i(2350),K=i(4689),J=i(481),X=i(9721),ee=i(9989),te=i(6778),ie=i(677),le=i(7518),oe=i.n(le);P.render=N;const ne=P;oe()(P,"components",{QLayout:M.Z,QCard:Y.Z,QToolbar:j.Z,QToolbarTitle:$.Z,QBtn:L.Z,QCardSection:H.Z,QSelect:O.Z,QItem:F.Z,QItemSection:B.Z,QItemLabel:G.Z,QInput:K.Z,QMarkupTable:J.Z,QBadge:X.Z,QEditor:ee.Z,QDialog:te.Z}),oe()(P,"directives",{ClosePopup:ie.Z});const se={props:["type"],data(){return{prompt:!1,loading:!1,action:"",body:{},columns:[{name:"quoteNumber",align:"left",label:"Quote number",field:"quoteNumber"},{name:"client",align:"left",label:"Client",field:"client"},{name:"date",align:"left",label:"Quote date",field:"date"},{name:"dueDate",align:"left",label:"Due date",field:"dueDate"},{name:"status",align:"left",label:"Status",field:"status"},{name:"actions",align:"left",label:"Actions",field:"actions"}]}},computed:{...(0,r.rn)("financeStore",["sentQuotes","acceptedQuotes","rejectedQuotes"]),data(){return"Sent"===this.type?this.sentQuotes:"Accepted"===this.type?this.acceptedQuotes:this.rejectedQuotes}},components:{modal:ne},methods:{...(0,r.nv)("financeStore",["getQuotes","deleteQuote"]),rowColor(e){if(e.rowIndex%2!==0)return"background: #fff;"},dateConversion(e){let t=new Date(e);return t.setHours(t.getHours()-3),m.ZP.formatDate(t,"YYYY-MM-DD HH:mm")},edit(e){this.body=e,this.action="Edit",this.prompt=!0}},async mounted(){await this.getQuotes()}};var ae=i(1277),de=i(8186),ce=i(3884),ue=i(811),re=i(7011),me=i(4554),pe=i(5869);se.render=u;const he=se;oe()(se,"components",{QTable:ae.Z,QTr:de.Z,QTd:ce.Z,QBtn:L.Z,QMenu:ue.Z,QList:re.Z,QItem:F.Z,QItemSection:B.Z,QIcon:me.Z,QSeparator:pe.Z,QDialog:te.Z}),oe()(se,"directives",{ClosePopup:ie.Z});const be={components:{breadcrumps:a.Z,tbl:he,modal:ne},data(){return{tab:"Sent",prompt:!1}},setup(){return{crumps:[{id:1,name:"OneConnect",icon:"home",path:"/"},{id:2,name:"Quotation",icon:"request_quote",path:"/finance/quotation"}]}}};var fe=i(4379),ve=i(7547),ye=i(3269),ge=i(5906),we=i(6602);be.render=s;const Ce=be;oe()(be,"components",{QPage:fe.Z,QBtn:L.Z,QTabs:ve.Z,QTab:ye.Z,QTabPanels:ge.Z,QTabPanel:we.Z,QDialog:te.Z})}}]);