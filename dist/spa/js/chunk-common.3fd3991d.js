(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[64],{1887:(e,t,a)=>{"use strict";a.d(t,{Z:()=>h});var i=a(3673);const l=(0,i._)("div",{class:"text-h6"},"Are you sure?",-1);function s(e,t){const a=(0,i.up)("q-card-section"),s=(0,i.up)("q-btn"),o=(0,i.up)("q-card-actions"),n=(0,i.up)("q-card"),r=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(n,{style:{width:"300px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(a,null,{default:(0,i.w5)((()=>[l])),_:1}),(0,i.Wm)(o,{align:"right"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(s,{flat:"",label:"Cancel",color:"negative"},null,512),[[r]]),(0,i.wy)((0,i.Wm)(s,{flat:"",label:"Delete",onClick:t[0]||(t[0]=t=>e.$emit("confirm")),color:"primary"},null,512),[[r]])])),_:1})])),_:1})}var o=a(151),n=a(5589),r=a(9367),d=a(2165),c=a(677),u=a(7518),p=a.n(u);const m={};m.render=s;const h=m;p()(m,"components",{QCard:o.Z,QCardSection:n.Z,QCardActions:r.Z,QBtn:d.Z}),p()(m,"directives",{ClosePopup:c.Z})},6303:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var i=a(3673);function l(e,t,a,l,s,o){const n=(0,i.up)("q-breadcrumbs-el"),r=(0,i.up)("q-breadcrumbs");return(0,i.wg)(),(0,i.j4)(r,{separator:"- - -"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.map,((e,t)=>((0,i.wg)(),(0,i.j4)(n,{to:e.path,exact:"",key:e.id,label:e.name,icon:e.icon},null,8,["to","label","icon"])))),128))])),_:1})}const s={props:["map"]};var o=a(1481),n=a(5926),r=a(7518),d=a.n(r);s.render=l;const c=s;d()(s,"components",{QBreadcrumbs:o.Z,QBreadcrumbsEl:n.Z})},3438:(e,t,a)=>{"use strict";a.d(t,{Z:()=>ie});var i=a(3673),l=a(2323),s=a(8880);const o={key:0,class:"flex"},n={key:1,class:"flex"},r={key:0,class:"flex items-center"},d=["src"],c={class:"q-ma-none q-pb-none text-subtitle1 q-ml-sm text-black"},u={key:2,class:"flex"},p={class:"flex"},m=["src"],h={key:3,class:"flex"},g={class:"flex items-center"},y=["src"],b={class:"q-ma-none text-subtitle1 q-ml-sm text-black"},f={key:4,class:"flex"},w={class:"flex items-center"},v=["src"],q={class:"flex"},_={key:0,class:"text-black text-subtitle1 q-mr-none q-mt-none q-mb-none q-ml-sm"},C={key:1,class:"q-ma-none text-black text-subtitle1"},k={key:0,class:"q-ma-none text-black text-subtitle1"},x={key:5,class:"flex"},V={class:"flex items-center"},W={class:"q-ma-none q-pa-none text-subtitle1 q-ml-sm text-grey"},z={class:"q-pr-xl q-pl-xl"},D=["onClick"],S={key:0},T=["src"],Z=["src"],j=["src"];function Q(e,t,a,Q,$,I){const N=(0,i.up)("q-btn"),U=(0,i.up)("q-avatar"),R=(0,i.up)("q-toolbar-title"),P=(0,i.up)("q-toolbar"),E=(0,i.up)("q-icon"),O=(0,i.up)("q-chat-message"),A=(0,i.up)("q-spinner-dots"),Y=(0,i.up)("q-file"),F=(0,i.up)("q-banner"),H=(0,i.up)("q-popup-proxy"),M=(0,i.up)("q-input"),L=(0,i.up)("q-page"),B=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(L,{style:(0,l.j5)(a.hght?a.hght:"height:600px !important;")},{default:(0,i.w5)((()=>[(0,i.Wm)(P,{class:"text-primary bg-white absolute-top",style:{height:"54px !important","z-index":"5"}},{default:(0,i.w5)((()=>[(0,i.Wm)(R,null,{default:(0,i.w5)((()=>[e.chat?((0,i.wg)(),(0,i.iD)("div",o,[a.popup?((0,i.wg)(),(0,i.j4)(N,{key:0,onClick:t[0]||(t[0]=t=>e.$emit("hideChat")),icon:"chevron_left",ripple:!1,color:"primary",flat:"",round:""})):(0,i.kq)("",!0),"chat"===e.chat.room_type?((0,i.wg)(),(0,i.iD)("div",n,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.chat.users,((t,a)=>((0,i.wg)(),(0,i.iD)("div",{key:t.id},[t.id!==e.user.id?((0,i.wg)(),(0,i.iD)("div",r,[(0,i.wy)((0,i.Wm)(U,{class:(0,l.C_)(1===a&&"q-ml-xs"),size:"35px"},{default:(0,i.w5)((()=>[(0,i._)("img",{src:t.avatar?t.avatar:"https://cdn-icons-png.flaticon.com/512/149/149071.png"},null,8,d)])),_:2},1032,["class"]),[[s.F8,a<2]]),(0,i._)("p",c,(0,l.zw)(t.name),1)])):(0,i.kq)("",!0)])))),128))])):"channel"!==e.chat.room_type||e.chat.avatar||e.chat.name?"channel"===e.chat.room_type&&e.chat.avatar&&e.chat.name?((0,i.wg)(),(0,i.iD)("div",h,[(0,i._)("div",g,[(0,i.Wm)(U,{size:"35px"},{default:(0,i.w5)((()=>[(0,i._)("img",{src:e.chat.avatar},null,8,y)])),_:1}),(0,i._)("p",b,(0,l.zw)(e.chat.name),1)])])):"channel"===e.chat.room_type&&e.chat.avatar&&!e.chat.name?((0,i.wg)(),(0,i.iD)("div",f,[(0,i._)("div",w,[(0,i.Wm)(U,{size:"35px"},{default:(0,i.w5)((()=>[(0,i._)("img",{src:e.chat.avatar},null,8,v)])),_:1}),(0,i._)("div",q,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.chat.users,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"flex",key:e.id},[t<2?((0,i.wg)(),(0,i.iD)("p",_,(0,l.zw)(e.name),1)):(0,i.kq)("",!0),t<1?((0,i.wg)(),(0,i.iD)("p",C,",")):(0,i.kq)("",!0)])))),128)),e.chat.users.length>2?((0,i.wg)(),(0,i.iD)("p",k,"...")):(0,i.kq)("",!0)])])])):"channel"===e.chat.room_type&&e.chat.name&&!e.chat.avatar?((0,i.wg)(),(0,i.iD)("div",x,[(0,i._)("div",V,[(0,i._)("p",W,(0,l.zw)(e.chat.name),1)])])):(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",u,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.chat.users,((t,a)=>((0,i.wg)(),(0,i.iD)("div",{key:t.id},[(0,i._)("div",p,[(0,i.wy)((0,i.Wm)(U,{class:(0,l.C_)(1===a&&"q-ml-xs"),size:"35px"},{default:(0,i.w5)((()=>[(0,i._)("img",{src:t.avatar?t.avatar:"https://cdn-icons-png.flaticon.com/512/149/149071.png"},null,8,m)])),_:2},1032,["class"]),[[s.F8,a<2]]),(0,i.wy)((0,i.Wm)(U,{class:"q-ml-xs bg-grey-3 text-grey",size:"35px"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)("+"+(e.chat.users.length-2)),1)])),_:2},1536),[[s.F8,2===a&&e.chat.users.length>2]])])])))),128))]))])):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(N,{flat:"",round:"",dense:"",icon:"videocam"}),(0,i.Wm)(N,{flat:"",round:"",dense:"",icon:"call"})])),_:1}),(0,i._)("div",null,[e.chat?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,l.C_)(a.popup&&"bg-blue-1"),id:"room-container",style:(0,l.j5)([a.hght?a.hght:"height:100vh;",{width:"100% !important","overflow-y":"scroll !important","padding-top":"54px !important",position:"relative !important"}])},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.chat.messages,((t,s)=>((0,i.wg)(),(0,i.iD)("div",{key:t.id},[(0,i._)("div",z,[(0,i.Wm)(O,{name:t.user.name,avatar:e.user.id===t.user_id?e.user.avatar:t.user.avatar,size:"35",class:(0,l.C_)([s!==e.chat.messages.length-1&&"q-pb-md","text-grey"]),"bg-color":e.user.id!==t.user_id?"primary":"grey-4","text-color":e.user.id===t.user_id?"black":"white",sent:e.user.id===t.user_id,style:{"max-width":"100% !important","text-overflow":"break !important"},stamp:I.format(t.created_at)},{default:(0,i.w5)((()=>[(0,i._)("div",{onClick:e=>t.attachments[0]&&I.download(t.attachments[0]),class:(0,l.C_)([t.attachments[0]&&"text-grey","flex flex-center column"])},[(0,i.Uk)((0,l.zw)(0===t.attachments.length?t.text:"")+" ",1),t.attachments[0]?((0,i.wg)(),(0,i.iD)("div",S,[t.attachments[0].content_type.includes("image")?((0,i.wg)(),(0,i.iD)("img",{key:0,class:"q-mt-sm",height:"150",width:"150",src:t.attachments[0].url},null,8,T)):((0,i.wg)(),(0,i.j4)(U,{key:1,square:"",size:"100px"},{default:(0,i.w5)((()=>[(0,i.Wm)(E,{color:"grey",name:"attach_file"})])),_:1}))])):(0,i.kq)("",!0)],10,D)])),_:2},1032,["name","avatar","class","bg-color","text-color","sent","stamp"]),s===e.chat.messages.length-1?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,l.C_)(!a.popup&&"q-mb-xl"),style:(0,l.j5)(s!==e.chat.messages.length-1||a.popup?"padding-bottom:20px;":"padding-bottom:60px;")},[(0,i._)("div",{class:(0,l.C_)(["q-ma-none flex",e.user.id!==t.user_id?"q-ml-xl":"q-mr-xl justify-end"])},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.messageRecipients,(a=>((0,i.wg)(),(0,i.iD)("div",{key:a.user.id},["seen"===a.status&&a.user_id!==e.user.id&&t.user.id!==a.user_id?((0,i.wg)(),(0,i.j4)(U,{key:0,class:"q-ml-xs",size:"15px"},{default:(0,i.w5)((()=>[(0,i._)("img",{src:a.user.avatar?a.user.avatar:"https://cdn-icons-png.flaticon.com/512/149/149071.png"},null,8,Z)])),_:2},1024)):(0,i.kq)("",!0)])))),128))],2),s===e.chat.messages.length-1&&$.isTyping&&$.room_id===this.chat.id?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,l.C_)(!a.popup&&"q-pb-xl")},[(0,i.Wm)(U,{size:"22px"},{default:(0,i.w5)((()=>[(0,i._)("img",{src:$.avatar?$.avatar:"https://cdn-icons-png.flaticon.com/512/149/149071.png"},null,8,j)])),_:1}),(0,i.Wm)(A,{class:"q-ml-sm",size:"xs"})],2)):(0,i.kq)("",!0)],6)):(0,i.kq)("",!0)])])))),128))],6)):(0,i.kq)("",!0)]),(0,i._)("div",{class:(0,l.C_)(!a.popup&&"absolute-bottom")},[(0,i.Wm)(M,{onInputCapture:I.typing,onKeydown:(0,s.D2)(I.send,["enter"]),outlined:"",square:"","bg-color":"white",modelValue:$.message,"onUpdate:modelValue":t[2]||(t[2]=e=>$.message=e),label:"Message"},{append:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(N,{color:"primary",onClick:I.send,round:"",dense:"",flat:"",icon:"send"},null,8,["onClick"]),[[s.F8,""!==$.message]])])),prepend:(0,i.w5)((()=>[(0,i.Wm)(N,{color:"primary",round:"",dense:"",flat:"",icon:"attachment"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,null,{default:(0,i.w5)((()=>[(0,i.Wm)(Y,{clearable:"",label:"File",outlined:"",modelValue:$.file,"onUpdate:modelValue":t[1]||(t[1]=e=>$.file=e)},{prepend:(0,i.w5)((()=>[(0,i.Wm)(E,{name:"attach_file"})])),_:1},8,["modelValue"]),(0,i.wy)((0,i.Wm)(N,{label:"Send",onClick:I.addMsgFile,"no-caps":"",disable:!$.file,flat:"",color:"primary",class:"q-mt-sm",size:"md"},null,8,["onClick","disable"]),[[B]])])),_:1})])),_:1})])),_:1})])),_:1},8,["onInputCapture","onKeydown","modelValue"])],2)])),_:1},8,["style"])}var $=a(6303),I=a(1082),N=a(3617),U=a(52),R=a.n(U);const P={props:["hght","popup","sckt"],data(){return{init:1,message:"",file:null,isTyping:!1,avatar:null,room_id:null,socket:this.sckt}},components:{breadcrmps:$.Z},computed:{...(0,N.rn)("chatStore",["chat"]),...(0,N.rn)("example",["user"])},methods:{...(0,N.nv)("example",["getUser"]),...(0,N.nv)("chatStore",["getChat","getMessage"]),format(e){return I.ZP.formatDate(e,"HH:mm")},async typing(){this.socket.send(JSON.stringify({typing:{room_id:Number(this.chat.id)}}))},download(e){window.open(e.url)},async addMsgFile(){let e=new FormData;e.append("files",this.file);let t=await R().post("https://onconnect-backend-api.herokuapp.com/api/v1/chats/addFiles/",e,{headers:{Authorization:localStorage.getItem("accessToken")}});t.data.success&&this.socket.send(JSON.stringify({createMessage:{room_id:Number(this.chat.id),text:this.file.name,files:[t.data.data[0].id]}}))},setScrollPos(){},updateScroll(){var e=document.getElementById("room-container");e&&(e.scrollTop=e.scrollHeight)},send(){if(""===this.message)return;let e=this;this.socket.send(JSON.stringify({createMessage:{room_id:Number(this.chat.id),text:this.message}})),e.message="",setTimeout((()=>{e.updateScroll()}),100)},receive(){setTimeout((()=>{self.updateScroll()}),100)}},async mounted(){await this.getUser()},async mounted(){let e=this;this.socket.addEventListener("open",(async function(e){this.socket.send(JSON.stringify({accessToken:localStorage.getItem("accessToken").substring(7,localStorage.getItem("accessToken").length)}))})),this.socket.addEventListener("message",(async function(t){1===e.init?e.init=2:JSON.parse(t.data).messagePerRoom?JSON.parse(t.data).messagePerRoom.messfinal.room_id===Number(e.chat.id)&&(await e.getMessage(JSON.parse(t.data).messagePerRoom.messfinal),e.updateScroll()):JSON.parse(t.data).userTyping&&(e.room_id=JSON.parse(t.data).userTyping.room_id,e.isTyping=JSON.parse(t.data).userTyping,e.avatar=JSON.parse(t.data).userTyping.avatar,setTimeout((()=>{e.isTyping=!1,e.avatar=null}),2e3)),JSON.parse(t.data).onlineUsers||e.updateScroll()}))},setup(){return{crumps:[{id:1,name:"OneConnect",icon:"home",path:"/"},{id:2,name:"Chat",icon:"chat",path:"/chat"}]}}};var E=a(4379),O=a(9570),A=a(3747),Y=a(2165),F=a(5096),H=a(7704),M=a(629),L=a(4554),B=a(4765),J=a(4689),K=a(3944),G=a(5607),X=a(4974),ee=a(677),te=a(7518),ae=a.n(te);P.render=Q;const ie=P;ae()(P,"components",{QPage:E.Z,QToolbar:O.Z,QToolbarTitle:A.Z,QBtn:Y.Z,QAvatar:F.Z,QScrollArea:H.Z,QChatMessage:M.Z,QIcon:L.Z,QSpinnerDots:B.Z,QInput:J.Z,QPopupProxy:K.Z,QBanner:G.Z,QFile:X.Z}),ae()(P,"directives",{ClosePopup:ee.Z})},7474:(e,t,a)=>{"use strict";a.d(t,{Z:()=>x});var i=a(3673),l=a(2323);const s={class:"flex items-center"},o=(0,i._)("p",{style:{padding:"0 !important","font-size":"1rem"}},"Rate: ",-1);function n(e,t,a,n,r,d){const c=(0,i.up)("q-toolbar-title"),u=(0,i.up)("q-btn"),p=(0,i.up)("q-toolbar"),m=(0,i.up)("q-input"),h=(0,i.up)("q-icon"),g=(0,i.up)("q-file"),y=(0,i.up)("q-btn-toggle"),b=(0,i.up)("vue-tel-input"),f=(0,i.up)("q-rating"),w=(0,i.up)("q-card-section"),v=(0,i.up)("q-card"),q=(0,i.up)("q-layout"),_=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(q,{style:{width:"500px !important"}},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{style:{"max-width":"500px","min-height":"100vh"},flat:"",square:""},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{class:"bg-grey-3",style:{position:"sticky !important",top:"0","z-index":"15 !important"}},{default:(0,i.w5)((()=>[(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(a.actionType)+" "+(0,l.zw)(a.type[0].toUpperCase()+a.type.substr(1,a.type.length)),1)])),_:1}),(0,i.wy)((0,i.Wm)(u,{icon:"close",flat:"",round:"",dense:""},null,512),[[_]])])),_:1}),(0,i.Wm)(w,{class:"q-gutter-sm scroll"},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{ref:"companyRef",outlined:"",modelValue:r.credentials.name,"onUpdate:modelValue":t[0]||(t[0]=e=>r.credentials.name=e),label:"Company","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type the company name"]},null,8,["modelValue","rules"]),(0,i.Wm)(g,{modelValue:r.credentials.logo,"onUpdate:modelValue":t[1]||(t[1]=e=>r.credentials.logo=e),clearable:"",outlined:"",label:"Client logo",filled:"",class:"q-pb-md"},{prepend:(0,i.w5)((()=>[(0,i.Wm)(h,{name:"attach_file",accept:".jpg, image/*"})])),_:1},8,["modelValue"]),(0,i.Wm)(y,{modelValue:r.credentials.businessType,"onUpdate:modelValue":t[2]||(t[2]=e=>r.credentials.businessType=e),class:"my-custom-toggle","no-caps":"",rounded:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Company",value:"Company"},{label:"Individual",value:"Individual"}]},null,8,["modelValue"]),"Edit"===a.actionType?((0,i.wg)(),(0,i.j4)(y,{key:0,modelValue:r.credentials.clientType,"onUpdate:modelValue":t[3]||(t[3]=e=>r.credentials.clientType=e),class:"my-custom-toggle","no-caps":"",rounded:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Client",value:"client"},{label:"Lead",value:"lead"},{label:"Blacklist",value:"blacklist"}]},null,8,["modelValue"])):(0,i.kq)("",!0),(0,i.Wm)(b,{required:"",onCountryChanged:d.countryChange,class:"phone-input q-mt-lg",defaultCountry:"iq",customValidate:!1,onOnInput:d.valid,onInput:d.phoneValidate,modelValue:r.phone,"onUpdate:modelValue":t[4]||(t[4]=e=>r.phone=e)},null,8,["onCountryChanged","onOnInput","onInput","modelValue"]),(0,i.Wm)(m,{class:"q-mt-lg",ref:"emailRef",outlined:"",type:"email",modelValue:r.credentials.email,"onUpdate:modelValue":t[5]||(t[5]=e=>r.credentials.email=e),label:"E-mail","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type a valid E-mail"]},null,8,["modelValue","rules"]),(0,i._)("div",s,[o,(0,i.Wm)(f,{modelValue:r.credentials.rate,"onUpdate:modelValue":t[6]||(t[6]=e=>r.credentials.rate=e),size:"2em",class:"q-mb-md q-ml-sm",max:5,color:"primary"},null,8,["modelValue"])]),(0,i.Wm)(m,{outlined:"",modelValue:r.credentials.website,"onUpdate:modelValue":t[7]||(t[7]=e=>r.credentials.website=e),label:"Website","lazy-rules":""},null,8,["modelValue"]),(0,i.Wm)(m,{outlined:"",modelValue:r.credentials.address,"onUpdate:modelValue":t[8]||(t[8]=e=>r.credentials.address=e),label:"Address","lazy-rules":""},null,8,["modelValue"]),(0,i.Wm)(m,{outlined:"",modelValue:r.credentials.zipCode,"onUpdate:modelValue":t[9]||(t[9]=e=>r.credentials.zipCode=e),label:"Zipcode","lazy-rules":""},null,8,["modelValue"])])),_:1})])),_:1}),(0,i.Wm)(p,{class:"bg-grey-3",style:{position:"sticky !important",bottom:"0","z-index":"5"}},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{loading:r.loading,onClick:d.submit,class:"full-width",color:"primary",label:"Submit","no-caps":""},null,8,["loading","onClick"])])),_:1})])),_:1})}var r=a(3617),d=a(9549);const c={components:{VueTelInput:d.VueTelInput},props:["actionType","type","inProfile","body"],data(){return{id:null,phone:"",loading:!1,credentials:{name:"",avatar:null,businessType:"Company",email:"",website:"",address:"",zipCode:"",logo:null,rate:0,clientType:""}}},methods:{phoneValidate(e){isNaN(Number(e.data))&&(this.phone=this.phone.substring(0,this.phone.length-1))},valid(e,t){t.valid?document.querySelector(".vue-tel-input").removeAttribute("style"):document.querySelector(".vue-tel-input").setAttribute("style","border-color:#cc444b !important;")},countryChange(e){let t=0;this.dialCode="+"+e.dialCode,this.phone=this.phone.substring(this.dialCode.length,this.phone.length),0===t&&this.valid("",{valid:!0}),t+=1},...(0,r.nv)("crmStore",["createClient","updateClient","getClients","getOneClient"]),async submit(){if(this.$refs.companyRef.validate(),this.$refs.emailRef.validate(),!this.$refs.companyRef.hasError&&!this.$refs.emailRef.hasError){this.loading=!0;let e=new FormData;e.append("name",this.credentials.name),e.append("logo",this.credentials.logo),e.append("businessType",this.credentials.businessType),e.append("email",this.credentials.email),e.append("website",this.credentials.website),e.append("address",this.credentials.address),e.append("zipCode",this.credentials.zipCode),e.append("rate",this.credentials.rate),"Add"===this.actionType?e.append("clientType",this.type):e.append("clientType",this.credentials.clientType),e.append("phoneNumbers",this.dialCode+this.phone),"Add"===this.actionType?(await this.createClient(e),await this.$emit("updateForInvoice"),this.$q.notify({type:"positive",message:"Client created",color:"positive",position:"top",timeout:"500"})):(e.append("id",Number(this.id)),console.log(e),await this.updateClient(e),this.getClients("Client"),this.$route.params.id&&await this.getOneClient(this.$route.params.id),this.$q.notify({type:"positive",message:"Client updated",color:"positive",position:"top",timeout:"500"})),this.loading=!1,this.$emit("closeDialogue")}}},async mounted(){"Edit"===this.actionType&&(this.id=this.body.id,this.credentials.name=this.body.name,this.credentials.website=this.body.website,this.credentials.businessType=this.body.businessType,this.phone=this.body.phoneNumbers,this.credentials.email=this.body.email,this.credentials.website=this.body.website,this.credentials.address=this.body.address,this.credentials.zipCode=this.body.zipCode,this.credentials.logo=this.body.logo,this.credentials.rate=this.body.rate,this.credentials.clientType=this.body.clientType)}};var u=a(9214),p=a(151),m=a(9570),h=a(3747),g=a(2165),y=a(5589),b=a(4689),f=a(4974),w=a(4554),v=a(201),q=a(8833),_=a(677),C=a(7518),k=a.n(C);c.render=n;const x=c;k()(c,"components",{QLayout:u.Z,QCard:p.Z,QToolbar:m.Z,QToolbarTitle:h.Z,QBtn:g.Z,QCardSection:y.Z,QInput:b.Z,QFile:f.Z,QIcon:w.Z,QBtnToggle:v.Z,QRating:q.Z}),k()(c,"directives",{ClosePopup:_.Z})},6052:(e,t,a)=>{"use strict";a.d(t,{Z:()=>C});a(246);var i=a(3673),l=a(2323);function s(e,t,a,s,o,n){const r=(0,i.up)("q-toolbar-title"),d=(0,i.up)("q-btn"),c=(0,i.up)("q-toolbar"),u=(0,i.up)("q-input"),p=(0,i.up)("q-editor"),m=(0,i.up)("vue-tel-input"),h=(0,i.up)("q-card-section"),g=(0,i.up)("q-card"),y=(0,i.up)("q-layout"),b=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(y,{style:{width:"550px !important"}},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{style:{"max-width":"550px","min-height":"100vh"},flat:"",square:""},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{class:"bg-grey-3",style:{position:"sticky !important",top:"0","z-index":"15"}},{default:(0,i.w5)((()=>[(0,i.Wm)(r,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(a.actionType+" ")+"Contact ",1)])),_:1}),(0,i.wy)((0,i.Wm)(d,{icon:"close",flat:"",round:"",dense:""},null,512),[[b]])])),_:1}),(0,i.Wm)(h,{class:"q-gutter-sm scroll"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{ref:"nameRef",outlined:"",modelValue:o.contact.name,"onUpdate:modelValue":t[0]||(t[0]=e=>o.contact.name=e),label:"Name","lazy-rules":"",rules:[e=>e&&e.length>0||"Please write the name"]},null,8,["modelValue","rules"]),(0,i.Wm)(p,{modelValue:o.contact.description,"onUpdate:modelValue":t[1]||(t[1]=e=>o.contact.description=e),dense:e.$q.screen.lt.md,toolbar:[[{label:e.$q.lang.editor.align,icon:e.$q.iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]}],["bold","italic","strike","underline","subscript","superscript"],["token","hr","link","custom_btn"],["print","fullscreen"],[{label:e.$q.lang.editor.formatting,icon:e.$q.iconSet.editor.formatting,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{label:e.$q.lang.editor.fontSize,icon:e.$q.iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:e.$q.lang.editor.defaultFont,icon:e.$q.iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","dense","toolbar"]),(0,i.Wm)(m,{required:"",onCountryChanged:n.countryChange1,class:"phone-input q-mt-lg",defaultCountry:"iq",onOnInput:n.valid1,onInput:n.phoneValidate1,modelValue:o.phone1,"onUpdate:modelValue":t[2]||(t[2]=e=>o.phone1=e)},null,8,["onCountryChanged","onOnInput","onInput","modelValue"]),(0,i.Wm)(m,{required:"",onCountryChanged:n.countryChange2,class:"phone-input q-mt-lg",defaultCountry:"iq",onOnInput:n.valid2,onInput:n.phoneValidate2,modelValue:o.phone2,"onUpdate:modelValue":t[3]||(t[3]=e=>o.phone2=e)},null,8,["onCountryChanged","onOnInput","onInput","modelValue"]),(0,i.Wm)(u,{class:"q-mt-lg",ref:"emailRef",outlined:"",type:"email",modelValue:o.contact.email,"onUpdate:modelValue":t[4]||(t[4]=e=>o.contact.email=e),label:"E-mail","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type your E-mail"]},null,8,["modelValue","rules"]),(0,i.Wm)(u,{ref:"posRef",outlined:"",modelValue:o.contact.position,"onUpdate:modelValue":t[5]||(t[5]=e=>o.contact.position=e),label:"Position","lazy-rules":"",rules:[e=>e&&e.length>0||"Please write the position"]},null,8,["modelValue","rules"]),(0,i.Wm)(u,{ref:"deptRef",outlined:"",modelValue:o.contact.department,"onUpdate:modelValue":t[6]||(t[6]=e=>o.contact.department=e),label:"Department","lazy-rules":"",rules:[e=>e&&e.length>0||"Please write the department"]},null,8,["modelValue","rules"]),(0,i.Wm)(u,{ref:"statusRef",outlined:"",modelValue:o.contact.status,"onUpdate:modelValue":t[7]||(t[7]=e=>o.contact.status=e),label:"Status","lazy-rules":"",rules:[e=>e&&e.length>0||"Please write status"]},null,8,["modelValue","rules"])])),_:1})])),_:1}),(0,i.Wm)(c,{class:"bg-grey-3",style:{position:"sticky !important",bottom:"0","z-index":"5"}},{default:(0,i.w5)((()=>[(0,i.Wm)(d,{loading:o.loading,onClick:n.submit,label:"Submit","no-caps":"",type:"reset",color:"primary",unelevated:"",class:"full-width"},null,8,["loading","onClick"])])),_:1})])),_:1})}var o=a(52),n=a.n(o),r=a(3617),d=a(2179),c=a(9549);const u={props:["ccid","clId","actionType","body"],data(){return{error1:!1,error2:!1,phone1:"",phone2:"",dialCode1:"",dialCode2:"",contact:{name:"",description:"description",businessPhoneNumber1:"",businessPhoneNumber2:"",position:"",email:"",department:"",status:""},clientId:Number(this.clId),id:Number(this.ccid),loading:!1}},components:{phone:d.Z,VueTelInput:c.VueTelInput},methods:{phoneValidate1(e){isNaN(Number(e.data))&&(this.phone1=this.phone1.substring(0,this.phone1.length-1))},phoneValidate2(e){isNaN(Number(e.data))&&(this.phone2=this.phone2.substring(0,this.phone2.length-1))},countryChange1(e){let t=0;this.dialCode1="+"+e.dialCode,this.phone1=this.phone1.substring(this.dialCode1.length,this.phone1.length),0===t&&this.valid1("",{valid:!0}),t+=1},countryChange2(e){let t=0;this.dialCode2="+"+e.dialCode,this.phone2=this.phone2.substring(this.dialCode2.length,this.phone2.length),0===t&&this.valid2("",{valid:!0}),t+=1},valid1(e,t){t.valid?document.querySelectorAll(".vue-tel-input")[0].removeAttribute("style"):document.querySelectorAll(".vue-tel-input")[0].setAttribute("style","border-color:#cc444b !important;")},valid2(e,t){t.valid?document.querySelectorAll(".vue-tel-input")[1].removeAttribute("style"):document.querySelectorAll(".vue-tel-input")[1].setAttribute("style","border-color:#cc444b !important;")},...(0,r.nv)("crmStore",["getOneClient"]),async submit(){this.$refs.nameRef.validate(),this.$refs.emailRef.validate(),this.$refs.posRef.validate(),this.$refs.deptRef.validate(),this.$refs.statusRef.validate(),this.$refs.nameRef.hasError||this.$refs.emailRef.hasError||this.$refs.posRef.hasError||this.$refs.deptRef.hasError||this.$refs.statusRef.hasError||(this.error1=!1,this.error2=!1,this.loading=!0,this.contact.businessPhoneNumber1=this.dialCode1+this.phone1,this.contact.businessPhoneNumber2=this.dialCode1+this.phone2,"Add"===this.actionType?await this.create():await this.update(),await this.getOneClient(this.clId),this.loading=!1,this.$emit("closeDialogue"))},async create(){await n().post("https://onconnect-backend-api.herokuapp.com/api/v1/clientContacts/create",{...this.contact,clientId:Number(this.clientId)},{headers:{Authorization:localStorage.getItem("accessToken")}});this.loading=!1,await this.$emit("updateForInvoice"),this.$q.notify({type:"positive",message:"Contact created",color:"positive",position:"top",timeout:"500"})},async update(){await n().post("https://onconnect-backend-api.herokuapp.com/api/v1/clientContacts/update",{...this.contact,id:this.id},{headers:{Authorization:localStorage.getItem("accessToken")}});this.loading=!1,this.$q.notify({type:"positive",message:"Contact updated",color:"positive",position:"top",timeout:"500"})}},async mounted(){"Edit"===this.actionType?(this.contact.name=this.body.name,this.contact.description=this.body.description,this.phone1=this.body.businessPhoneNumber1,this.phone2=this.body.businessPhoneNumber2,this.contact.position=this.body.position,this.contact.email=this.body.email,this.contact.department=this.body.department,this.contact.status=this.body.status):(this.phone1="1",this.phone2="1",this.phone1="",this.phone2="")}};var p=a(9214),m=a(151),h=a(9570),g=a(3747),y=a(2165),b=a(5589),f=a(4689),w=a(9989),v=a(677),q=a(7518),_=a.n(q);u.render=s,u.__scopeId="data-v-cb2f8c96";const C=u;_()(u,"components",{QLayout:p.Z,QCard:m.Z,QToolbar:h.Z,QToolbarTitle:g.Z,QBtn:y.Z,QCardSection:b.Z,QInput:f.Z,QEditor:w.Z}),_()(u,"directives",{ClosePopup:v.Z})},8288:(e,t,a)=>{"use strict";a.d(t,{Z:()=>T});a(246);var i=a(3673),l=a(2323),s=a(8880);const o=e=>((0,i.dD)("data-v-0405916c"),e=e(),(0,i.Cn)(),e),n=o((()=>(0,i._)("div",{class:"q-ma-none absolute q-ml-sm text-grey-7",style:{"z-index":"10","font-size":"12px","line-height":"20px","font-weight":"400"}},"Projects date",-1))),r=o((()=>(0,i._)("div",{class:"q-ma-none absolute q-ml-sm text-grey-7",style:{"z-index":"10","font-size":"12px","line-height":"20px","font-weight":"400"}},"Project deadline",-1))),d={class:"flex items-center"},c=o((()=>(0,i._)("p",{style:{padding:"0 !important","font-size":"1rem"}},"Rate: ",-1)));function u(e,t,a,o,u,p){const m=(0,i.up)("q-toolbar-title"),h=(0,i.up)("q-btn"),g=(0,i.up)("q-toolbar"),y=(0,i.up)("q-select"),b=(0,i.up)("q-icon"),f=(0,i.up)("q-file"),w=(0,i.up)("Datepicker"),v=(0,i.up)("q-input"),q=(0,i.up)("q-editor"),_=(0,i.up)("q-rating"),C=(0,i.up)("q-card-section"),k=(0,i.up)("q-card"),x=(0,i.up)("q-layout"),V=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(x,{style:{width:"550px !important"}},{default:(0,i.w5)((()=>[(0,i.Wm)(k,{style:{"max-width":"550px","min-height":"100vh"},flat:"",square:""},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{class:"bg-grey-3",style:{position:"sticky !important",top:"0","z-index":"15"}},{default:(0,i.w5)((()=>[(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(this.actionType+" ")+"Project ",1)])),_:1}),(0,i.wy)((0,i.Wm)(h,{icon:"close",flat:"",round:"",dense:""},null,512),[[V]])])),_:1}),(0,i.Wm)(C,{class:"q-gutter-md scroll"},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{"bg-color":"white",outlined:"",ref:"clientRef",rules:[e=>null!==e||"This field is required"],modelValue:u.client,"onUpdate:modelValue":t[0]||(t[0]=e=>u.client=e),options:u.clientOptions,label:"Choose client",loading:u.isLoaded},null,8,["rules","modelValue","options","loading"]),(0,i.Wm)(y,{ref:"leaderRef",rules:[e=>e&&e.length>0||"This field is required"],"use-chips":"",outlined:"",modelValue:u.leaders,"onUpdate:modelValue":t[1]||(t[1]=e=>u.leaders=e),multiple:"",options:u.leaderOptions,counter:"",hint:"Leaders",label:"Choose leaders",loading:u.isLoaded},null,8,["rules","modelValue","options","loading"]),(0,i.Wm)(y,{ref:"memberRef",rules:[e=>e&&e.length>0||"This field is required"],"use-chips":"",outlined:"",modelValue:u.members,"onUpdate:modelValue":t[2]||(t[2]=e=>u.members=e),multiple:"",options:u.memberOptions,counter:"",hint:"Members",label:"Choose members",loading:u.isLoaded},null,8,["rules","modelValue","options","loading"]),(0,i.wy)((0,i.Wm)(f,{modelValue:u.files,"onUpdate:modelValue":t[3]||(t[3]=e=>u.files=e),label:"Pick file",filled:"",append:"","use-chips":"",clearable:""},{prepend:(0,i.w5)((()=>[(0,i.Wm)(b,{name:"attach_file"})])),_:1},8,["modelValue"]),[[s.F8,"Edit"!==a.actionType]]),(0,i._)("div",null,[n,(0,i.Wm)(w,{modelValue:u.project.plannedStartDate,"onUpdate:modelValue":t[4]||(t[4]=e=>u.project.plannedStartDate=e),showNowButton:""},null,8,["modelValue"])]),(0,i._)("div",null,[r,(0,i.Wm)(w,{class:"q-mt-sm",modelValue:u.project.plannedEndDate,"onUpdate:modelValue":t[5]||(t[5]=e=>u.project.plannedEndDate=e),showNowButton:""},null,8,["modelValue"])]),(0,i.Wm)(v,{ref:"nameRef",rules:[e=>e&&e.length>0||"This field is required"],outlined:"",modelValue:u.project.name,"onUpdate:modelValue":t[6]||(t[6]=e=>u.project.name=e),label:"Name","lazy-rules":""},null,8,["rules","modelValue"]),(0,i.Wm)(q,{modelValue:u.project.description,"onUpdate:modelValue":t[7]||(t[7]=e=>u.project.description=e),dense:e.$q.screen.lt.md,toolbar:[[{label:e.$q.lang.editor.align,icon:e.$q.iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]}],["bold","italic","strike","underline","subscript","superscript"],["token","hr","link","custom_btn"],["print","fullscreen"],[{label:e.$q.lang.editor.formatting,icon:e.$q.iconSet.editor.formatting,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{label:e.$q.lang.editor.fontSize,icon:e.$q.iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:e.$q.lang.editor.defaultFont,icon:e.$q.iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","dense","toolbar"]),(0,i.Wm)(v,{ref:"priorityRef",rules:[e=>e&&e.length>0||"This field is required"],outlined:"",modelValue:u.project.priority,"onUpdate:modelValue":t[8]||(t[8]=e=>u.project.priority=e),label:"Priority"},null,8,["rules","modelValue"]),(0,i._)("div",d,[c,(0,i.Wm)(_,{modelValue:u.project.rate,"onUpdate:modelValue":t[9]||(t[9]=e=>u.project.rate=e),size:"2em",class:"q-mb-md q-ml-sm",max:5,color:"primary"},null,8,["modelValue"])])])),_:1})])),_:1}),(0,i.Wm)(g,{class:"bg-grey-3",style:{position:"sticky !important",bottom:"0","z-index":"5"}},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{loading:u.loading,onClick:p.submit,label:"Submit","no-caps":"",type:"reset",color:"primary",unelevated:"",class:"full-width"},null,8,["loading","onClick"])])),_:1})])),_:1})}var p=a(3617),m=a(1082),h=a(4789);const g={components:{Datepicker:h.Z},props:["actionType","body"],data(){return{isLoaded:!1,loading:!1,clientOptions:[],client:null,leaders:[],leaderOptions:[],members:[],memberOptions:[],files:null,project:{name:"",rate:0,priority:"",description:"Description",plannedStartDate:"",plannedEndDate:"",clientId:null,leaders:[],members:[]},id:null}},computed:{...(0,p.rn)("crmStore",["allClients"]),...(0,p.rn)("userStore",["users"])},methods:{...(0,p.nv)("projectStore",["addProject","editProject","getProjects","addFiles"]),...(0,p.nv)("crmStore",["getClients"]),...(0,p.nv)("userStore",["getUsers"]),dateConversion(e){let t=new Date(e);return t.setHours(t.getHours()-3),m.ZP.formatDate(t,"YYYY-MM-DD HH:mm")},async submit(){if(this.$refs.leaderRef.validate(),this.$refs.memberRef.validate(),this.$refs.nameRef.validate(),this.$refs.priorityRef.validate(),this.$refs.clientRef.validate(),!(this.$refs.leaderRef.hasError||this.$refs.memberRef.hasError||this.$refs.nameRef.hasError||this.$refs.priorityRef.hasError||this.$refs.clientRef.hasError)){for(let e=0;e<this.leaders.length;e++)this.project.leaders.push(Number(this.leaders[e].id));for(let e=0;e<this.members.length;e++)this.project.members.push(Number(this.members[e].id));this.project.clientId=Number(this.client.id),this.project.plannedStartDate=m.ZP.formatDate(this.project.plannedStartDate,"YYYY-MM-DD HH:mm"),this.project.plannedEndDate=m.ZP.formatDate(this.project.plannedEndDate,"YYYY-MM-DD HH:mm"),this.loading=!0,"Add"===this.actionType?await this.create():await this.update(),this.loading=!1,this.$emit("closeDialogue")}},async create(){await this.addProject({data:this.project,files:this.files})},async update(){await this.editProject({data:{...this.project,id:Number(this.body.id)}})}},async mounted(){this.isLoaded=!0,await this.getClients(),await this.getUsers();for(let e=0;e<this.allClients.length;e++)"Blacklist"!==this.allClients[e].clientType&&this.clientOptions.push({label:this.allClients[e].name,id:this.allClients[e].id});for(let e=0;e<this.users.length;e++)this.memberOptions.push({label:this.users[e].name,id:this.users[e].id}),this.leaderOptions.push({label:this.users[e].name,id:this.users[e].id});if(this.isLoaded=!1,"Edit"===this.actionType){this.project.name=this.body.name,this.project.description=this.body.description,this.project.priority=this.body.priority,this.project.rate=this.body.rate,this.project.plannedStartDate=this.dateConversion(this.body.plannedStartDate),this.project.plannedEndDate=this.dateConversion(this.body.plannedEndDate),this.client={label:this.body.client.name,id:this.body.client.id};for(let e=0;e<this.body.memberUsers.length;e++)this.members.push({label:this.body.memberUsers[e].name,id:this.body.memberUsers[e].userId});for(let e=0;e<this.body.leaderUsers.length;e++)this.leaders.push({label:this.body.leaderUsers[e].name,id:this.body.leaderUsers[e].userId})}else this.project.plannedStartDate=m.ZP.formatDate(new Date,"YYYY-MM-DD HH:mm"),this.project.plannedEndDate=m.ZP.formatDate(new Date,"YYYY-MM-DD HH:mm")}};var y=a(9214),b=a(151),f=a(9570),w=a(3747),v=a(2165),q=a(5589),_=a(3314),C=a(4974),k=a(4554),x=a(4689),V=a(9989),W=a(8833),z=a(677),D=a(7518),S=a.n(D);g.render=u,g.__scopeId="data-v-0405916c";const T=g;S()(g,"components",{QLayout:y.Z,QCard:b.Z,QToolbar:f.Z,QToolbarTitle:w.Z,QBtn:v.Z,QCardSection:q.Z,QSelect:_.Z,QFile:C.Z,QIcon:k.Z,QInput:x.Z,QEditor:V.Z,QRating:W.Z}),S()(g,"directives",{ClosePopup:z.Z})},3402:(e,t,a)=>{e.exports=a.p+"img/one_logo_neat.391c3929.png"}}]);