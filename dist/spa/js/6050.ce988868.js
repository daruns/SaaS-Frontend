"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[6050],{56050:(e,t,o)=>{o.r(t),o.d(t,{default:()=>le});var i=o(83673);const l={class:"full-width flex justify-between items-center header-height-standard q-px-md",style:{"border-bottom":"1px solid lightgrey"}},d=(0,i._)("div",{class:"text-h4"},"Deductions",-1),n={class:"flex items-center"};function a(e,t,o,a,s,u){const r=(0,i.up)("q-btn"),p=(0,i.up)("deductionsTable"),c=(0,i.up)("modal"),m=(0,i.up)("q-dialog"),y=(0,i.up)("q-scroll-area"),h=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(h,{class:"q-py-none q-my-none"},{default:(0,i.w5)((()=>[(0,i._)("div",l,[d,(0,i._)("div",n,[(0,i.Wm)(r,{onClick:t[0]||(t[0]=e=>s.dialogue=!0),color:"primary",label:"Add "+a.tab[0].toUpperCase()+a.tab.substr(1,a.tab.length),unelevated:"",rounded:"","no-caps":""},null,8,["label"])])]),(0,i.Wm)(y,{style:{"max-height":"auto !important","min-height":"auto !important",height:"calc(100vh - 131px)"},class:"q-px-md"},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{currentUser:e.user},null,8,["currentUser"]),(0,i.Wm)(m,{seamless:"",position:"right",modelValue:s.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>s.dialogue=e)},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{onCloseDialogue:t[1]||(t[1]=e=>s.dialogue=!1),type:a.tab,currentUser:e.user,actionType:"Add",id:{}},null,8,["type","currentUser"])])),_:1},8,["modelValue"])])),_:1})])),_:1})}o(90246);var s=o(62323);const u={style:{"font-size":"20px"}},r={style:{"font-size":"20px"}},p={style:{"font-size":"20px"}},c={style:{"font-size":"20px"}},m={style:{"font-size":"20px"}},y={style:{"font-size":"20px"}},h={style:{"font-size":"20px"}};function f(e,t,o,l,d,n){const a=(0,i.up)("q-td"),f=(0,i.up)("q-icon"),g=(0,i.up)("q-item-section"),w=(0,i.up)("q-item"),b=(0,i.up)("q-separator"),T=(0,i.up)("q-list"),v=(0,i.up)("q-menu"),q=(0,i.up)("q-btn"),_=(0,i.up)("q-tr"),D=(0,i.up)("q-table"),W=(0,i.up)("modal"),V=(0,i.up)("q-dialog"),x=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(D,{rows:n.data,columns:d.columns,"row-key":"id",loading:d.loading,"rows-per-page-options":[20,50,100,0],flat:"",class:"bg-secondary q-pa-md"},{body:(0,i.w5)((t=>[(0,i.Wm)(_,{class:(0,s.C_)(t.rowIndex%2!==0&&"bg-white"),props:t},{default:(0,i.w5)((()=>[(0,i.Wm)(a,{class:"items-center justify-start",key:"employee",props:t},{default:(0,i.w5)((()=>{var e;return[(0,i._)("p",u,(0,s.zw)(null===(e=t.row.employee)||void 0===e?void 0:e.name),1)]})),_:2},1032,["props"]),(0,i.Wm)(a,{class:"items-center justify-start",key:"deductionType",props:t},{default:(0,i.w5)((()=>{var e;return[(0,i._)("p",r,(0,s.zw)(null===(e=t.row.deductionType)||void 0===e?void 0:e.name),1)]})),_:2},1032,["props"]),(0,i.Wm)(a,{class:"items-center justify-start",key:"qty",props:t},{default:(0,i.w5)((()=>[(0,i._)("p",p,(0,s.zw)(t.row.qty),1)])),_:2},1032,["props"]),(0,i.Wm)(a,{class:"items-center justify-start",key:"fund",props:t},{default:(0,i.w5)((()=>{var e;return[(0,i._)("p",c,(0,s.zw)(null===(e=t.row.deductionType)||void 0===e?void 0:e.fund),1)]})),_:2},1032,["props"]),(0,i.Wm)(a,{class:"items-center justify-start",key:"total",props:t},{default:(0,i.w5)((()=>[(0,i._)("p",m,(0,s.zw)(t.row.total),1)])),_:2},1032,["props"]),(0,i.Wm)(a,{class:"items-center justify-start",key:"date",props:t},{default:(0,i.w5)((()=>[(0,i._)("p",y,(0,s.zw)(d.dateFunc.formatDate(new Date(t.row.date),"YYYY-MM-DD HH:mm")),1)])),_:2},1032,["props"]),(0,i.Wm)(a,{class:"items-center justify-start",key:"description",props:t},{default:(0,i.w5)((()=>[(0,i._)("p",h,(0,s.zw)(t.row.description),1)])),_:2},1032,["props"]),(0,i.Wm)(a,{class:"text-right",key:"actions",props:t},{default:(0,i.w5)((()=>[(0,i.Wm)(q,{dense:"",round:"",flat:"",icon:"more_vert"},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{"transition-show":"scale","transition-hide":"scale"},{default:(0,i.w5)((()=>[(0,i.Wm)(T,{style:{"min-width":"75px"}},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(w,{onClick:o=>e.deleteDeduction({id:t.row.id}),style:{},clickable:""},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{class:"flex flex-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{name:"delete",color:"negative",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[x]]),(0,i.Wm)(b),(0,i.wy)((0,i.Wm)(w,{onClick:e=>n.editDeduction(t.row),clickable:""},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{class:"flex flex-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{name:"edit",color:"warning",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[x]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["class","props"])])),_:1},8,["rows","columns","loading"]),(0,i.Wm)(V,{onCloseDialogue:t[1]||(t[1]=e=>d.dialogue=!1),inProfile:!1,seamless:"",position:"right",modelValue:d.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>d.dialogue=e)},{default:(0,i.w5)((()=>[(0,i.Wm)(W,{onCloseDialogue:t[0]||(t[0]=e=>d.dialogue=!1),body:d.body,id:d.id,actionType:"Edit"},null,8,["body","id"])])),_:1},8,["modelValue"])])}var g=o(93617);const w=(0,i._)("br",null,null,-1),b={class:"row items-center justify-end"},T={class:"row items-center justify-end"};function v(e,t,o,l,d,n){const a=(0,i.up)("q-toolbar-title"),u=(0,i.up)("q-btn"),r=(0,i.up)("q-toolbar"),p=(0,i.up)("q-select"),c=(0,i.up)("q-input"),m=(0,i.up)("q-date"),y=(0,i.up)("q-popup-proxy"),h=(0,i.up)("q-icon"),f=(0,i.up)("q-time"),g=(0,i.up)("q-card-section"),v=(0,i.up)("q-card"),q=(0,i.up)("q-layout"),_=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(q,{style:{width:"500px !important"}},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{style:{"max-width":"500px","min-height":"100vh"},flat:"",square:""},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{class:"q-pa-md bg-grey-3",style:{position:"sticky !important",top:"0","z-index":"15",height:"63px !important"}},{default:(0,i.w5)((()=>[(0,i.Wm)(a,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(o.actionType)+" Deduction ",1)])),_:1}),(0,i.wy)((0,i.Wm)(u,{icon:"close",flat:"",round:"",dense:""},null,512),[[_]])])),_:1}),(0,i.Wm)(g,{class:"q-gutter-sm scroll"},{default:(0,i.w5)((()=>[w,(0,i.Wm)(p,{modelValue:d.deductionType,"onUpdate:modelValue":[t[0]||(t[0]=e=>d.deductionType=e),t[1]||(t[1]=e=>n.updateTotal())],ref:"deductionTypeRef","no-caps":"",label:"Deduction Type",loading:d.deductionTypeLoading,outlined:"",options:d.deductionTypeOptions,"lazy-rules":"",rules:[e=>e||"Please Select an Deduction Type"]},null,8,["modelValue","loading","options","rules"]),(0,i.Wm)(p,{modelValue:d.employee,"onUpdate:modelValue":t[2]||(t[2]=e=>d.employee=e),"no-caps":"",label:"Employee",ref:"employeeRef",loading:d.employeeLoading,outlined:"",options:d.employeeOptions,"lazy-rules":"",rules:[e=>e||"Please Select an Employee"]},null,8,["modelValue","loading","options","rules"]),(0,i.Wm)(c,{outlined:"",type:"number",ref:"qtyRef",modelValue:d.credentials.qty,"onUpdate:modelValue":[t[3]||(t[3]=e=>d.credentials.qty=e),t[4]||(t[4]=e=>n.updateTotal())],modelModifiers:{number:!0},label:"Quantity"},null,8,["modelValue"]),(0,i.Wm)(c,{outlined:"",readonly:"",modelValue:d.totalValue,"onUpdate:modelValue":t[5]||(t[5]=e=>d.totalValue=e),label:"Total"},null,8,["modelValue"]),(0,i.Wm)(c,{filled:"",modelValue:d.credentials.date,"onUpdate:modelValue":t[8]||(t[8]=e=>d.credentials.date=e),ref:"dateRef",rules:[e=>e.length>0||"Please type the Date"]},{prepend:(0,i.w5)((()=>[(0,i.Wm)(h,{name:"event",class:"cursor-pointer"},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{modelValue:d.credentials.date,"onUpdate:modelValue":t[6]||(t[6]=e=>d.credentials.date=e),mask:"YYYY-MM-DD HH:mm"},{default:(0,i.w5)((()=>[(0,i._)("div",b,[(0,i.wy)((0,i.Wm)(u,{label:"Close",color:"primary",flat:""},null,512),[[_]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),append:(0,i.w5)((()=>[(0,i.Wm)(h,{name:"access_time",class:"cursor-pointer"},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{modelValue:d.credentials.date,"onUpdate:modelValue":t[7]||(t[7]=e=>d.credentials.date=e),mask:"YYYY-MM-DD HH:mm",format24h:""},{default:(0,i.w5)((()=>[(0,i._)("div",T,[(0,i.wy)((0,i.Wm)(u,{label:"Close",color:"primary",flat:""},null,512),[[_]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","rules"]),(0,i.Wm)(c,{outlined:"",modelValue:d.credentials.description,"onUpdate:modelValue":t[9]||(t[9]=e=>d.credentials.description=e),label:"Decription"},null,8,["modelValue"])])),_:1})])),_:1}),(0,i.Wm)(r,{class:"bg-grey-3 submitBtnClass",style:{position:"sticky !important",bottom:"0","z-index":"5"}},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{loading:d.loading,onClick:n.submit,class:"full-width",color:"primary",label:"Submit","no-caps":""},null,8,["loading","onClick"])])),_:1})])),_:1})}o(10071);var q=o(61959),_=o(49549),D=o(11488),W=o(94789);const V={components:{VueTelInput:_.VueTelInput,Datepicker:W.Z},props:["currentUser","actionType","body"],data(){return{show:!0,id:null,totalValue:(0,q.iH)(0),loading:!1,deductionTypeOptions:[],employeeOptions:[],employee:null,deductionType:null,deductionTypeLoading:!1,employeeLoading:!1,credentials:{qty:0,description:"",date:(0,q.iH)(D().format("YYYY-MM-DD HH:mm")),employeeId:null,deductionTypeId:null}}},computed:{...(0,g.rn)("payrollStore",["deductionTypes"]),...(0,g.rn)("hrmStore",["allEmployees"])},methods:{...(0,g.nv)("payrollStore",["createDeduction","updateDeduction","getDeductions","getDeductionTypes"]),...(0,g.nv)("hrmStore",["getEmployees"]),toggleShow(){this.show=!this.show},updateTotal(){var e,t,o,i;this.totalValue=Number((null===(e=this.credentials)||void 0===e?void 0:e.qty)||0)*Number((null===(t=this.deductionType)||void 0===t?void 0:t.fund)||0),console.log(null===(o=this.credentials)||void 0===o?void 0:o.qty,null===(i=this.deductionType)||void 0===i?void 0:i.fund,this.totalValue)},async submit(){var e,t,o;if(this.$refs.deductionTypeRef.validate(),this.$refs.employeeRef.validate(),this.$refs.qtyRef.validate(),!(null!==(e=this.$refs.deductionTypeRef)&&void 0!==e&&e.hasError||null!==(t=this.$refs.employeeRef)&&void 0!==t&&t.hasError||null!==(o=this.$refs.qtyRef)&&void 0!==o&&o.hasError)){this.loading=!0;let e={};if(this.deductionType&&(this.credentials.deductionTypeId=Number(this.deductionType.id)),this.employee&&(this.credentials.employeeId=Number(this.employee.id)),"Add"===this.actionType){e["description"]=this.credentials.description,e["qty"]=this.credentials.qty,e["date"]=this.credentials.date,e["employeeId"]=this.credentials.employeeId,e["deductionTypeId"]=this.credentials.deductionTypeId;let t=this;try{console.log(e),await this.createDeduction(e),t.$q.notify({type:"positive",message:"Deduction created",color:"positive",position:"top",timeout:"500"})}catch(i){t.$q.notify({type:"negative",message:"Something went wrong while requesting Deduction!",color:"negative",position:"top",timeout:"500"})}finally{this.loading=!1,this.$emit("closeDialogue")}}else{e["id"]=Number(this.id),this.credentials.deductionTypeId&&(e["deductionTypeId"]=Number(this.credentials.deductionTypeId)),this.credentials.employeeId&&(e["employeeId"]=Number(this.credentials.employeeId)),this.credentials.qty&&(e["qty"]=Number(this.credentials.qty)),this.credentials.date&&(e["date"]=D(this.credentials.date).format("YYYY-MM-DD HH:mm:ss")),this.credentials.description&&(e["description"]=Number(this.credentials.description));try{await this.updateDeduction(e),selfout.$q.notify({type:"positive",message:"Deduction updated",color:"positive",position:"top",timeout:"500"})}catch(i){selfout.$q.notify({type:"negative",message:"Something went wrong while requesting Deduction!",color:"negative",position:"top",timeout:"500"})}finally{this.loading=!1,this.$emit("closeDialogue")}}}},getValuesFromApiAsync(e){return new Promise((async t=>{t(await e)}))}},async mounted(){"Add"===this.actionType&&(this.deductionTypeLoading=!0,this.getValuesFromApiAsync(this.getDeductionTypes()).then((()=>{for(let e of this.deductionTypes)this.deductionTypeOptions.push({label:`${e.name} - ${Number(e.rate)} ${e.durationType}`,id:e.id,fund:e.fund,rate:e.rate,durationType:e.durationType});this.deductionTypeLoading=!1})),this.employeeLoading=!0,this.getValuesFromApiAsync(this.getEmployees()).then((()=>{for(let e of this.allEmployees)this.employeeOptions.push({label:e.name,id:e.id});this.employeeLoading=!1}))),"Edit"===this.actionType&&(this.id=this.body.id,this.credentials.description=this.body.description,this.credentials.date=D(this.body.date).format("YYYY-MM-DD HH:mm").toString(),this.credentials.qty=Number(this.body.qty),this.totalValue=Number(this.body.total),this.deductionTypeLoading=!0,this.getValuesFromApiAsync(this.getDeductionTypes()).then((()=>{for(let e of this.deductionTypes)this.deductionTypeOptions.push({label:`${e.name} - ${Number(e.rate)} ${e.durationType}`,id:e.id,fund:e.fund,rate:e.rate,durationType:e.durationType});this.body.deductionType&&(this.deductionType={label:`${this.body.deductionType.name} - ${Number(this.body.deductionType.rate)} ${this.body.deductionType.durationType}`,id:this.body.deductionType.id,fund:this.body.deductionType.fund,rate:this.body.deductionType.rate,durationType:this.body.deductionType.durationType}),this.deductionTypeLoading=!1})),this.employeeLoading=!0,this.getValuesFromApiAsync(this.getEmployees()).then((()=>{var e,t;for(let o of this.allEmployees)this.employeeOptions.push({label:o.name,id:o.id});this.body.employee&&(this.employee={label:null===(e=this.body.employee)||void 0===e?void 0:e.name,id:null===(t=this.body.employee)||void 0===t?void 0:t.id}),this.employeeLoading=!1}))),console.log("deductiontpye----",this.employee)}};var x=o(19214),Q=o(10151),Z=o(39570),k=o(13747),I=o(2165),Y=o(25589),C=o(63314),z=o(64689),$=o(24554),U=o(83944),S=o(85626),A=o(35990),H=o(60677),M=o(7518),E=o.n(M);V.render=v;const L=V;E()(V,"components",{QLayout:x.Z,QCard:Q.Z,QToolbar:Z.Z,QToolbarTitle:k.Z,QBtn:I.Z,QCardSection:Y.Z,QSelect:C.Z,QInput:z.Z,QIcon:$.Z,QPopupProxy:U.Z,QDate:S.Z,QTime:A.Z}),E()(V,"directives",{ClosePopup:H.Z});var N=o(25616);const j={computed:{...(0,g.rn)("payrollStore",["deductions"]),data(){return this.deductions}},data(){return{body:null,dateFunc:N.ZP,id:null,dialogue:!1,loading:!1,columns:[{name:"employee",label:"Employee",align:"left",field:"employee"},{name:"deductionType",label:"Deduction Type",align:"left",field:"deductionType"},{name:"qty",label:"Quantity",align:"left",field:"qty"},{name:"fund",label:"Fund",align:"left",field:"fund"},{name:"total",label:"Total",align:"left",field:"total"},{name:"date",label:"Date",align:"left",field:"date"},{name:"description",label:"Description",align:"left",field:"description"},{name:"actions",label:"Actions",align:"right",field:"actions"}]}},components:{modal:L},methods:{...(0,g.nv)("payrollStore",["getDeductions","deleteDeduction"]),editDeduction(e){if(!0===this.dialogue)return this.dialogue=!1,void setTimeout((()=>{this.body=e,this.dialogue=!0}),200);this.body=e,this.dialogue=!0},rowColor(e){if(e.rowIndex%2!==0||0!==e.rowIndex)return"background: #fff;"}},async mounted(){this.loading=!0,await this.getDeductions(),this.loading=!1}};var P=o(57678),R=o(18186),F=o(83884),O=o(20811),B=o(27011),G=o(83414),J=o(52035),K=o(65869),X=o(46778);j.render=f;const ee=j;E()(j,"components",{QTable:P.Z,QTr:R.Z,QTd:F.Z,QBtn:I.Z,QMenu:O.Z,QList:B.Z,QItem:G.Z,QItemSection:J.Z,QIcon:$.Z,QSeparator:K.Z,QDialog:X.Z}),E()(j,"directives",{ClosePopup:H.Z});const te={components:{modal:L,deductionsTable:ee},computed:{...(0,g.rn)("example",["user"])},data(){return{deductionsView:!1,dialogue:!1,hrMember:!1}},methods:{...(0,g.nv)("example",["getUser"])},setup(){return{tab:(0,q.iH)("deduction")}},async mounted(){await this.getUser()}};var oe=o(24379),ie=o(47704);te.render=a;const le=te;E()(te,"components",{QPage:oe.Z,QBtn:I.Z,QScrollArea:ie.Z,QDialog:X.Z})}}]);