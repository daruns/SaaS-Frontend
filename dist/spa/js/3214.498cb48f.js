"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[3214],{53214:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Lt});var l=a(83673);const s={class:"full-width flex justify-between items-center header-height-standard q-px-md",style:{"border-bottom":"1px solid lightgrey"}},o=(0,l._)("div",{class:"text-h4"},"Leaves",-1),r={class:"flex items-center"};function i(e,t,a,i,n,d){const m=(0,l.up)("q-btn"),u=(0,l.up)("leavesTable"),p=(0,l.up)("leaveApprovalsTable"),c=(0,l.up)("myLeavesTable"),y=(0,l.up)("modal"),v=(0,l.up)("q-dialog"),g=(0,l.up)("q-scroll-area"),w=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(w,{class:"q-py-none q-my-none"},{default:(0,l.w5)((()=>[(0,l._)("div",s,[o,(0,l._)("div",r,[(0,l.Wm)(m,{onClick:t[0]||(t[0]=e=>n.dialogue=!0),color:"primary",label:"Add "+i.tab[0].toUpperCase()+i.tab.substr(1,i.tab.length),unelevated:"",rounded:"","no-caps":""},null,8,["label"])])]),(0,l.Wm)(g,{style:{"max-height":"auto !important","min-height":"auto !important",height:"calc(100vh - 131px)"},class:"q-px-md"},{default:(0,l.w5)((()=>[n.leavesView?((0,l.wg)(),(0,l.j4)(u,{key:0,currentUser:e.user},null,8,["currentUser"])):(0,l.kq)("",!0),n.leaveApprovalsView?((0,l.wg)(),(0,l.j4)(p,{key:1,currentUser:e.user},null,8,["currentUser"])):(0,l.kq)("",!0),n.myLeavesView?((0,l.wg)(),(0,l.j4)(c,{key:2,currentUser:e.user},null,8,["currentUser"])):(0,l.kq)("",!0),(0,l.Wm)(v,{seamless:"",position:"right",modelValue:n.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>n.dialogue=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{onCloseDialogue:t[1]||(t[1]=e=>n.dialogue=!1),type:i.tab,currentUser:e.user,actionType:"Add",id:{}},null,8,["type","currentUser"])])),_:1},8,["modelValue"])])),_:1})])),_:1})}a(90246);var n=a(62323),d=a(98880);const m=(0,l._)("h6",{class:"q-pa-md"},"All Employees Leaves",-1),u={class:"q-mr-sm"},p=["src"],c={style:{"font-size":"17px"}},y={style:{"font-size":"17px"}},v={style:{"font-size":"17px"}},g={style:{"font-size":"17px"}},w={style:{"font-size":"17px"}},f={style:{"font-size":"17px"}},h=(0,l.Uk)("Rejected"),b=(0,l.Uk)("Completed"),k=(0,l.Uk)("Pending"),_={style:{"font-size":"17px"}},x={style:{"font-size":"17px"}},T=(0,l._)("div",{class:"q-mb-sm"},"Approval Stage",-1),D={class:"col-12 flex"},j={key:0,class:"flex items-center q-mx-md",style:{width:"80px"}},W={class:"text-center justify-center"},q=["src"],B={key:2},U={key:3},A=(0,l._)("hr",null,null,-1);function z(e,t,a,s,o,r){const i=(0,l.up)("q-th"),z=(0,l.up)("q-tr"),L=(0,l.up)("q-btn"),V=(0,l.up)("q-td"),Y=(0,l.up)("q-avatar"),M=(0,l.up)("q-badge"),C=(0,l.up)("q-linear-progress"),Z=(0,l.up)("q-icon"),N=(0,l.up)("q-table"),Q=(0,l.up)("modal"),E=(0,l.up)("q-dialog");return(0,l.wg)(),(0,l.iD)("div",null,[m,(0,l.Wm)(N,{rows:r.data,columns:o.columns,"rows-per-page-options":[5,50,100,0],"row-key":"id",loading:o.loading,flat:"",class:"bg-secondary q-pa-md"},{header:(0,l.w5)((e=>[(0,l.Wm)(z,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{"auto-width":""}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.cols,(t=>((0,l.wg)(),(0,l.j4)(i,{key:t.name,props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,l.w5)((e=>[(0,l.Wm)(z,{class:(0,n.C_)(e.rowIndex%2!==0&&"bg-white"),props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{key:"colspan","auto-width":""},{default:(0,l.w5)((()=>[(0,l.Wm)(L,{size:"sm",color:"primary",round:"",dense:"",onClick:t=>e.expand=!e.expand,icon:e.expand?"remove":"add"},null,8,["onClick","icon"])])),_:2},1024),(0,l.Wm)(V,{class:"items-center justify-start",key:"employeeName",props:e},{default:(0,l.w5)((()=>{var t,a;return[(0,l._)("span",u,[null!==(t=e.row.employee.user)&&void 0!==t&&t.avatar?((0,l.wg)(),(0,l.j4)(Y,{key:0},{default:(0,l.w5)((()=>{var t;return[(0,l._)("img",{src:null===(t=e.row.employee.user)||void 0===t?void 0:t.avatar},null,8,p)]})),_:2},1024)):((0,l.wg)(),(0,l.j4)(Y,{key:1,color:"grey","text-color":"white",icon:"person"}))]),(0,l._)("span",c,(0,n.zw)(null===(a=e.row.employee)||void 0===a?void 0:a.name),1)]})),_:2},1032,["props"]),(0,l.Wm)(V,{class:"items-center justify-start",key:"leaveTypeName",props:e},{default:(0,l.w5)((()=>{var t;return[(0,l._)("p",y,(0,n.zw)(null===(t=e.row.leaveType)||void 0===t?void 0:t.name),1)]})),_:2},1032,["props"]),(0,l.Wm)(V,{class:"items-center justify-start",key:"currentBalance",props:e},{default:(0,l.w5)((()=>[(0,l._)("p",v,(0,n.zw)(Number(e.row.currentBalance)),1)])),_:2},1032,["props"]),(0,l.Wm)(V,{class:"items-center justify-start",key:"remainBalance",props:e},{default:(0,l.w5)((()=>[(0,l._)("p",g,(0,n.zw)(Number(e.row.remainBalance)),1)])),_:2},1032,["props"]),(0,l.Wm)(V,{class:"items-center justify-start",key:"from",props:e},{default:(0,l.w5)((()=>[(0,l._)("p",w,(0,n.zw)(o.dateFunc.formatDate(new Date(e.row.from),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,l.Wm)(V,{class:"items-center justify-start",key:"to",props:e},{default:(0,l.w5)((()=>[(0,l._)("p",f,(0,n.zw)(o.dateFunc.formatDate(new Date(e.row.to),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,l.Wm)(V,{class:"items-center justify-start",key:"status",props:e},{default:(0,l.w5)((()=>["rejected"===e.row.status?((0,l.wg)(),(0,l.j4)(M,{key:0,rounded:"",class:"q-pa-sm bg-red text-white"},{default:(0,l.w5)((()=>[h])),_:1})):"completed"===e.row.status?((0,l.wg)(),(0,l.j4)(M,{key:1,rounded:"",class:"q-pa-sm bg-primary text-white"},{default:(0,l.w5)((()=>[b])),_:1})):"pending"===e.row.status?((0,l.wg)(),(0,l.j4)(M,{key:2,rounded:"",class:"q-pa-sm bg-warning text-white"},{default:(0,l.w5)((()=>[k])),_:1})):(0,l.kq)("",!0)])),_:2},1032,["props"]),(0,l.Wm)(V,{class:"items-center justify-start",key:"description",props:e},{default:(0,l.w5)((()=>[(0,l._)("p",_,(0,n.zw)(e.row.description),1)])),_:2},1032,["props"]),(0,l.Wm)(V,{class:"items-center justify-start",key:"createdAt",props:e},{default:(0,l.w5)((()=>[(0,l._)("p",x,(0,n.zw)(o.dateFunc.formatDate(new Date(e.row.createdAt),"YYYY-MM-DD")),1)])),_:2},1032,["props"])])),_:2},1032,["class","props"]),(0,l.wy)((0,l.Wm)(z,{class:(0,n.C_)(e.rowIndex%2!==0&&"bg-white")},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{colspan:"100%"},{default:(0,l.w5)((()=>[T,(0,l._)("div",D,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.row.leaveApprovals,((t,a)=>{var s;return(0,l.wg)(),(0,l.iD)("span",{key:t,class:"flex text-center justify-center"},[0!==a?((0,l.wg)(),(0,l.iD)("span",j,[(0,l.Wm)(C,{rounded:"",color:"completed"===t.status?"primary":"grey",size:"3px",value:1},null,8,["color"])])):(0,l.kq)("",!0),(0,l._)("span",W,[null!==(s=t.manager)&&void 0!==s&&s.user.avatar?((0,l.wg)(),(0,l.j4)(Y,{key:0,size:"35px"},{default:(0,l.w5)((()=>{var e;return[(0,l._)("img",{src:null===(e=t.manager)||void 0===e?void 0:e.user.avatar},null,8,q)]})),_:2},1024)):((0,l.wg)(),(0,l.j4)(Y,{key:1,size:"35px",color:"grey","text-color":"white",icon:"person"})),(0,l._)("div",null,(0,n.zw)(t.manager.name),1),1===t.manager.hrMember?((0,l.wg)(),(0,l.iD)("span",B,[e.row.leaveApprovals.every((e=>"rejected"!==e.status))&&"rejected"===e.row.status?((0,l.wg)(),(0,l.j4)(M,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{name:"close"})])),_:1})):e.row.leaveApprovals.every((e=>"completed"===e.status))&&"completed"===e.row.status?((0,l.wg)(),(0,l.j4)(M,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{name:"done"})])),_:1})):e.row.leaveApprovals.every((e=>"completed"===e.status))&&"pending"===e.row.status?((0,l.wg)(),(0,l.j4)(M,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{name:"more_horiz"})])),_:1})):((0,l.wg)(),(0,l.j4)(M,{key:3,rounded:"",class:"bg-grey text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{name:"more_horiz"})])),_:1}))])):((0,l.wg)(),(0,l.iD)("span",U,["rejected"===t.status?((0,l.wg)(),(0,l.j4)(M,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{name:"close"})])),_:1})):(0,l.kq)("",!0),"completed"===t.status?((0,l.wg)(),(0,l.j4)(M,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{name:"done"})])),_:1})):(0,l.kq)("",!0),"pending"===t.status?((0,l.wg)(),(0,l.j4)(M,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{name:"more_horiz"})])),_:1})):(0,l.kq)("",!0),""===t.status?((0,l.wg)(),(0,l.j4)(M,{key:3,rounded:"",class:"bg-warning text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{name:"more_horiz"})])),_:1})):(0,l.kq)("",!0)]))])])})),128))])])),_:2},1024)])),_:2},1032,["class"]),[[d.F8,e.expand]])])),_:1},8,["rows","columns","loading"]),A,(0,l.Wm)(E,{onCloseDialogue:t[1]||(t[1]=e=>o.dialogue=!1),inProfile:!1,seamless:"",position:"right",modelValue:o.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dialogue=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(Q,{onCloseDialogue:t[0]||(t[0]=e=>o.dialogue=!1),currentUser:a.currentUser,body:o.body,id:o.id,actionType:"Edit"},null,8,["currentUser","body","id"])])),_:1},8,["modelValue"])])}a(7098),a(17070);var L=a(93617);const V=(0,l._)("br",null,null,-1),Y={key:4,class:"flex col-12"},M={key:0,class:"text-red"},C={key:1,class:"text-red"},Z={key:2,class:"text-red"},N={key:5,class:"flex col-12"},Q={key:0,class:"text-red"},E={key:1,class:"text-red"},P={key:2,class:"text-red"},R={key:6,class:"q-gutter-xs"},F={class:"row items-center justify-end"},I={class:"row items-center justify-end"};function S(e,t,a,s,o,r){const i=(0,l.up)("q-toolbar-title"),d=(0,l.up)("q-btn"),m=(0,l.up)("q-toolbar"),u=(0,l.up)("q-select"),p=(0,l.up)("q-checkbox"),c=(0,l.up)("q-input"),y=(0,l.up)("q-date"),v=(0,l.up)("q-time"),g=(0,l.up)("q-popup-proxy"),w=(0,l.up)("q-icon"),f=(0,l.up)("q-card-section"),h=(0,l.up)("q-card"),b=(0,l.up)("q-layout"),k=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(b,{style:{width:"500px !important"}},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{style:{"max-width":"500px","min-height":"100vh"},flat:"",square:""},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{class:"q-pa-md bg-grey-3",style:{position:"sticky !important",top:"0","z-index":"15",height:"63px !important"}},{default:(0,l.w5)((()=>[(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(a.actionType)+" Leave ",1)])),_:1}),(0,l.wy)((0,l.Wm)(d,{icon:"close",flat:"",round:"",dense:""},null,512),[[k]])])),_:1}),(0,l.Wm)(f,{class:"q-gutter-sm scroll"},{default:(0,l.w5)((()=>{var e,s,i,n,m,f,h;return[V,(0,l.Wm)(u,{modelValue:o.leaveType,"onUpdate:modelValue":[t[0]||(t[0]=e=>o.leaveType=e),t[1]||(t[1]=e=>r.setRemainingDays({from:o.credentials.from,to:o.credentials.to}))],ref:"leaveTypeRef","no-caps":"",label:"Leave Type",loading:o.leaveTypeLoading,outlined:"",options:o.leaveTypeOptions,"lazy-rules":"",rules:[e=>e&&e.id||"Please type the Leave Type"]},null,8,["modelValue","loading","options","rules"]),null!==(e=a.currentUser)&&void 0!==e&&e.myEmployeeProfile.hrMember?((0,l.wg)(),(0,l.j4)(p,{key:0,ref:"forMeRef",outlined:"","onUpdate:modelValue":[r.trigchkbxfrme,t[2]||(t[2]=e=>o.forMe=e)],modelValue:o.forMe,label:"My leave (Leave Request for my self)"},null,8,["onUpdate:modelValue","modelValue"])):(0,l.kq)("",!0),null!==(s=a.currentUser)&&void 0!==s&&s.myEmployeeProfile.hrMember?((0,l.wg)(),(0,l.j4)(u,{key:1,modelValue:o.employee,"onUpdate:modelValue":[t[3]||(t[3]=e=>o.employee=e),r.setCurrentBalance],disable:a.currentUser.myEmployeeProfile&&o.forMe,"no-caps":"",label:"Employee",loading:o.employeeLoading,outlined:"",clearable:"",options:o.employeeOptions},null,8,["modelValue","disable","onUpdate:modelValue","loading","options"])):(0,l.kq)("",!0),(0,l.Wm)(c,{outlined:"",disable:"",type:"number",modelValue:o.currentBalance,"onUpdate:modelValue":t[4]||(t[4]=e=>o.currentBalance=e),modelModifiers:{number:!0},label:"Current Balance"},null,8,["modelValue"]),"hours"===(null===(i=o.leaveType)||void 0===i?void 0:i.durationType)?((0,l.wg)(),(0,l.j4)(c,{key:2,outlined:"",disable:"",modelValue:o.remainBalanceHours,"onUpdate:modelValue":t[5]||(t[5]=e=>o.remainBalanceHours=e),label:"Remain Balance"},null,8,["modelValue"])):(0,l.kq)("",!0),"days"===(null===(n=o.leaveType)||void 0===n?void 0:n.durationType)?((0,l.wg)(),(0,l.j4)(c,{key:3,outlined:"",disable:"",type:"number",modelValue:o.remainBalance,"onUpdate:modelValue":t[6]||(t[6]=e=>o.remainBalance=e),label:"Remain Balance"},null,8,["modelValue"])):(0,l.kq)("",!0),"days"===(null===(m=o.leaveType)||void 0===m?void 0:m.durationType)?((0,l.wg)(),(0,l.iD)("div",Y,[(0,l.Wm)(y,{subtitle:"Pick Duration",mask:"YYYY-MM-DD",class:"col-12",disable:null==o.leaveType,"onUpdate:modelValue":[r.setRemainingDays,t[7]||(t[7]=e=>o.fromto=e)],modelValue:o.fromto,"emit-immediately":"",ref:"fromToRef",range:"","lazy-rules":"",rules:[e=>e||(null===e||void 0===e?void 0:e.from)||"Please type the Employee"]},{default:(0,l.w5)((()=>[o.fromtToToggle?((0,l.wg)(),(0,l.iD)("div",M,"* pick a date")):(0,l.kq)("",!0),o.fromtToDaysExceedToggle?((0,l.wg)(),(0,l.iD)("div",C,"* Days exceeded the balance limit")):(0,l.kq)("",!0),o.fromtToleavetypeDaysExceedToggle?((0,l.wg)(),(0,l.iD)("div",Z,"* Days exceeded the Leave Type limit")):(0,l.kq)("",!0)])),_:1},8,["disable","onUpdate:modelValue","modelValue","rules"])])):(0,l.kq)("",!0),"hours"===(null===(f=o.leaveType)||void 0===f?void 0:f.durationType)?((0,l.wg)(),(0,l.iD)("div",N,[(0,l.Wm)(y,{subtitle:"Pick Duration",mask:"YYYY-MM-DD",class:"my-2 col-12",disable:null==o.leaveType,"onUpdate:modelValue":[r.setdatetimeDate,t[8]||(t[8]=e=>o.datetimeDate=e)],modelValue:o.datetimeDate,"emit-immediately":"",ref:"fromToRef","lazy-rules":"",rules:[e=>e||"Please type the Employee"]},{default:(0,l.w5)((()=>[o.fromtToToggle?((0,l.wg)(),(0,l.iD)("div",Q,"* pick a date")):(0,l.kq)("",!0),o.fromtToDaysExceedToggle?((0,l.wg)(),(0,l.iD)("div",E,"* Days exceeded the balance limit")):(0,l.kq)("",!0),o.fromtToleavetypeDaysExceedToggle?((0,l.wg)(),(0,l.iD)("div",P,"* Days exceeded the Leave Type limit")):(0,l.kq)("",!0)])),_:1},8,["disable","onUpdate:modelValue","modelValue","rules"])])):(0,l.kq)("",!0),"hours"===(null===(h=o.leaveType)||void 0===h?void 0:h.durationType)?((0,l.wg)(),(0,l.iD)("div",R,[(0,l.Wm)(c,{class:"col-6",label:"from:",rules:["time"],"onUpdate:modelValue":[r.setdatetimeFrom,t[10]||(t[10]=e=>o.datetimeFrom=e)],filled:"",modelValue:o.datetimeFrom},{prepend:(0,l.w5)((()=>[(0,l.Wm)(w,{name:"access_time",class:"cursor-pointer"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{"now-btn":"","onUpdate:modelValue":[r.setdatetimeFrom,t[9]||(t[9]=e=>o.datetimeFrom=e)],modelValue:o.datetimeFrom,mask:"HH:mm",format24h:""},{default:(0,l.w5)((()=>[(0,l._)("div",F,[(0,l.wy)((0,l.Wm)(d,{label:"Close",color:"primary",flat:""},null,512),[[k]])])])),_:1},8,["onUpdate:modelValue","modelValue"])])),_:1})])),_:1})])),_:1},8,["onUpdate:modelValue","modelValue"]),(0,l.Wm)(c,{class:"col-6",label:"to:",rules:["time"],"onUpdate:modelValue":[r.setdatetimeTo,t[12]||(t[12]=e=>o.datetimeTo=e)],filled:"",modelValue:o.datetimeTo},{prepend:(0,l.w5)((()=>[(0,l.Wm)(w,{name:"access_time",class:"cursor-pointer"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{"now-btn":"","onUpdate:modelValue":[r.setdatetimeTo,t[11]||(t[11]=e=>o.datetimeTo=e)],modelValue:o.datetimeTo,mask:"HH:mm",format24h:""},{default:(0,l.w5)((()=>[(0,l._)("div",I,[(0,l.wy)((0,l.Wm)(d,{label:"Close",color:"primary",flat:""},null,512),[[k]])])])),_:1},8,["onUpdate:modelValue","modelValue"])])),_:1})])),_:1})])),_:1},8,["onUpdate:modelValue","modelValue"])])):(0,l.kq)("",!0),(0,l.Wm)(c,{ref:"descriptionRef",outlined:"",modelValue:o.credentials.description,"onUpdate:modelValue":t[13]||(t[13]=e=>o.credentials.description=e),label:"Remark"},null,8,["modelValue"])]})),_:1})])),_:1}),(0,l.Wm)(m,{class:"bg-grey-3 submitBtnClass",style:{position:"sticky !important",bottom:"0","z-index":"5"}},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{loading:o.loading,onClick:r.submit,class:"full-width",color:"primary",label:"Submit","no-caps":""},null,8,["loading","onClick"])])),_:1})])),_:1})}a(10071);var $=a(61959),H=a(49549),O=a(11488),J=a(94789);const K={components:{VueTelInput:H.VueTelInput,Datepicker:J.Z},props:["currentUser","actionType","body"],data(){return{show:!0,fromto:(0,$.iH)({from:null,to:null}),id:null,fromtToDaysExceedToggle:!1,datetimeDate:(0,$.iH)(O().format("YYYY-MM-DD")),datetimeFrom:(0,$.iH)(O().format("HH:mm")),datetimeTo:(0,$.iH)(O().format("HH:mm")),fromtToleavetypeDaysExceedToggle:!1,loading:!1,fromtToToggle:!1,leaveTypeDuration:"days",leaveTypeOptions:[],employeeOptions:[],employee:null,currentBalance:0,forMe:!0,leaveType:null,leaveTypeLoading:!1,employeeLoading:!1,remainBalance:(0,$.iH)(0),remainBalanceHours:"",credentials:{description:null,from:null,to:null,currentBalance:0,employeeId:null,leaveTypeId:null}}},computed:{...(0,L.rn)("hrmStore",["allEmployees","leaveTypes"])},methods:{...(0,L.nv)("hrmStore",["createLeave","updateLeave","getLeaves","getEmployees","getLeaveTypes"]),trigchkbxfrme(e){this.employee=null,!1===e&&(this.currentBalance=0,this.remainBalance=0),!0===e&&this.currentUser.myEmployeeProfile&&(this.currentBalance=Number(this.currentUser.myEmployeeProfile.leaveBalance),this.remainBalance=Number(this.currentBalance),this.setRemainingDays({from:this.credentials.from,to:this.credentials.to}))},toggleShow(){this.show=!this.show},setdatetimeDate(e){let t=`${e} ${this.datetimeFrom}`,a=`${e} ${this.datetimeTo}`;this.fromto={from:t,to:a},this.setRemainingDays({from:t,to:a})},setdatetimeTo(e){let t=`${this.datetimeDate} ${this.datetimeFrom}`,a=`${this.datetimeDate} ${e}`;this.fromto={from:t,to:a},this.setRemainingDays({from:t,to:a})},setdatetimeFrom(e){let t=`${this.datetimeDate} ${e}`,a=`${this.datetimeDate} ${this.datetimeTo}`;this.fromto={from:t,to:a},this.setRemainingDays({from:t,to:a})},setCurrentBalance(e){let t=this.currentBalance-this.remainBalance;this.currentBalance=Number(null===e||void 0===e?void 0:e.leaveBalance),this.remainBalance=Number((null===e||void 0===e?void 0:e.leaveBalance)-t),this.setRemainingDays({from:this.credentials.from,to:this.credentials.to})},setRemainingDays(e){var t,a;if(null===e&&(e={}),console.log("typeof: ",typeof e,e,"leavetype: ",this.leaveType.durationType),"object"===typeof e&&!Object.values(e).includes(null)&&Object.keys(e).includes("from")){var l,s;let t=null===(l=e)||void 0===l?void 0:l.from,a=null===(s=e)||void 0===s?void 0:s.to;"hours"===this.leaveType.durationType?this.remainBalance=Number(new Date(a)/864e5)-Number(new Date(t))/864e5:this.remainBalance=Number(new Date(a)/864e5)-Number(new Date(t))/864e5+1,console.log("remaining balance in above: ",this.remainBalance),this.remainBalance=Number(this.currentBalance-this.remainBalance),this.credentials.from=e.from,this.credentials.to=e.to}else"string"===typeof e&&""!==e?(console.log("remaining balance in ----: ",this.currentBalance),this.credentials.from=e,this.credentials.to=e,"hours"===this.leaveType.durationType?this.remainBalance=0:this.remainBalance=1,this.remainBalance=this.currentBalance-this.remainBalance):(this.credentials.from=null,this.credentials.to=null);if(console.log("this remaining balance",this.remainBalance),this.remainBalanceHours=this.currentBalance,"number"===typeof this.remainBalance){var o;let e=this.remainBalance.toFixed(2),t=null===(o=`${e}`)||void 0===o?void 0:o.split("."),a=Number(t[0]),l=(24*(e-a)).toFixed(0);console.log("remaininghours: ",l,a,e),this.remainBalanceHours=a+" Days "+l+" Hours"}this.fromtToleavetypeDaysExceedToggle=Number(this.currentBalance)-Number(this.remainBalance)>Number(null===(t=this.leaveType)||void 0===t?void 0:t.days),this.fromtToDaysExceedToggle=Number(this.remainBalance)<0&&1!=(null===(a=this.leaveType)||void 0===a?void 0:a.urgent),this.fromtToToggle=!0===(null===this.credentials.from||null===this.credentials.to)},async submit(){var e,t,a,l,s,o;(null!==this.credentials.from&&null!==this.credentials.to||(this.fromtToToggle=!0),Number(this.currentBalance)-Number(this.remainBalance)>Number(this.leaveType.days)&&(this.fromtToleavetypeDaysExceedToggle=!0),Number(this.remainBalance)<0&&1!=(null===(e=this.leaveType)||void 0===e?void 0:e.urgent)&&(this.fromtToDaysExceedToggle=!0),this.$refs.leaveTypeRef.validate(),null!==(t=this.currentUser)&&void 0!==t&&t.myEmployeeProfile)||(this.$refs.employeeRef.validate(),this.forMe&&(this.credentials.employeeId=Number(null===(o=this.currentUser.myEmployeeProfile)||void 0===o?void 0:o.id)));if(!(null!==(a=this.$refs.leaveTypeRef)&&void 0!==a&&a.hasError||null===this.credentials.from||null===this.credentials.to||!this.forMe&&null!==(l=this.$refs.employeeRef)&&void 0!==l&&l.hasError||Number(this.currentBalance)-Number(this.remainBalance)>Number(this.leaveType.days)||Number(this.remainBalance)<0&&1==!(null!==(s=this.leaveType)&&void 0!==s&&s.urgent))){var r;this.loading=!0;let e={description:this.credentials.description,from:this.credentials.from,to:this.credentials.to,leaveTypeId:Number(null===(r=this.leaveType)||void 0===r?void 0:r.id)};var i;if(!this.forMe)e["employeeId"]=Number(null===(i=this.employee)||void 0===i?void 0:i.id);if("Add"===this.actionType){this.leaveType&&(e["leaveTypeId"]=Number(this.leaveType.id)),this.employee&&(this.currentUser.myEmployeeProfile||(e["employeeId"]=Number(this.employee.id)));let t=this;try{await this.createLeave(e),t.$q.notify({type:"positive",message:"Department created",color:"positive",position:"top",timeout:"500"})}catch(n){t.$q.notify({type:"negative",message:"Something went wrong while requesting Leave!",color:"negative",position:"top",timeout:"500"})}finally{this.loading=!1,this.$emit("closeDialogue")}}else e["id"]=Number(this.id),await this.updateLeave(e),this.getLeaves(),selfout.$q.notify({type:"positive",message:"Department updated",color:"positive",position:"top",timeout:"500"})}},getValuesFromApiAsync(e){return new Promise((async t=>{t(await e)}))}},async mounted(){if("Add"===this.actionType){var e;if(this.employee={label:this.currentUser.myEmployeeProfile.name,id:this.currentUser.myEmployeeProfile.id,leaveBalance:this.currentUser.myEmployeeProfile.leaveBalance},this.currentUser.myEmployeeProfile)this.currentBalance=Number(null===(e=this.currentUser.myEmployeeProfile)||void 0===e?void 0:e.leaveBalance),this.remainBalance=this.currentBalance;this.leaveTypeLoading=!0,this.getValuesFromApiAsync(this.getLeaveTypes()).then((()=>{for(let e of this.leaveTypes)this.leaveTypeOptions.push({label:`${e.name} - ${Number(e.days)} ${e.durationType}${e.urgent?" - Urgent":""}`,id:e.id,days:e.days,urgent:e.urgent,durationType:e.durationType});this.leaveTypeLoading=!1})),this.employeeLoading=!0,this.getValuesFromApiAsync(this.getEmployees()).then((()=>{for(let e of this.allEmployees)this.employeeOptions.push({label:e.name,id:e.id,leaveBalance:e.leaveBalance});this.employeeLoading=!1}))}if("Edit"===this.actionType){this.id=this.body.id,this.credentials.description=this.body.description;let e=O(this.body.from).format("YYYY-MM-DD").toString(),l=O(this.body.to).format("YYYY-MM-DD").toString();var t,a;if(this.fromto={from:O(this.body.from).format("YYYY-MM-DD"),to:O(this.body.to).format("YYYY-MM-DD").toString()},e===l&&(this.fromto=O(this.body.from).format("YYYY-MM-DD")),this.credentials.from=this.body.from,this.credentials.to=this.body.to,this.credentials.currentBalance=this.body.currentBalance,this.credentials.remainBalance=this.body.remainBalance,this.leaveTypeLoading=!0,this.getValuesFromApiAsync(this.getLeaveTypes()).then((()=>{for(let t of this.leaveTypes)this.leaveTypeOptions.push({label:`${t.name} - ${Number(t.days)} ${t.durationType}${t.urgent?" - Urgent":""}`,id:t.id,days:t.days,urgent:t.urgent,durationType:t.durationType});var e;(this.leaveType={label:`${this.body.leaveType.name} - ${Number(this.body.leaveType.days)} ${leaveType.durationType}${this.body.leaveType.urgent?" - Urgent":""}`,id:this.body.leaveType.id,days:this.body.leaveType.days,urgent:this.body.leaveType.urgent,durationType:leaveType.durationType},this.leaveTypeLoading=!1,this.employee={label:this.currentUser.myEmployeeProfile.name,id:this.currentUser.myEmployeeProfile.id,leaveBalance:this.currentUser.myEmployeeProfile.leaveBalance},this.currentUser.myEmployeeProfile)&&(this.currentBalance=Number(null===(e=this.currentUser.myEmployeeProfile)||void 0===e?void 0:e.leaveBalance),this.remainBalance=this.currentBalance,this.setRemainingDays(this.fromto))})),this.currentUser.myEmployeeProfile)this.employee={label:null===(t=this.currentUser.myEmployeeProfile)||void 0===t?void 0:t.name,id:null===(a=this.currentUser.myEmployeeProfile)||void 0===a?void 0:a.id};else this.employeeLoading=!0,this.getValuesFromApiAsync(this.getEmployees()).then((()=>{var e,t,a,l;for(let s of this.allEmployees)this.employeeOptions.push({label:s.name,id:s.id,leaveBalance:s.leaveBalance});this.employee={label:null===(e=this.body.employee)||void 0===e?void 0:e.name,id:null===(t=this.body.employee)||void 0===t?void 0:t.id,leaveBalance:null===(a=this.body.employee)||void 0===a?void 0:a.leaveBalance},this.currentBalance=null===(l=this.body.employee)||void 0===l?void 0:l.leaveBalance,this.employeeLoading=!1}))}console.log("leavetpye----",this.employee)}};var G=a(19214),X=a(10151),ee=a(39570),te=a(13747),ae=a(2165),le=a(25589),se=a(63314),oe=a(66271),re=a(64689),ie=a(85626),ne=a(24554),de=a(83944),me=a(35990),ue=a(60677),pe=a(7518),ce=a.n(pe);K.render=S;const ye=K;ce()(K,"components",{QLayout:G.Z,QCard:X.Z,QToolbar:ee.Z,QToolbarTitle:te.Z,QBtn:ae.Z,QCardSection:le.Z,QSelect:se.Z,QCheckbox:oe.Z,QInput:re.Z,QDate:ie.Z,QIcon:ne.Z,QPopupProxy:de.Z,QTime:me.Z}),ce()(K,"directives",{ClosePopup:ue.Z});var ve=a(25616);const ge={computed:{...(0,L.rn)("hrmStore",["leaves"]),data(){let e=JSON.parse(JSON.stringify(this.leaves)).sort(((e,t)=>t["id"]-e["id"])),t=e.map((e=>{const t={status:"",manager:{name:"HR",hrMember:1,user:{name:"HR",avatar:null}}};if(e.leaveApprovals.some((e=>1===e.manager.hrMember)))return e;{let a=e;return e.leaveApprovals.every((e=>"completed"===e.status))&&(t.status="pending"),e.leaveApprovals.every((e=>"completed"===e.status))&&"completed"===e.status&&(t.status="completed"),a.leaveApprovals=a.leaveApprovals.reverse(),a.leaveApprovals.push(t),a}}));return console.log("leaves: ",t),t}},props:["currentUser"],data(){return{body:null,id:null,dateFunc:ve.ZP,dialogue:!1,loading:!1,columns:[{name:"employeeName",label:"Employee Name",align:"left",sortable:!0,field:"employeeName"},{name:"leaveTypeName",label:"Leave Type",align:"left",sortable:!0,field:"leaveTypeName"},{name:"currentBalance",label:"Previouse Balance",align:"left",sortable:!0,field:"currentBalance"},{name:"remainBalance",label:"Remained Balance",align:"left",sortable:!0,field:"remainBalance"},{name:"from",label:"From",align:"left",sortable:!0,field:"from"},{name:"to",label:"To",align:"left",sortable:!0,field:"to"},{name:"status",label:"Status",align:"left",sortable:!0,field:"status"},{name:"description",label:"Remark",align:"left",sortable:!0,field:"description"},{name:"createdAt",label:"Requested Date",align:"left",sortable:!0,field:"issuedAt"}]}},components:{modal:ye},methods:{...(0,L.nv)("hrmStore",["getLeaves","deleteLeave"]),...(0,L.nv)("example",["getUser"]),editLeave(e){if(!0===this.dialogue)return this.dialogue=!1,void setTimeout((()=>{this.body=e,this.dialogue=!0}),200);this.body=e,this.dialogue=!0},rowColor(e){if(e.rowIndex%2!==0||0!==e.rowIndex)return"background: #fff;"}},async mounted(){this.loading=!0,await this.getLeaves(),this.loading=!1}};var we=a(57678),fe=a(18186),he=a(92414),be=a(83884),ke=a(75096),_e=a(69721),xe=a(20811),Te=a(27011),De=a(83414),je=a(52035),We=a(65869),qe=a(51598),Be=a(46778);ge.render=z;const Ue=ge;ce()(ge,"components",{QTable:we.Z,QTr:fe.Z,QTh:he.Z,QTd:be.Z,QBtn:ae.Z,QAvatar:ke.Z,QBadge:_e.Z,QMenu:xe.Z,QList:Te.Z,QItem:De.Z,QItemSection:je.Z,QIcon:ne.Z,QSeparator:We.Z,QLinearProgress:qe.Z,QDialog:Be.Z}),ce()(ge,"directives",{ClosePopup:ue.Z});const Ae=(0,l._)("h6",{class:"q-pa-md"},"Pending Approval Leaves",-1),ze={class:"q-mr-sm"},Le=["src"],Ve={style:{"font-size":"17px"}},Ye={style:{"font-size":"17px"}},Me={style:{"font-size":"17px"}},Ce={style:{"font-size":"17px"}},Ze={style:{"font-size":"17px"}},Ne={style:{"font-size":"17px"}},Qe=(0,l.Uk)("Rejected"),Ee=(0,l.Uk)("Completed"),Pe=(0,l.Uk)("Pending"),Re={style:{"font-size":"17px"}},Fe={style:{"font-size":"17px"}},Ie={key:0,class:"row",style:{"min-width":"75px"}},Se=(0,l.Uk)("Approve hr "),$e=(0,l.Uk)("Reject hr "),He={key:1,class:"flex align-items-center"},Oe=(0,l.Uk)("Approve "),Je=(0,l.Uk)("Reject "),Ke=(0,l._)("div",{class:"q-mb-sm"},"Approval Stage",-1),Ge={class:"col-12 flex"},Xe={key:0,class:"flex items-center q-mx-md",style:{width:"80px"}},et={class:"text-center justify-center"},tt=["src"],at={key:2},lt={key:3},st=(0,l._)("hr",null,null,-1);function ot(e,t,a,s,o,r){const i=(0,l.up)("q-th"),m=(0,l.up)("q-tr"),u=(0,l.up)("q-btn"),p=(0,l.up)("q-td"),c=(0,l.up)("q-avatar"),y=(0,l.up)("q-badge"),v=(0,l.up)("q-icon"),g=(0,l.up)("q-linear-progress"),w=(0,l.up)("q-table"),f=(0,l.up)("modal"),h=(0,l.up)("q-dialog");return(0,l.wg)(),(0,l.iD)("div",null,[Ae,(0,l.Wm)(w,{rows:r.data,columns:o.columns,"rows-per-page-options":[5,50,100,0],"row-key":"id",loading:o.loading,flat:"",class:"bg-secondary q-pa-md"},{header:(0,l.w5)((e=>[(0,l.Wm)(m,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{"auto-width":""}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.cols,(t=>((0,l.wg)(),(0,l.j4)(i,{key:t.name,props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,l.w5)((t=>[(0,l.Wm)(m,{class:(0,n.C_)(t.rowIndex%2!==0&&"bg-white"),props:t},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{key:"colspan","auto-width":""},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{size:"sm",color:"primary",round:"",dense:"",onClick:e=>t.expand=!t.expand,icon:t.expand?"remove":"add"},null,8,["onClick","icon"])])),_:2},1024),(0,l.Wm)(p,{class:"items-center justify-start",key:"employeeName",props:t},{default:(0,l.w5)((()=>{var e,a,s;return[(0,l._)("span",ze,[null!==(e=t.row.employee)&&void 0!==e&&null!==(a=e.user)&&void 0!==a&&a.avatar?((0,l.wg)(),(0,l.j4)(c,{key:0},{default:(0,l.w5)((()=>{var e,a;return[(0,l._)("img",{src:null===(e=t.row.employee)||void 0===e||null===(a=e.user)||void 0===a?void 0:a.avatar},null,8,Le)]})),_:2},1024)):((0,l.wg)(),(0,l.j4)(c,{key:1,color:"grey","text-color":"white",icon:"person"}))]),(0,l._)("span",Ve,(0,n.zw)(null===(s=t.row.employee)||void 0===s?void 0:s.name),1)]})),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"leaveTypeName",props:t},{default:(0,l.w5)((()=>{var e;return[(0,l._)("p",Ye,(0,n.zw)(null===(e=t.row.leaveType)||void 0===e?void 0:e.name),1)]})),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"currentBalance",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",Me,(0,n.zw)(Number(t.row.currentBalance)),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"remainBalance",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",Ce,(0,n.zw)(Number(t.row.remainBalance)),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"from",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",Ze,(0,n.zw)(o.dateFunc.formatDate(new Date(t.row.from),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"to",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",Ne,(0,n.zw)(o.dateFunc.formatDate(new Date(t.row.to),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"status",props:t},{default:(0,l.w5)((()=>["rejected"===t.row.status?((0,l.wg)(),(0,l.j4)(y,{key:0,rounded:"",class:"q-pa-sm bg-red text-white"},{default:(0,l.w5)((()=>[Qe])),_:1})):"completed"===t.row.status?((0,l.wg)(),(0,l.j4)(y,{key:1,rounded:"",class:"q-pa-sm bg-primary text-white"},{default:(0,l.w5)((()=>[Ee])),_:1})):"pending"===t.row.status?((0,l.wg)(),(0,l.j4)(y,{key:2,rounded:"",class:"q-pa-sm bg-warning text-white"},{default:(0,l.w5)((()=>[Pe])),_:1})):(0,l.kq)("",!0)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"description",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",Re,(0,n.zw)(t.row.description),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"createdAt",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",Fe,(0,n.zw)(o.dateFunc.formatDate(new Date(t.row.createdAt),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"text-right",key:"actions",props:t},{default:(0,l.w5)((()=>{var s,i;return[1===(null===(s=a.currentUser)||void 0===s||null===(i=s.myEmployeeProfile)||void 0===i?void 0:i.hrMember)?((0,l.wg)(),(0,l.iD)("div",Ie,[(0,l.Wm)(u,{class:"col",size:"sm",loading:o.approveLoading===t.row.id,onClick:e=>r.approveLeaveMiddle({id:t.row.id,status:"completed"}),flat:"","no-caps":"",disable:t.row.isRejectCompleted||t.row.leaveApprovals.some((e=>"rejected"===e.status))||"rejected"===t.row.status},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{class:"text-bold",name:"done",color:t.row.isRejectCompleted||t.row.leaveApprovals.some((e=>"rejected"===e.status))||"rejected"===t.row.status?"grey":"primary",size:"xs"},null,8,["color"]),Se])),_:2},1032,["loading","onClick","disable"]),(0,l.Wm)(u,{class:"col",loading:o.rejectLoading===t.row.id,onClick:a=>e.approveLeave({id:t.row.id,status:"rejected"}),size:"sm",flat:"","no-caps":"",disable:t.row.isRejectCompleted||t.row.leaveApprovals.some((e=>"rejected"===e.status))||"rejected"===t.row.status},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{class:"text-bold",name:"close",color:t.row.isRejectCompleted||t.row.leaveApprovals.some((e=>"rejected"===e.status))||"rejected"===t.row.status?"grey":"red",size:"xs"},null,8,["color"]),$e])),_:2},1032,["loading","onClick","disable"])])):((0,l.wg)(),(0,l.iD)("div",He,[(0,l.Wm)(u,{class:"col",loading:o.approveLoading===t.row.id,onClick:e=>r.updateApprovalMiddle({id:t.row.id,status:"completed"}),size:"sm",flat:"","no-caps":"",disable:t.row.isRejectCompleted},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{class:"text-bold",name:"done",color:t.row.isRejectCompleted?"grey":"primary",size:"xs"},null,8,["color"]),Oe])),_:2},1032,["loading","onClick","disable"]),(0,l.Wm)(u,{loading:o.rejectLoading===t.row.id,class:"col",onClick:e=>r.updateApprovalMiddle({id:t.row.id,status:"rejected"}),size:"sm",flat:"","no-caps":"",disable:t.row.isRejectCompleted},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{class:"text-bold",name:"close",color:t.row.isRejectCompleted?"grey":"red",size:"xs"},null,8,["color"]),Je])),_:2},1032,["loading","onClick","disable"])]))]})),_:2},1032,["props"])])),_:2},1032,["class","props"]),(0,l.wy)((0,l.Wm)(m,{class:(0,n.C_)(t.rowIndex%2!==0&&"bg-white")},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{colspan:"100%"},{default:(0,l.w5)((()=>[Ke,(0,l._)("div",Ge,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.row.leaveApprovals,((e,a)=>{var s;return(0,l.wg)(),(0,l.iD)("span",{key:e,class:"flex text-center justify-center"},[0!==a?((0,l.wg)(),(0,l.iD)("span",Xe,[(0,l.Wm)(g,{rounded:"",color:"completed"===e.status?"primary":"grey",size:"3px",value:1},null,8,["color"])])):(0,l.kq)("",!0),(0,l._)("span",et,[null!==(s=e.manager)&&void 0!==s&&s.user.avatar?((0,l.wg)(),(0,l.j4)(c,{key:0,size:"35px"},{default:(0,l.w5)((()=>{var t;return[(0,l._)("img",{src:null===(t=e.manager)||void 0===t?void 0:t.user.avatar},null,8,tt)]})),_:2},1024)):((0,l.wg)(),(0,l.j4)(c,{key:1,size:"35px",color:"grey","text-color":"white",icon:"person"})),(0,l._)("div",null,(0,n.zw)(e.manager.name),1),1===e.manager.hrMember?((0,l.wg)(),(0,l.iD)("span",at,[t.row.leaveApprovals.every((e=>"rejected"!==e.status))&&"rejected"===t.row.status?((0,l.wg)(),(0,l.j4)(y,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{name:"close"})])),_:1})):t.row.leaveApprovals.every((e=>"completed"===e.status))&&"completed"===t.row.status?((0,l.wg)(),(0,l.j4)(y,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{name:"done"})])),_:1})):t.row.leaveApprovals.every((e=>"completed"===e.status))&&"pending"===t.row.status?((0,l.wg)(),(0,l.j4)(y,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{name:"more_horiz"})])),_:1})):((0,l.wg)(),(0,l.j4)(y,{key:3,rounded:"",class:"bg-grey text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{name:"more_horiz"})])),_:1}))])):((0,l.wg)(),(0,l.iD)("span",lt,["rejected"===e.status?((0,l.wg)(),(0,l.j4)(y,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{name:"close"})])),_:1})):(0,l.kq)("",!0),"completed"===e.status?((0,l.wg)(),(0,l.j4)(y,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{name:"done"})])),_:1})):(0,l.kq)("",!0),"pending"===e.status?((0,l.wg)(),(0,l.j4)(y,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{name:"more_horiz"})])),_:1})):(0,l.kq)("",!0),""===e.status?((0,l.wg)(),(0,l.j4)(y,{key:3,rounded:"",class:"bg-warning text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{name:"more_horiz"})])),_:1})):(0,l.kq)("",!0)]))])])})),128))])])),_:2},1024)])),_:2},1032,["class"]),[[d.F8,t.expand]])])),_:1},8,["rows","columns","loading"]),st,(0,l.Wm)(h,{onCloseDialogue:t[1]||(t[1]=e=>o.dialogue=!1),inProfile:!1,seamless:"",position:"right",modelValue:o.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dialogue=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{onCloseDialogue:t[0]||(t[0]=e=>o.dialogue=!1),currentUser:a.currentUser,body:o.body,id:o.id,actionType:"Edit"},null,8,["currentUser","body","id"])])),_:1},8,["modelValue"])])}const rt={computed:{...(0,L.rn)("hrmStore",["leaveApprovals"]),data(){let e=JSON.parse(JSON.stringify(this.leaveApprovals)).sort(((e,t)=>t["id"]-e["id"])),t=e.map((e=>{const t={status:"",manager:{name:"HR",hrMember:1,user:{name:"HR",avatar:null}}};if(e.leaveApprovals.some((e=>1===e.manager.hrMember)))return e;{let a=e;return e.leaveApprovals.every((e=>"completed"===e.status))&&(t.status="pending"),e.leaveApprovals.every((e=>"completed"===e.status))&&"completed"===e.status&&(t.status="completed"),a.leaveApprovals=a.leaveApprovals.reverse(),a.leaveApprovals.push(t),a["isRejectCompleted"]=this.checkInApprovals(a.leaveApprovals),a}}));return console.log("leave approvals: ",t),t}},props:["currentUser"],data(){return{body:null,id:null,approveLoading:null,rejectLoading:null,dateFunc:ve.ZP,dialogue:!1,loading:!1,columns:[{name:"employeeName",label:"Employee Name",align:"left",sortable:!0,field:"employeeName"},{name:"leaveTypeName",label:"Leave Type",align:"left",sortable:!0,field:"leaveTypeName"},{name:"currentBalance",label:"Previouse Balance",align:"left",sortable:!0,field:"currentBalance"},{name:"remainBalance",label:"Remained Balance",align:"left",sortable:!0,field:"remainBalance"},{name:"from",label:"From",align:"left",sortable:!0,field:"from"},{name:"to",label:"To",align:"left",sortable:!0,field:"to"},{name:"status",label:"Status",align:"left",sortable:!0,field:"status"},{name:"description",label:"Remark",align:"left",sortable:!0,field:"description"},{name:"createdAt",label:"Requested Date",align:"left",sortable:!0,field:"issuedAt"},{name:"actions",label:"Actions",align:"right",field:"actions"}]}},components:{modal:ye},methods:{...(0,L.nv)("hrmStore",["getLeaveApprovals","updateApproval","approveLeave"]),...(0,L.nv)("example",["getUser"]),async approveLeaveMiddle(e){"rejected"===e.status&&(this.rejectLoading=e.id,await this.approveLeave(e),this.rejectLoading=null),"completed"===e.status&&(this.approveLoading=e.id,await this.approveLeave(e),this.approveLoading=null)},async updateApprovalMiddle(e){"rejected"===e.status&&(this.rejectLoading=e.id,await this.updateApproval(e),this.rejectLoading=null),"completed"===e.status&&(this.approveLoading=e.id,await this.updateApproval(e),this.approveLoading=null)},checkInApprovals(e){return 1===this.currentUser.myEmployeeProfile.hrMember?e.some((e=>1===e.manager.hrMember&&["completed","rejected"].includes(e.status)))&&e.some((e=>!["pending",""].includes(e.status))):e.some((e=>{var t;return e.managerId===(null===(t=this.currentUser.myEmployeeProfile)||void 0===t?void 0:t.id)&&["completed","rejected"].includes(e.status)}))&&e.some((e=>!["pending",""].includes(e.status)))},rowColor(e){if(e.rowIndex%2!==0||0!==e.rowIndex)return"background: #fff;"}},async mounted(){this.loading=!0,await this.getLeaveApprovals(),this.loading=!1}};rt.render=ot;const it=rt;ce()(rt,"components",{QTable:we.Z,QTr:fe.Z,QTh:he.Z,QTd:be.Z,QBtn:ae.Z,QAvatar:ke.Z,QBadge:_e.Z,QIcon:ne.Z,QLinearProgress:qe.Z,QDialog:Be.Z});const nt=(0,l._)("h6",{class:"q-pa-md"},"My Leaves",-1),dt={style:{"font-size":"17px"}},mt={style:{"font-size":"17px"}},ut={style:{"font-size":"17px"}},pt={style:{"font-size":"17px"}},ct={style:{"font-size":"17px"}},yt=(0,l.Uk)("Rejected"),vt=(0,l.Uk)("Completed"),gt=(0,l.Uk)("Pending"),wt={style:{"font-size":"17px"}},ft={style:{"font-size":"17px"}},ht=(0,l._)("div",{class:"q-mb-sm"},"Approval Stage",-1),bt={class:"col-12 flex"},kt={key:0,class:"flex items-center q-mx-md",style:{width:"80px"}},_t={class:"text-center justify-center"},xt=["src"],Tt={key:2},Dt={key:3},jt=(0,l._)("hr",null,null,-1);function Wt(e,t,a,s,o,r){const i=(0,l.up)("q-th"),m=(0,l.up)("q-tr"),u=(0,l.up)("q-btn"),p=(0,l.up)("q-td"),c=(0,l.up)("q-badge"),y=(0,l.up)("q-icon"),v=(0,l.up)("q-item-section"),g=(0,l.up)("q-item"),w=(0,l.up)("q-separator"),f=(0,l.up)("q-list"),h=(0,l.up)("q-menu"),b=(0,l.up)("q-linear-progress"),k=(0,l.up)("q-avatar"),_=(0,l.up)("q-table"),x=(0,l.up)("modal"),T=(0,l.up)("q-dialog"),D=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)("div",null,[nt,(0,l.Wm)(_,{rows:r.data,columns:o.columns,"rows-per-page-options":[5,50,100,0],"row-key":"id",loading:o.loading,flat:"",class:"bg-secondary q-pa-md"},{header:(0,l.w5)((e=>[(0,l.Wm)(m,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{"auto-width":""}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.cols,(t=>((0,l.wg)(),(0,l.j4)(i,{key:t.name,props:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,l.w5)((t=>[(0,l.Wm)(m,{class:(0,n.C_)(t.rowIndex%2!==0&&"bg-white"),props:t},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{key:"colspan","auto-width":""},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{size:"sm",color:"primary",round:"",dense:"",onClick:e=>t.expand=!t.expand,icon:t.expand?"remove":"add"},null,8,["onClick","icon"])])),_:2},1024),(0,l.Wm)(p,{class:"items-center justify-start",key:"leaveTypeName",props:t},{default:(0,l.w5)((()=>{var e;return[(0,l._)("p",dt,(0,n.zw)(null===(e=t.row.leaveType)||void 0===e?void 0:e.name),1)]})),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"currentBalance",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",mt,(0,n.zw)(Number(t.row.currentBalance)),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"remainBalance",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",ut,(0,n.zw)(Number(t.row.remainBalance)),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"from",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",pt,(0,n.zw)(o.dateFunc.formatDate(new Date(t.row.from),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"to",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",ct,(0,n.zw)(o.dateFunc.formatDate(new Date(t.row.to),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"status",props:t},{default:(0,l.w5)((()=>["rejected"===t.row.status?((0,l.wg)(),(0,l.j4)(c,{key:0,rounded:"",class:"q-pa-sm bg-red text-white"},{default:(0,l.w5)((()=>[yt])),_:1})):"completed"===t.row.status?((0,l.wg)(),(0,l.j4)(c,{key:1,rounded:"",class:"q-pa-sm bg-primary text-white"},{default:(0,l.w5)((()=>[vt])),_:1})):"pending"===t.row.status?((0,l.wg)(),(0,l.j4)(c,{key:2,rounded:"",class:"q-pa-sm bg-warning text-white"},{default:(0,l.w5)((()=>[gt])),_:1})):(0,l.kq)("",!0)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"description",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",wt,(0,n.zw)(t.row.description),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"items-center justify-start",key:"createdAt",props:t},{default:(0,l.w5)((()=>[(0,l._)("p",ft,(0,n.zw)(o.dateFunc.formatDate(new Date(t.row.createdAt),"YYYY-MM-DD")),1)])),_:2},1032,["props"]),(0,l.Wm)(p,{class:"text-right",key:"actions",props:t},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{dense:"",round:"",flat:"",icon:"more_vert"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{"transition-show":"scale","transition-hide":"scale"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{style:{"min-width":"75px"}},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(g,{onClick:a=>e.deleteLeave({id:t.row.id}),style:{},clickable:""},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{class:"flex flex-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{name:"delete",color:"negative",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[D]]),(0,l.Wm)(w),(0,l.wy)((0,l.Wm)(g,{onClick:e=>r.editLeave(t.row),clickable:""},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{class:"flex flex-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{name:"edit",color:"warning",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[D]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["class","props"]),(0,l.wy)((0,l.Wm)(m,{class:(0,n.C_)(t.rowIndex%2!==0&&"bg-white")},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{colspan:"100%"},{default:(0,l.w5)((()=>[ht,(0,l._)("div",bt,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.row.leaveApprovals,((e,a)=>{var s;return(0,l.wg)(),(0,l.iD)("span",{key:e,class:"flex text-center justify-center"},[0!==a?((0,l.wg)(),(0,l.iD)("span",kt,[(0,l.Wm)(b,{rounded:"",color:"completed"===e.status?"primary":"grey",size:"3px",value:1},null,8,["color"])])):(0,l.kq)("",!0),(0,l._)("span",_t,[null!==(s=e.manager)&&void 0!==s&&s.user.avatar?((0,l.wg)(),(0,l.j4)(k,{key:0,size:"35px"},{default:(0,l.w5)((()=>{var t;return[(0,l._)("img",{src:null===(t=e.manager)||void 0===t?void 0:t.user.avatar},null,8,xt)]})),_:2},1024)):((0,l.wg)(),(0,l.j4)(k,{key:1,size:"35px",color:"grey","text-color":"white",icon:"person"})),(0,l._)("div",null,(0,n.zw)(e.manager.name),1),1===e.manager.hrMember?((0,l.wg)(),(0,l.iD)("span",Tt,[t.row.leaveApprovals.every((e=>"rejected"!==e.status))&&"rejected"===t.row.status?((0,l.wg)(),(0,l.j4)(c,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{name:"close"})])),_:1})):t.row.leaveApprovals.every((e=>"completed"===e.status))&&"completed"===t.row.status?((0,l.wg)(),(0,l.j4)(c,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{name:"done"})])),_:1})):t.row.leaveApprovals.every((e=>"completed"===e.status))&&"pending"===t.row.status?((0,l.wg)(),(0,l.j4)(c,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{name:"more_horiz"})])),_:1})):((0,l.wg)(),(0,l.j4)(c,{key:3,rounded:"",class:"bg-grey text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{name:"more_horiz"})])),_:1}))])):((0,l.wg)(),(0,l.iD)("span",Dt,["rejected"===e.status?((0,l.wg)(),(0,l.j4)(c,{key:0,rounded:"",class:"bg-red text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{name:"close"})])),_:1})):(0,l.kq)("",!0),"completed"===e.status?((0,l.wg)(),(0,l.j4)(c,{key:1,rounded:"",class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{name:"done"})])),_:1})):(0,l.kq)("",!0),"pending"===e.status?((0,l.wg)(),(0,l.j4)(c,{key:2,rounded:"",class:"bg-warning text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{name:"more_horiz"})])),_:1})):(0,l.kq)("",!0),""===e.status?((0,l.wg)(),(0,l.j4)(c,{key:3,rounded:"",class:"bg-warning text-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{name:"more_horiz"})])),_:1})):(0,l.kq)("",!0)]))])])})),128))])])),_:2},1024)])),_:2},1032,["class"]),[[d.F8,t.expand]])])),_:1},8,["rows","columns","loading"]),jt,(0,l.Wm)(T,{onCloseDialogue:t[1]||(t[1]=e=>o.dialogue=!1),inProfile:!1,seamless:"",position:"right",modelValue:o.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dialogue=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{onCloseDialogue:t[0]||(t[0]=e=>o.dialogue=!1),currentUser:a.currentUser,body:o.body,id:o.id,actionType:"Edit"},null,8,["currentUser","body","id"])])),_:1},8,["modelValue"])])}const qt={computed:{...(0,L.rn)("hrmStore",["myLeaves"]),data(){const e={status:"",manager:{name:"HR",hrMember:1,user:{name:"HR",avatar:null}}};let t=JSON.parse(JSON.stringify(this.myLeaves)).sort(((e,t)=>t["id"]-e["id"])),a=t.map((t=>{if(t.leaveApprovals.some((e=>1===e.manager.hrMember)))return t;{let a=t;return t.leaveApprovals.every((e=>"completed"===e.status))&&(e.status="pending"),t.leaveApprovals.every((e=>"completed"===e.status))&&"completed"===t.status&&(e.status="completed"),a.leaveApprovals=a.leaveApprovals.reverse(),a.leaveApprovals.push(e),console.log("copy leaves: ",a),a}}));return a}},props:["currentUser"],data(){return{body:null,id:null,dateFunc:ve.ZP,dialogue:!1,loading:!1,columns:[{name:"leaveTypeName",label:"Leave Type",align:"left",sortable:!0,field:"leaveTypeName"},{name:"currentBalance",label:"Previouse Balance",align:"left",sortable:!0,field:"currentBalance"},{name:"remainBalance",label:"Remained Balance",align:"left",sortable:!0,field:"remainBalance"},{name:"from",label:"From",align:"left",sortable:!0,field:"from"},{name:"to",label:"To",align:"left",sortable:!0,field:"to"},{name:"status",label:"Status",align:"left",sortable:!0,field:"status"},{name:"description",label:"Remark",align:"left",sortable:!0,field:"description"},{name:"createdAt",label:"Requested Date",align:"left",sortable:!0,field:"issuedAt"},{name:"actions",label:"Actions",align:"right",field:"actions"}]}},components:{modal:ye},methods:{...(0,L.nv)("hrmStore",["getMyLeaves","deleteLeave"]),...(0,L.nv)("example",["getUser"]),editLeave(e){if(!0===this.dialogue)return this.dialogue=!1,void setTimeout((()=>{this.body=e,this.dialogue=!0}),200);this.body=e,this.dialogue=!0},rowColor(e){if(e.rowIndex%2!==0||0!==e.rowIndex)return"background: #fff;"}},async mounted(){this.loading=!0,await this.getMyLeaves(),this.loading=!1}};qt.render=Wt;const Bt=qt;ce()(qt,"components",{QTable:we.Z,QTr:fe.Z,QTh:he.Z,QTd:be.Z,QBtn:ae.Z,QBadge:_e.Z,QMenu:xe.Z,QList:Te.Z,QItem:De.Z,QItemSection:je.Z,QIcon:ne.Z,QSeparator:We.Z,QLinearProgress:qe.Z,QAvatar:ke.Z,QDialog:Be.Z}),ce()(qt,"directives",{ClosePopup:ue.Z});const Ut={components:{modal:ye,leavesTable:Ue,leaveApprovalsTable:it,myLeavesTable:Bt},computed:{...(0,L.rn)("example",["user"])},data(){return{myLeavesView:!1,leaveApprovalsView:!1,leavesView:!1,dialogue:!1,hrMember:!1}},methods:{...(0,L.nv)("example",["getUser"])},setup(){return{tab:(0,$.iH)("leave")}},async mounted(){var e,t,a,l,s,o,r,i;(await this.getUser(),console.log("user permission: ",this.user.userType,this.user.myEmployeeProfile),"owner"===(null===(e=this.user)||void 0===e?void 0:e.userType)&&(this.leaveApprovalsView=!0,this.leavesView=!0),"admin"===(null===(t=this.user)||void 0===t?void 0:t.userType))&&(null!==(l=this.user)&&void 0!==l&&l.myEmployeeProfile&&1===(null===(s=this.user)||void 0===s?void 0:s.myEmployeeProfile.hrMember)&&(console.log("hrmanager"),this.leaveApprovalsView=!0,this.leavesView=!0),null!==(o=this.user)&&void 0!==o&&o.myEmployeeProfile&&0===(null===(r=this.user)||void 0===r?void 0:r.myEmployeeProfile.hrMember)&&(this.myLeavesView=!0,this.leaveApprovalsView=!0));"agent"===(null===(a=this.user)||void 0===a?void 0:a.userType)&&(console.log("employee"),null!==(i=this.user)&&void 0!==i&&i.myEmployeeProfile&&(this.myLeavesView=!0));console.log("manager",this.myLeavesView,this.leaveApprovalsView,this.leavesView)}};var At=a(24379),zt=a(47704);Ut.render=i;const Lt=Ut;ce()(Ut,"components",{QPage:At.Z,QBtn:ae.Z,QScrollArea:zt.Z,QDialog:Be.Z})}}]);