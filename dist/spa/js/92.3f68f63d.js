"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[92],{5092:(e,a,s)=>{s.r(a),s.d(a,{default:()=>O});var t=s(3673);const l={class:"flex justify-between items-center"},o=(0,t._)("p",{class:"text-h4"},"Users",-1);function n(e,a,s,n,r,i){const u=(0,t.up)("breadcrumps"),d=(0,t.up)("q-btn"),p=(0,t.up)("tbl"),m=(0,t.up)("modal"),c=(0,t.up)("q-dialog"),h=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(h,{class:"q-pa-md"},{default:(0,t.w5)((()=>[(0,t._)("div",l,[(0,t._)("div",null,[o,(0,t.Wm)(u,{map:n.crumps},null,8,["map"])]),(0,t.Wm)(d,{onClick:a[0]||(a[0]=e=>r.dialogue=!0),color:"primary",label:"Create Record",unelevated:"",rounded:"","no-caps":""})]),(0,t.Wm)(p),(0,t.Wm)(c,{seamless:"",position:"right",modelValue:r.dialogue,"onUpdate:modelValue":a[2]||(a[2]=e=>r.dialogue=e),persistent:""},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{onCloseDialogue:a[1]||(a[1]=a=>{e.getUsers(),r.dialogue=!1}),action:"Add"})])),_:1},8,["modelValue"])])),_:1})}var r=s(6303),i=s(2323);const u=["src"];function d(e,a,s,l,o,n){const r=(0,t.up)("q-avatar"),d=(0,t.up)("q-td"),p=(0,t.up)("q-icon"),m=(0,t.up)("q-item-section"),c=(0,t.up)("q-item"),h=(0,t.up)("q-separator"),g=(0,t.up)("q-list"),f=(0,t.up)("q-menu"),w=(0,t.up)("q-btn"),y=(0,t.up)("q-tr"),b=(0,t.up)("q-table"),v=(0,t.up)("modal"),k=(0,t.up)("q-dialog"),W=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(b,{rows:e.users,columns:o.columns,"row-key":"id",loading:o.loading,flat:"",class:"bg-secondary q-mt-lg"},{body:(0,t.w5)((e=>[(0,t.Wm)(y,{class:(0,i.C_)(e.rowIndex%2!==0&&"bg-white"),props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{key:"avatar",props:e},{default:(0,t.w5)((()=>[e.row.avatar?((0,t.wg)(),(0,t.j4)(r,{key:0,size:"30px"},{default:(0,t.w5)((()=>[(0,t._)("img",{src:e.row.avatar},null,8,u)])),_:2},1024)):((0,t.wg)(),(0,t.j4)(r,{key:1,size:"30px","font-size":"20px",color:"grey","text-color":"white",icon:"person"}))])),_:2},1032,["props"]),(0,t.Wm)(d,{key:"name",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.name),1)])),_:2},1032,["props"]),(0,t.Wm)(d,{key:"username",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.username),1)])),_:2},1032,["props"]),(0,t.Wm)(d,{key:"email",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.email),1)])),_:2},1032,["props"]),(0,t.Wm)(d,{key:"phoneNumber",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.phoneNumber),1)])),_:2},1032,["props"]),(0,t.Wm)(d,{key:"userType",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.userType),1)])),_:2},1032,["props"]),(0,t.Wm)(d,{key:"actions",props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{style:{"z-index":"10"},dense:"",round:"",flat:"",icon:"more_vert"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{"transition-show":"scale","transition-hide":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{style:{"min-width":"75px"}},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(c,{onClick:a=>n.delItem(e.row.id),style:{},clickable:""},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{class:"flex flex-center"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{name:"delete",color:"negative",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[W]]),(0,t.Wm)(h),(0,t.wy)((0,t.Wm)(c,{onClick:a=>n.edit(e.row),clickable:""},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{class:"flex flex-center"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{name:"edit",color:"warning",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[W]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["class","props"])])),_:1},8,["rows","columns","loading"]),(0,t.Wm)(k,{seamless:"",position:"right",modelValue:o.dialogue,"onUpdate:modelValue":a[1]||(a[1]=e=>o.dialogue=e),persistent:""},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{body:o.body,action:"Edit",onCloseDialogue:a[0]||(a[0]=a=>{e.getUsers(),o.dialogue=!1})},null,8,["body"])])),_:1},8,["modelValue"])])}var p=s(3617);function m(e,a,s,l,o,n){const r=(0,t.up)("q-toolbar-title"),u=(0,t.up)("q-btn"),d=(0,t.up)("q-toolbar"),p=(0,t.up)("q-input"),m=(0,t.up)("q-btn-toggle"),c=(0,t.up)("vue-tel-input"),h=(0,t.up)("q-card-section"),g=(0,t.up)("q-card"),f=(0,t.up)("q-layout"),w=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(f,{style:{width:"550px !important","overflow-y":"hidden !important"}},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{style:{"max-width":"550px","min-height":"100vh"},flat:"",square:""},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{class:"bg-grey-3",style:{position:"sticky !important",top:"0","z-index":"15"}},{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(s.action+" ")+" User ",1)])),_:1}),(0,t.wy)((0,t.Wm)(u,{icon:"close",flat:"",round:"",dense:""},null,512),[[w]])])),_:1}),(0,t.Wm)(h,{class:"q-gutter-md scroll"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{ref:"nameRef",rules:[e=>e&&0!==e.length||"This field is required"],outlined:"",modelValue:o.user.name,"onUpdate:modelValue":a[0]||(a[0]=e=>o.user.name=e),label:"Name"},null,8,["rules","modelValue"]),(0,t.Wm)(p,{ref:"userNameRef",rules:[e=>e&&0!==e.length||"This field is required"],outlined:"",modelValue:o.user.username,"onUpdate:modelValue":a[1]||(a[1]=e=>o.user.username=e),label:"Username"},null,8,["rules","modelValue"]),(0,t.Wm)(p,{ref:"emailRef",type:"email",rules:[e=>e&&0!==e.length||"This field is required"],outlined:"",modelValue:o.user.email,"onUpdate:modelValue":a[2]||(a[2]=e=>o.user.email=e),label:"E-mail"},null,8,["rules","modelValue"]),"Edit"===s.action?((0,t.wg)(),(0,t.j4)(p,{key:0,ref:"passRef",modelValue:o.user.password,"onUpdate:modelValue":a[3]||(a[3]=e=>o.user.password=e),type:"password",outlined:"",label:"Password",rules:[e=>!e.length||e.length>7||"Password must be at least 8 characters!"]},null,8,["modelValue","rules"])):(0,t.kq)("",!0),"Add"===s.action?((0,t.wg)(),(0,t.j4)(p,{key:1,ref:"passRef",modelValue:o.user.password,"onUpdate:modelValue":a[4]||(a[4]=e=>o.user.password=e),type:"password",outlined:"",label:"Password",rules:[e=>e&&e.length>7||"Password must be at least 8 characters!"]},null,8,["modelValue","rules"])):(0,t.kq)("",!0),(0,t.Wm)(m,{modelValue:o.user.userType,"onUpdate:modelValue":a[5]||(a[5]=e=>o.user.userType=e),class:"my-custom-toggle","no-caps":"",rounded:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Owner",value:"owner"},{label:"Admin",value:"admin"},{label:"Agent",value:"agent"}]},null,8,["modelValue"]),(0,t.Wm)(c,{required:"",onCountryChanged:n.countryChange,class:"phone-input q-mt-lg",defaultCountry:"iq",customValidate:!1,onOnInput:n.valid,onInput:n.phoneValidate,modelValue:o.phone,"onUpdate:modelValue":a[6]||(a[6]=e=>o.phone=e)},null,8,["onCountryChanged","onOnInput","onInput","modelValue"])])),_:1})])),_:1}),(0,t.Wm)(d,{class:"bg-grey-3",style:{position:"sticky !important",bottom:"0","z-index":"5"}},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{loading:o.loading,onClick:n.submit,label:"Submit","no-caps":"",type:"reset",color:"primary",unelevated:"",class:"full-width"},null,8,["loading","onClick"])])),_:1})])),_:1})}var c=s(9549),h=s(52),g=s.n(h);const f={props:["body","action"],data(){return{id:null,loading:!1,phone:"",dialCode:"",user:{name:"",username:"",password:"",email:"",userType:"agent",phoneNumber:""}}},components:{VueTelInput:c.VueTelInput},methods:{...(0,p.nv)("userStore",["getUsers"]),phoneValidate(e){isNaN(Number(e.data))&&(this.phone=this.phone.substring(0,this.phone.length-1))},valid(e,a){a.valid?document.querySelector(".vue-tel-input").removeAttribute("style"):document.querySelector(".vue-tel-input").setAttribute("style","border-color:#cc444b !important;")},countryChange(e){let a=0;this.dialCode="+"+e.dialCode,this.phone=this.phone.substring(this.dialCode.length,this.phone.length),0===a&&this.valid("",{valid:!0}),a+=1},async submit(){if(this.$refs.nameRef.validate(),this.$refs.userNameRef.validate(),this.$refs.emailRef.validate(),!(this.$refs.nameRef.hasError||this.$refs.userNameRef.hasError||this.$refs.emailRef.hasError)){if("Add"===this.action){if(this.user.password.length<8)return void this.$refs.passRef.validate();try{this.loading=!0;let e=await g().post("https://onconnect-backend-api.herokuapp.com/api/v1/users/create",{...this.user,phoneNumber:this.dialCode+this.phone},{headers:{Authorization:localStorage.getItem("accessToken")}});console.log(e),this.loading=!1}catch(e){this.loading=!1,console.log(e.response)}}else{if(""!==this.user.password){if(this.user.password.length<8)return void this.$refs.passRef.validate()}else this.user.password="";this.loading=!0;try{await g().post("https://onconnect-backend-api.herokuapp.com/api/v1/users/update",{name:this.user.name,username:this.user.username,email:this.user.email,userType:this.user.userType,password:""===this.user.password?void 0:this.user.password,phoneNumber:this.dialCode+this.phone,id:this.body.id},{headers:{Authorization:localStorage.getItem("accessToken")}})}catch(e){console.log(e.response)}}this.loading=!1,this.$emit("closeDialogue")}}},mounted(){"Edit"===this.action&&(this.user.name=this.body.name,this.user.username=this.body.username,this.user.email=this.body.email,this.user.userType=this.body.userType,this.phone=this.body.phoneNumber)}};var w=s(9214),y=s(151),b=s(9570),v=s(3747),k=s(2165),W=s(5589),_=s(4689),q=s(201),V=s(677),C=s(7518),U=s.n(C);f.render=m;const T=f;U()(f,"components",{QLayout:w.Z,QCard:y.Z,QToolbar:b.Z,QToolbarTitle:v.Z,QBtn:k.Z,QCardSection:W.Z,QInput:_.Z,QBtnToggle:q.Z}),U()(f,"directives",{ClosePopup:V.Z});const Z={data(){return{loading:!1,action:"",dialogue:!1,body:null,columns:[{name:"avatar",align:"center",label:"#",field:"avatar"},{name:"name",align:"left",label:"Name",field:"name"},{name:"username",label:"Username",align:"left",field:"username"},{name:"email",align:"left",label:"E-mail",field:"email"},{name:"phoneNumber",align:"left",label:"Phone number",field:"phoneNumber"},{name:"userType",align:"left",label:"Type",field:"userType"},{name:"actions",align:"left",label:"Actions",field:"actions"}]}},components:{modal:T},computed:{...(0,p.rn)("userStore",["users"])},methods:{...(0,p.nv)("userStore",["deleteUser","getUsers"]),async delItem(e){await this.deleteUser({id:e})},edit(e){this.body=e,this.dialogue=!0}},async mounted(){await this.getUsers()}};var Q=s(1277),x=s(8186),z=s(3884),I=s(5096),N=s(811),R=s(7011),S=s(3414),A=s(2035),$=s(4554),E=s(5869),P=s(6778);Z.render=d,Z.__scopeId="data-v-5caac114";const j=Z;U()(Z,"components",{QTable:Q.Z,QTr:x.Z,QTd:z.Z,QAvatar:I.Z,QBtn:k.Z,QMenu:N.Z,QList:R.Z,QItem:S.Z,QItemSection:A.Z,QIcon:$.Z,QSeparator:E.Z,QDialog:P.Z}),U()(Z,"directives",{ClosePopup:V.Z});const D={data(){return{dialogue:!1}},components:{breadcrumps:r.Z,tbl:j,modal:T},methods:{...(0,p.nv)("userStore",["getUsers"])},setup(){return{crumps:[{id:1,name:"OneConnect",icon:"home",path:"/"},{id:2,name:"Users",icon:"person",path:"/users"}]}}};var B=s(4379);D.render=n;const O=D;U()(D,"components",{QPage:B.Z,QBtn:k.Z,QDialog:P.Z})}}]);