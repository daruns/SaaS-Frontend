"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[9685],{99685:(e,s,t)=>{t.r(s),t.d(s,{default:()=>B});var a=t(83673);const l={class:"flex justify-between items-center"},o=(0,a._)("p",{class:"text-h4"},"Users",-1);function r(e,s,t,r,n,i){const u=(0,a.up)("breadcrumps"),d=(0,a.up)("q-btn"),p=(0,a.up)("tbl"),m=(0,a.up)("modal"),c=(0,a.up)("q-dialog"),h=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(h,{class:"q-pa-md"},{default:(0,a.w5)((()=>[(0,a._)("div",l,[(0,a._)("div",null,[o,(0,a.Wm)(u,{map:r.crumps},null,8,["map"])]),(0,a.Wm)(d,{onClick:s[0]||(s[0]=e=>n.dialogue=!0),color:"primary",label:"Create Record",unelevated:"",rounded:"","no-caps":""})]),(0,a.Wm)(p),(0,a.Wm)(c,{seamless:"",position:"right",modelValue:n.dialogue,"onUpdate:modelValue":s[2]||(s[2]=e=>n.dialogue=e),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{onCloseDialogue:s[1]||(s[1]=s=>{e.getUsers(),n.dialogue=!1}),action:"Add"})])),_:1},8,["modelValue"])])),_:1})}var n=t(46303),i=t(62323);const u=["src"];function d(e,s,t,l,o,r){const n=(0,a.up)("q-avatar"),d=(0,a.up)("q-td"),p=(0,a.up)("q-icon"),m=(0,a.up)("q-item-section"),c=(0,a.up)("q-item"),h=(0,a.up)("q-separator"),g=(0,a.up)("q-list"),f=(0,a.up)("q-menu"),w=(0,a.up)("q-btn"),y=(0,a.up)("q-tr"),b=(0,a.up)("q-table"),v=(0,a.up)("modal"),W=(0,a.up)("q-dialog"),_=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(b,{rows:r.usersRows,columns:o.columns,"row-key":"id",loading:o.loading,flat:"",class:"bg-secondary q-mt-lg"},{body:(0,a.w5)((e=>[(0,a.Wm)(y,{class:(0,i.C_)(e.rowIndex%2!==0&&"bg-white"),props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{key:"avatar",props:e},{default:(0,a.w5)((()=>[e.row.avatar?((0,a.wg)(),(0,a.j4)(n,{key:0,size:"30px"},{default:(0,a.w5)((()=>[(0,a._)("img",{src:e.row.avatar},null,8,u)])),_:2},1024)):((0,a.wg)(),(0,a.j4)(n,{key:1,size:"30px","font-size":"20px",color:"grey","text-color":"white",icon:"person"}))])),_:2},1032,["props"]),(0,a.Wm)(d,{key:"name",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.row.name),1)])),_:2},1032,["props"]),(0,a.Wm)(d,{key:"username",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.row.username),1)])),_:2},1032,["props"]),(0,a.Wm)(d,{key:"email",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.row.email),1)])),_:2},1032,["props"]),(0,a.Wm)(d,{key:"phoneNumber",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.row.phoneNumber),1)])),_:2},1032,["props"]),(0,a.Wm)(d,{key:"userType",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.row.userType),1)])),_:2},1032,["props"]),(0,a.Wm)(d,{key:"actions",props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{dense:"",round:"",flat:"",icon:"more_vert"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{style:{"min-width":"75px"}},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(c,{onClick:s=>r.delItem(e.row.id),style:{},clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"flex flex-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{name:"delete",color:"negative",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[_]]),(0,a.Wm)(h),(0,a.wy)((0,a.Wm)(c,{onClick:s=>r.edit(e.row),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"flex flex-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{name:"edit",color:"warning",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[_]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["class","props"])])),_:1},8,["rows","columns","loading"]),(0,a.Wm)(W,{seamless:"",position:"right",modelValue:o.dialogue,"onUpdate:modelValue":s[1]||(s[1]=e=>o.dialogue=e),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{body:o.body,action:"Edit",onCloseDialogue:s[0]||(s[0]=s=>{e.getUsers(),o.dialogue=!1})},null,8,["body"])])),_:1},8,["modelValue"])])}t(7098);var p=t(93617);function m(e,s,t,l,o,r){const n=(0,a.up)("q-toolbar-title"),u=(0,a.up)("q-btn"),d=(0,a.up)("q-toolbar"),p=(0,a.up)("q-input"),m=(0,a.up)("q-btn-toggle"),c=(0,a.up)("vue-tel-input"),h=(0,a.up)("q-card-section"),g=(0,a.up)("q-card"),f=(0,a.up)("q-layout"),w=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(f,{style:{width:"550px !important"}},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{style:{"max-width":"550px","min-height":"100vh"},flat:"",square:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"bg-grey-3",style:{position:"sticky !important",top:"0","z-index":"15"}},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.action+" ")+" User ",1)])),_:1}),(0,a.wy)((0,a.Wm)(u,{icon:"close",flat:"",round:"",dense:""},null,512),[[w]])])),_:1}),(0,a.Wm)(h,{class:"q-gutter-md scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{ref:"nameRef",rules:[e=>e&&0!==e.length||"This field is required"],outlined:"",modelValue:o.user.name,"onUpdate:modelValue":s[0]||(s[0]=e=>o.user.name=e),label:"Name"},null,8,["rules","modelValue"]),(0,a.Wm)(p,{ref:"userNameRef",rules:[e=>e&&0!==e.length||"This field is required"],outlined:"",modelValue:o.user.username,"onUpdate:modelValue":s[1]||(s[1]=e=>o.user.username=e),label:"Username"},null,8,["rules","modelValue"]),(0,a.Wm)(p,{ref:"emailRef",type:"email",rules:[e=>e&&0!==e.length||"This field is required"],outlined:"",modelValue:o.user.email,"onUpdate:modelValue":s[2]||(s[2]=e=>o.user.email=e),label:"E-mail"},null,8,["rules","modelValue"]),"Edit"===t.action?((0,a.wg)(),(0,a.j4)(p,{key:0,ref:"passRef",modelValue:o.user.password,"onUpdate:modelValue":s[3]||(s[3]=e=>o.user.password=e),type:"password",outlined:"",label:"Password",rules:[e=>!e.length||e.length>7||"Password must be at least 8 characters!"]},null,8,["modelValue","rules"])):(0,a.kq)("",!0),"Add"===t.action?((0,a.wg)(),(0,a.j4)(p,{key:1,ref:"passRef",modelValue:o.user.password,"onUpdate:modelValue":s[4]||(s[4]=e=>o.user.password=e),type:"password",outlined:"",label:"Password",rules:[e=>e&&e.length>7||"Password must be at least 8 characters!"]},null,8,["modelValue","rules"])):(0,a.kq)("",!0),(0,a.Wm)(m,{modelValue:o.user.userType,"onUpdate:modelValue":s[5]||(s[5]=e=>o.user.userType=e),class:"my-custom-toggle","no-caps":"",rounded:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Owner",value:"owner"},{label:"Admin",value:"admin"},{label:"Agent",value:"agent"}]},null,8,["modelValue"]),(0,a.Wm)(c,{required:"",onCountryChanged:r.countryChange,class:"phone-input q-mt-lg",defaultCountry:"iq",customValidate:!1,onOnInput:r.valid,onInput:r.phoneValidate,modelValue:o.phone,"onUpdate:modelValue":s[6]||(s[6]=e=>o.phone=e)},null,8,["onCountryChanged","onOnInput","onInput","modelValue"])])),_:1})])),_:1}),(0,a.Wm)(d,{class:"bg-grey-3",style:{position:"sticky !important",bottom:"0","z-index":"5"}},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{loading:o.loading,onClick:r.submit,label:"Submit","no-caps":"",type:"reset",color:"primary",unelevated:"",class:"full-width"},null,8,["loading","onClick"])])),_:1})])),_:1})}var c=t(49549),h=t(30052),g=t.n(h);const f={props:["body","action"],data(){return{id:null,loading:!1,phone:"",dialCode:"",user:{name:"",username:"",password:"",email:"",userType:"agent",phoneNumber:""}}},components:{VueTelInput:c.VueTelInput},methods:{...(0,p.nv)("userStore",["getUsers"]),phoneValidate(e){isNaN(Number(e.data))&&(this.phone=this.phone.substring(0,this.phone.length-1))},valid(e,s){s.valid?document.querySelector(".vue-tel-input").removeAttribute("style"):document.querySelector(".vue-tel-input").setAttribute("style","border-color:#cc444b !important;")},countryChange(e){let s=0;this.dialCode="+"+e.dialCode,this.phone=this.phone.substring(this.dialCode.length,this.phone.length),0===s&&this.valid("",{valid:!0}),s+=1},async submit(){if(this.$refs.nameRef.validate(),this.$refs.userNameRef.validate(),this.$refs.emailRef.validate(),!(this.$refs.nameRef.hasError||this.$refs.userNameRef.hasError||this.$refs.emailRef.hasError)){if("Add"===this.action){if(this.user.password.length<8)return void this.$refs.passRef.validate();try{this.loading=!0;let e=await g().post("http://localhost:5050/api/v1/users/create",{...this.user,phoneNumber:this.dialCode+this.phone},{headers:{Authorization:localStorage.getItem("accessToken")}});console.log(e),this.loading=!1}catch(e){this.loading=!1,console.log(e.response)}}else{if(""!==this.user.password){if(this.user.password.length<8)return void this.$refs.passRef.validate()}else this.user.password="";this.loading=!0;try{await g().post("http://localhost:5050/api/v1/users/update",{name:this.user.name,username:this.user.username,email:this.user.email,userType:this.user.userType,password:""===this.user.password?void 0:this.user.password,phoneNumber:this.dialCode+this.phone,id:this.body.id},{headers:{Authorization:localStorage.getItem("accessToken")}})}catch(e){console.log(e.response)}}this.loading=!1,this.$emit("closeDialogue")}}},mounted(){"Edit"===this.action&&(this.user.name=this.body.name,this.user.username=this.body.username,this.user.email=this.body.email,this.user.userType=this.body.userType,this.phone=this.body.phoneNumber)}};var w=t(19214),y=t(10151),b=t(39570),v=t(13747),W=t(2165),_=t(25589),k=t(64689),q=t(30201),V=t(60677),C=t(7518),U=t.n(C);f.render=m;const T=f;U()(f,"components",{QLayout:w.Z,QCard:y.Z,QToolbar:b.Z,QToolbarTitle:v.Z,QBtn:W.Z,QCardSection:_.Z,QInput:k.Z,QBtnToggle:q.Z}),U()(f,"directives",{ClosePopup:V.Z});const Z={data(){return{loading:!1,action:"",dialogue:!1,body:null,columns:[{name:"avatar",align:"center",label:"#",field:"avatar"},{name:"name",align:"left",label:"Name",field:"name"},{name:"username",label:"Username",align:"left",field:"username"},{name:"email",align:"left",label:"E-mail",field:"email"},{name:"phoneNumber",align:"left",label:"Phone number",field:"phoneNumber"},{name:"userType",align:"left",label:"Type",field:"userType"},{name:"actions",align:"left",label:"Actions",field:"actions"}]}},components:{modal:T},computed:{...(0,p.rn)("userStore",["users"]),usersRows(){let e=[];return this.users.forEach((s=>{e.push(JSON.parse(JSON.stringify(s)))})),e.sort(((e,s)=>s["id"]-e["id"]))}},methods:{...(0,p.nv)("userStore",["deleteUser","getUsers"]),async delItem(e){await this.deleteUser({id:e})},edit(e){this.body=e,this.dialogue=!0}},async mounted(){await this.getUsers()}};var Q=t(57678),x=t(18186),N=t(83884),I=t(75096),R=t(20811),z=t(27011),S=t(83414),A=t(52035),E=t(24554),$=t(65869),P=t(46778);Z.render=d,Z.__scopeId="data-v-21c61b3c";const j=Z;U()(Z,"components",{QTable:Q.Z,QTr:x.Z,QTd:N.Z,QAvatar:I.Z,QBtn:W.Z,QMenu:R.Z,QList:z.Z,QItem:S.Z,QItemSection:A.Z,QIcon:E.Z,QSeparator:$.Z,QDialog:P.Z}),U()(Z,"directives",{ClosePopup:V.Z});const D={data(){return{dialogue:!1}},components:{breadcrumps:n.Z,tbl:j,modal:T},methods:{...(0,p.nv)("userStore",["getUsers"])},setup(){return{crumps:[{id:1,name:"OneConnect",icon:"home",path:"/"},{id:2,name:"Users",icon:"person",path:"/users"}]}}};var O=t(24379);D.render=r;const B=D;U()(D,"components",{QPage:O.Z,QBtn:W.Z,QDialog:P.Z})}}]);