"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[4497],{54497:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ae});var n=i(83673);const a={class:"full-width flex justify-between items-center header-height-standard q-px-md",style:{"border-bottom":"1px solid lightgrey"}},l=(0,n._)("div",{class:"text-h4"},"Earnings",-1),o={class:"flex items-center"};function s(e,t,i,s,r,d){const p=(0,n.up)("q-btn"),u=(0,n.up)("earningsTable"),m=(0,n.up)("modal"),y=(0,n.up)("q-dialog"),c=(0,n.up)("q-scroll-area"),g=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(g,{class:"q-py-none q-my-none"},{default:(0,n.w5)((()=>[(0,n._)("div",a,[l,(0,n._)("div",o,[(0,n.Wm)(p,{onClick:t[0]||(t[0]=e=>r.dialogue=!0),color:"primary",label:"Add "+s.tab[0].toUpperCase()+s.tab.substr(1,s.tab.length),unelevated:"",rounded:"","no-caps":""},null,8,["label"])])]),(0,n.Wm)(c,{style:{"max-height":"auto !important","min-height":"auto !important",height:"calc(100vh - 131px)"},class:"q-px-md"},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{currentUser:e.user},null,8,["currentUser"]),(0,n.Wm)(y,{seamless:"",position:"right",modelValue:r.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>r.dialogue=e)},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{onCloseDialogue:t[1]||(t[1]=e=>r.dialogue=!1),type:s.tab,currentUser:e.user,actionType:"Add",id:{}},null,8,["type","currentUser"])])),_:1},8,["modelValue"])])),_:1})])),_:1})}i(90246);var r=i(62323);const d={style:{"font-size":"20px"}},p={style:{"font-size":"20px"}},u={style:{"font-size":"20px"}},m={style:{"font-size":"20px"}},y={style:{"font-size":"20px"}},c={style:{"font-size":"20px"}},g={style:{"font-size":"20px"}};function h(e,t,i,a,l,o){const s=(0,n.up)("q-td"),h=(0,n.up)("q-icon"),f=(0,n.up)("q-item-section"),w=(0,n.up)("q-item"),b=(0,n.up)("q-separator"),T=(0,n.up)("q-list"),v=(0,n.up)("q-menu"),q=(0,n.up)("q-btn"),_=(0,n.up)("q-tr"),W=(0,n.up)("q-table"),V=(0,n.up)("modal"),E=(0,n.up)("q-dialog"),x=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(W,{rows:o.data,columns:l.columns,"row-key":"id",loading:l.loading,"rows-per-page-options":[20,50,100,0],flat:"",class:"bg-secondary q-pa-md"},{body:(0,n.w5)((t=>[(0,n.Wm)(_,{class:(0,r.C_)(t.rowIndex%2!==0&&"bg-white"),props:t},{default:(0,n.w5)((()=>[(0,n.Wm)(s,{class:"items-center justify-start",key:"employee",props:t},{default:(0,n.w5)((()=>{var e;return[(0,n._)("p",d,(0,r.zw)(null===(e=t.row.employee)||void 0===e?void 0:e.name),1)]})),_:2},1032,["props"]),(0,n.Wm)(s,{class:"items-center justify-start",key:"earningType",props:t},{default:(0,n.w5)((()=>{var e;return[(0,n._)("p",p,(0,r.zw)(null===(e=t.row.earningType)||void 0===e?void 0:e.name),1)]})),_:2},1032,["props"]),(0,n.Wm)(s,{class:"items-center justify-start",key:"qty",props:t},{default:(0,n.w5)((()=>[(0,n._)("p",u,(0,r.zw)(t.row.qty),1)])),_:2},1032,["props"]),(0,n.Wm)(s,{class:"items-center justify-start",key:"fund",props:t},{default:(0,n.w5)((()=>{var e;return[(0,n._)("p",m,(0,r.zw)(null===(e=t.row.earningType)||void 0===e?void 0:e.fund),1)]})),_:2},1032,["props"]),(0,n.Wm)(s,{class:"items-center justify-start",key:"total",props:t},{default:(0,n.w5)((()=>[(0,n._)("p",y,(0,r.zw)(t.row.total),1)])),_:2},1032,["props"]),(0,n.Wm)(s,{class:"items-center justify-start",key:"date",props:t},{default:(0,n.w5)((()=>[(0,n._)("p",c,(0,r.zw)(l.dateFunc.formatDate(new Date(t.row.date),"YYYY-MM-DD HH:mm")),1)])),_:2},1032,["props"]),(0,n.Wm)(s,{class:"items-center justify-start",key:"description",props:t},{default:(0,n.w5)((()=>[(0,n._)("p",g,(0,r.zw)(t.row.description),1)])),_:2},1032,["props"]),(0,n.Wm)(s,{class:"text-right",key:"actions",props:t},{default:(0,n.w5)((()=>[(0,n.Wm)(q,{dense:"",round:"",flat:"",icon:"more_vert"},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{"transition-show":"scale","transition-hide":"scale"},{default:(0,n.w5)((()=>[(0,n.Wm)(T,{style:{"min-width":"75px"}},{default:(0,n.w5)((()=>[(0,n.wy)((0,n.Wm)(w,{onClick:i=>e.deleteEarning({id:t.row.id}),style:{},clickable:""},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{class:"flex flex-center"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{name:"delete",color:"negative",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[x]]),(0,n.Wm)(b),(0,n.wy)((0,n.Wm)(w,{onClick:e=>o.editEarning(t.row),clickable:""},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{class:"flex flex-center"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{name:"edit",color:"warning",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[x]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["class","props"])])),_:1},8,["rows","columns","loading"]),(0,n.Wm)(E,{onCloseDialogue:t[1]||(t[1]=e=>l.dialogue=!1),inProfile:!1,seamless:"",position:"right",modelValue:l.dialogue,"onUpdate:modelValue":t[2]||(t[2]=e=>l.dialogue=e)},{default:(0,n.w5)((()=>[(0,n.Wm)(V,{onCloseDialogue:t[0]||(t[0]=e=>l.dialogue=!1),body:l.body,id:l.id,actionType:"Edit"},null,8,["body","id"])])),_:1},8,["modelValue"])])}var f=i(93617);const w=(0,n._)("br",null,null,-1),b={class:"row items-center justify-end"},T={class:"row items-center justify-end"};function v(e,t,i,a,l,o){const s=(0,n.up)("q-toolbar-title"),d=(0,n.up)("q-btn"),p=(0,n.up)("q-toolbar"),u=(0,n.up)("q-select"),m=(0,n.up)("q-input"),y=(0,n.up)("q-date"),c=(0,n.up)("q-popup-proxy"),g=(0,n.up)("q-icon"),h=(0,n.up)("q-time"),f=(0,n.up)("q-card-section"),v=(0,n.up)("q-card"),q=(0,n.up)("q-layout"),_=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.j4)(q,{style:{width:"500px !important"}},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{style:{"max-width":"500px","min-height":"100vh"},flat:"",square:""},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{class:"q-pa-md bg-grey-3",style:{position:"sticky !important",top:"0","z-index":"15",height:"63px !important"}},{default:(0,n.w5)((()=>[(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(i.actionType)+" Earning ",1)])),_:1}),(0,n.wy)((0,n.Wm)(d,{icon:"close",flat:"",round:"",dense:""},null,512),[[_]])])),_:1}),(0,n.Wm)(f,{class:"q-gutter-sm scroll"},{default:(0,n.w5)((()=>[w,(0,n.Wm)(u,{modelValue:l.earningType,"onUpdate:modelValue":[t[0]||(t[0]=e=>l.earningType=e),t[1]||(t[1]=e=>o.updateTotal())],ref:"earningTypeRef","no-caps":"",label:"Earning Type",loading:l.earningTypeLoading,outlined:"",options:l.earningTypeOptions,"lazy-rules":"",rules:[e=>e||"Please Select an Earning Type"]},null,8,["modelValue","loading","options","rules"]),(0,n.Wm)(u,{modelValue:l.employee,"onUpdate:modelValue":t[2]||(t[2]=e=>l.employee=e),"no-caps":"",label:"Employee",ref:"employeeRef",loading:l.employeeLoading,outlined:"",options:l.employeeOptions,"lazy-rules":"",rules:[e=>e||"Please Select an Employee"]},null,8,["modelValue","loading","options","rules"]),(0,n.Wm)(m,{outlined:"",type:"number",ref:"qtyRef",modelValue:l.credentials.qty,"onUpdate:modelValue":[t[3]||(t[3]=e=>l.credentials.qty=e),t[4]||(t[4]=e=>o.updateTotal())],modelModifiers:{number:!0},label:"Quantity"},null,8,["modelValue"]),(0,n.Wm)(m,{outlined:"",readonly:"",modelValue:l.totalValue,"onUpdate:modelValue":t[5]||(t[5]=e=>l.totalValue=e),label:"Total"},null,8,["modelValue"]),(0,n.Wm)(m,{filled:"",modelValue:l.credentials.date,"onUpdate:modelValue":t[8]||(t[8]=e=>l.credentials.date=e),ref:"dateRef",rules:[e=>e.length>0||"Please type the Date"]},{prepend:(0,n.w5)((()=>[(0,n.Wm)(g,{name:"event",class:"cursor-pointer"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{modelValue:l.credentials.date,"onUpdate:modelValue":t[6]||(t[6]=e=>l.credentials.date=e),mask:"YYYY-MM-DD HH:mm"},{default:(0,n.w5)((()=>[(0,n._)("div",b,[(0,n.wy)((0,n.Wm)(d,{label:"Close",color:"primary",flat:""},null,512),[[_]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),append:(0,n.w5)((()=>[(0,n.Wm)(g,{name:"access_time",class:"cursor-pointer"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{modelValue:l.credentials.date,"onUpdate:modelValue":t[7]||(t[7]=e=>l.credentials.date=e),mask:"YYYY-MM-DD HH:mm",format24h:""},{default:(0,n.w5)((()=>[(0,n._)("div",T,[(0,n.wy)((0,n.Wm)(d,{label:"Close",color:"primary",flat:""},null,512),[[_]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","rules"]),(0,n.Wm)(m,{outlined:"",modelValue:l.credentials.description,"onUpdate:modelValue":t[9]||(t[9]=e=>l.credentials.description=e),label:"Decription"},null,8,["modelValue"])])),_:1})])),_:1}),(0,n.Wm)(p,{class:"bg-grey-3 submitBtnClass",style:{position:"sticky !important",bottom:"0","z-index":"5"}},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{loading:l.loading,onClick:o.submit,class:"full-width",color:"primary",label:"Submit","no-caps":""},null,8,["loading","onClick"])])),_:1})])),_:1})}i(10071);var q=i(61959),_=i(49549),W=i(11488),V=i(94789);const E={components:{VueTelInput:_.VueTelInput,Datepicker:V.Z},props:["currentUser","actionType","body"],data(){return{show:!0,id:null,totalValue:(0,q.iH)(0),loading:!1,earningTypeOptions:[],employeeOptions:[],employee:null,earningType:null,earningTypeLoading:!1,employeeLoading:!1,credentials:{qty:0,description:"",date:(0,q.iH)(W().format("YYYY-MM-DD HH:mm")),employeeId:null,earningTypeId:null}}},computed:{...(0,f.rn)("payrollStore",["earningTypes"]),...(0,f.rn)("hrmStore",["allEmployees"])},methods:{...(0,f.nv)("payrollStore",["createEarning","updateEarning","getEarnings","getEarningTypes"]),...(0,f.nv)("hrmStore",["getEmployees"]),toggleShow(){this.show=!this.show},updateTotal(){var e,t,i,n;this.totalValue=Number((null===(e=this.credentials)||void 0===e?void 0:e.qty)||0)*Number((null===(t=this.earningType)||void 0===t?void 0:t.fund)||0),console.log(null===(i=this.credentials)||void 0===i?void 0:i.qty,null===(n=this.earningType)||void 0===n?void 0:n.fund,this.totalValue)},async submit(){var e,t,i;if(this.$refs.earningTypeRef.validate(),this.$refs.employeeRef.validate(),this.$refs.qtyRef.validate(),!(null!==(e=this.$refs.earningTypeRef)&&void 0!==e&&e.hasError||null!==(t=this.$refs.employeeRef)&&void 0!==t&&t.hasError||null!==(i=this.$refs.qtyRef)&&void 0!==i&&i.hasError)){this.loading=!0;let e={};if(this.earningType&&(this.credentials.earningTypeId=Number(this.earningType.id)),this.employee&&(this.credentials.employeeId=Number(this.employee.id)),"Add"===this.actionType){e["description"]=this.credentials.description,e["qty"]=this.credentials.qty,e["date"]=this.credentials.date,e["employeeId"]=this.credentials.employeeId,e["earningTypeId"]=this.credentials.earningTypeId;let t=this;try{console.log(e),await this.createEarning(e),t.$q.notify({type:"positive",message:"Earning created",color:"positive",position:"top",timeout:"500"})}catch(n){t.$q.notify({type:"negative",message:"Something went wrong while requesting Earning!",color:"negative",position:"top",timeout:"500"})}finally{this.loading=!1,this.$emit("closeDialogue")}}else{e["id"]=Number(this.id),this.credentials.earningTypeId&&(e["earningTypeId"]=Number(this.credentials.earningTypeId)),this.credentials.employeeId&&(e["employeeId"]=Number(this.credentials.employeeId)),this.credentials.qty&&(e["qty"]=Number(this.credentials.qty)),this.credentials.date&&(e["date"]=W(this.credentials.date).format("YYYY-MM-DD HH:mm:ss")),this.credentials.description&&(e["description"]=Number(this.credentials.description));try{await this.updateEarning(e),selfout.$q.notify({type:"positive",message:"Earning updated",color:"positive",position:"top",timeout:"500"})}catch(n){selfout.$q.notify({type:"negative",message:"Something went wrong while requesting Earning!",color:"negative",position:"top",timeout:"500"})}finally{this.loading=!1,this.$emit("closeDialogue")}}}},getValuesFromApiAsync(e){return new Promise((async t=>{t(await e)}))}},async mounted(){"Add"===this.actionType&&(this.earningTypeLoading=!0,this.getValuesFromApiAsync(this.getEarningTypes()).then((()=>{for(let e of this.earningTypes)this.earningTypeOptions.push({label:`${e.name} - ${Number(e.rate)} ${e.durationType}`,id:e.id,fund:e.fund,rate:e.rate,durationType:e.durationType});this.earningTypeLoading=!1})),this.employeeLoading=!0,this.getValuesFromApiAsync(this.getEmployees()).then((()=>{for(let e of this.allEmployees)this.employeeOptions.push({label:e.name,id:e.id});this.employeeLoading=!1}))),"Edit"===this.actionType&&(this.id=this.body.id,this.credentials.description=this.body.description,this.credentials.date=W(this.body.date).format("YYYY-MM-DD HH:mm").toString(),this.credentials.qty=Number(this.body.qty),this.totalValue=Number(this.body.total),this.earningTypeLoading=!0,this.getValuesFromApiAsync(this.getEarningTypes()).then((()=>{for(let e of this.earningTypes)this.earningTypeOptions.push({label:`${e.name} - ${Number(e.rate)} ${e.durationType}`,id:e.id,fund:e.fund,rate:e.rate,durationType:e.durationType});this.body.earningType&&(this.earningType={label:`${this.body.earningType.name} - ${Number(this.body.earningType.rate)} ${this.body.earningType.durationType}`,id:this.body.earningType.id,fund:this.body.earningType.fund,rate:this.body.earningType.rate,durationType:this.body.earningType.durationType}),this.earningTypeLoading=!1})),this.employeeLoading=!0,this.getValuesFromApiAsync(this.getEmployees()).then((()=>{var e,t;for(let i of this.allEmployees)this.employeeOptions.push({label:i.name,id:i.id});this.body.employee&&(this.employee={label:null===(e=this.body.employee)||void 0===e?void 0:e.name,id:null===(t=this.body.employee)||void 0===t?void 0:t.id}),this.employeeLoading=!1}))),console.log("earningtpye----",this.employee)}};var x=i(19214),Q=i(10151),Z=i(39570),k=i(13747),D=i(2165),I=i(25589),Y=i(63314),C=i(64689),z=i(24554),$=i(83944),U=i(85626),S=i(35990),A=i(60677),H=i(7518),M=i.n(H);E.render=v;const L=E;M()(E,"components",{QLayout:x.Z,QCard:Q.Z,QToolbar:Z.Z,QToolbarTitle:k.Z,QBtn:D.Z,QCardSection:I.Z,QSelect:Y.Z,QInput:C.Z,QIcon:z.Z,QPopupProxy:$.Z,QDate:U.Z,QTime:S.Z}),M()(E,"directives",{ClosePopup:A.Z});var N=i(25616);const j={computed:{...(0,f.rn)("payrollStore",["earnings"]),data(){return this.earnings}},data(){return{body:null,dateFunc:N.ZP,id:null,dialogue:!1,loading:!1,columns:[{name:"employee",label:"Employee",align:"left",field:"employee"},{name:"earningType",label:"Earning Type",align:"left",field:"earningType"},{name:"qty",label:"Quantity",align:"left",field:"qty"},{name:"fund",label:"Fund",align:"left",field:"fund"},{name:"total",label:"Total",align:"left",field:"total"},{name:"date",label:"Date",align:"left",field:"date"},{name:"description",label:"Description",align:"left",field:"description"},{name:"actions",label:"Actions",align:"right",field:"actions"}]}},components:{modal:L},methods:{...(0,f.nv)("payrollStore",["getEarnings","deleteEarning"]),editEarning(e){if(!0===this.dialogue)return this.dialogue=!1,void setTimeout((()=>{this.body=e,this.dialogue=!0}),200);this.body=e,this.dialogue=!0},rowColor(e){if(e.rowIndex%2!==0||0!==e.rowIndex)return"background: #fff;"}},async mounted(){this.loading=!0,await this.getEarnings(),this.loading=!1}};var P=i(57678),R=i(18186),F=i(83884),O=i(20811),B=i(27011),G=i(83414),J=i(52035),K=i(65869),X=i(46778);j.render=h;const ee=j;M()(j,"components",{QTable:P.Z,QTr:R.Z,QTd:F.Z,QBtn:D.Z,QMenu:O.Z,QList:B.Z,QItem:G.Z,QItemSection:J.Z,QIcon:z.Z,QSeparator:K.Z,QDialog:X.Z}),M()(j,"directives",{ClosePopup:A.Z});const te={components:{modal:L,earningsTable:ee},computed:{...(0,f.rn)("example",["user"])},data(){return{earningsView:!1,dialogue:!1,hrMember:!1}},methods:{...(0,f.nv)("example",["getUser"])},setup(){return{tab:(0,q.iH)("earning")}},async mounted(){await this.getUser()}};var ie=i(24379),ne=i(47704);te.render=s;const ae=te;M()(te,"components",{QPage:ie.Z,QBtn:D.Z,QScrollArea:ne.Z,QDialog:X.Z})}}]);