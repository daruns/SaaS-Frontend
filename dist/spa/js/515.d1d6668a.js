"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[515],{5515:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Ge});var a=s(3673),o=s(3402),l=s.n(o);const n=(0,a._)("img",{alt:"oneconnect logo",src:l(),style:{height:"30px",width:"30px"}},null,-1),m={class:"flex flex-center q-mr-sm"},r=(0,a.Uk)("4"),i=(0,a.Uk)("2"),c=["src"],d=(0,a.Uk)("Settings"),u=(0,a.Uk)("Log out"),g=(0,a.Uk)("CRM"),p=(0,a.Uk)("Invoice"),h=(0,a.Uk)("Quotation"),f=(0,a.Uk)("Tax"),w=(0,a.Uk)("Expense categories"),y=(0,a.Uk)("Suppliers"),_=(0,a.Uk)("Payment"),v=(0,a.Uk)("Expenses"),k=(0,a.Uk)("Accounting"),x=(0,a.Uk)("Projects"),b=(0,a.Uk)("Tasks"),q=(0,a.Uk)("Chat"),W=(0,a.Uk)("Profile"),I=(0,a.Uk)("Users");function S(e,t,s,o,l,S){const U=(0,a.up)("q-btn"),D=(0,a.up)("q-space"),N=(0,a.up)("q-badge"),C=(0,a.up)("q-avatar"),Z=(0,a.up)("q-item-section"),z=(0,a.up)("q-item"),Q=(0,a.up)("q-list"),M=(0,a.up)("q-menu"),T=(0,a.up)("q-toolbar-title"),R=(0,a.up)("q-toolbar"),L=(0,a.up)("q-header"),H=(0,a.up)("q-icon"),E=(0,a.up)("q-expansion-item"),O=(0,a.up)("q-scroll-area"),P=(0,a.up)("q-drawer"),J=(0,a.up)("router-view"),$=(0,a.up)("q-page-container"),j=(0,a.up)("chat"),B=(0,a.up)("q-page-sticky"),A=(0,a.up)("q-layout"),K=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(A,{view:"hHh LpR fFf"},{default:(0,a.w5)((()=>[(0,a.Wm)(L,{class:"bg-primary glossy"},{default:(0,a.w5)((()=>[(0,a.Wm)(R,{class:"bg-primary text-white shadow-2"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{flat:"",onClick:t[0]||(t[0]=e=>o.drawer=!o.drawer),round:"",dense:"",icon:"menu"}),(0,a.Wm)(T,{class:"flex"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{flat:"",round:""},{default:(0,a.w5)((()=>[n])),_:1}),(0,a.Wm)(D),(0,a._)("div",m,[(0,a.Wm)(U,{flat:"",color:"white",round:"",icon:"email",size:"sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{color:"red",rounded:"",floating:""},{default:(0,a.w5)((()=>[r])),_:1})])),_:1}),(0,a.Wm)(U,{flat:"",color:"white",round:"",icon:"notifications",size:"sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{rounded:"",color:"red",floating:""},{default:(0,a.w5)((()=>[i])),_:1})])),_:1})]),(0,a.Wm)(U,{flat:"",round:""},{default:(0,a.w5)((()=>[null!==e.user.avatar?((0,a.wg)(),(0,a.iD)("img",{key:0,alt:"User logo",src:e.user.avatar,style:{height:"30px",width:"30px","border-radius":"50%"}},null,8,c)):((0,a.wg)(),(0,a.j4)(C,{key:1,size:"30px","font-size":"10px",color:"grey","text-color":"white",icon:"person"})),(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Q,null,{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(z,{to:"/profile",clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[d])),_:1})])),_:1},512),[[K]]),(0,a.Wm)(z,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{onClick:S.logout},{default:(0,a.w5)((()=>[u])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(P,{modelValue:o.drawer,"onUpdate:modelValue":t[3]||(t[3]=e=>o.drawer=e),"show-if-above":"",width:200,breakpoint:500,class:"bg-white"},{default:(0,a.w5)((()=>[(0,a.Wm)(O,{style:{height:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(Q,{padding:"",class:"rounded-borders text-black"},{default:(0,a.w5)((()=>[(0,a.Wm)(z,{to:"/crm",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"groups"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[g])),_:1})])),_:1}),(0,a.Wm)(E,{icon:"account_balance",label:"Finance",class:"text-grey",to:"finance"===e.$route.path.split("/")[1]?e.$route.path:void 0,"active-class":"my-menu-link",onClick:t[1]||(t[1]=e=>l.isExpanded=!l.isExpanded),"model-value":l.isExpanded},{default:(0,a.w5)((()=>[(0,a.Wm)(z,{to:"/finance/invoice",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:"q-ml-md",avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"receipt"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[p])),_:1})])),_:1}),(0,a.Wm)(z,{to:"/finance/quotation",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:"q-ml-md",avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"request_quote"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[h])),_:1})])),_:1}),(0,a.Wm)(z,{to:"/finance/taxes",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:"q-ml-md",avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"receipt_long"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[f])),_:1})])),_:1}),(0,a.Wm)(z,{to:"/finance/categories",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:"q-ml-md",avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"category"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[w])),_:1})])),_:1}),(0,a.Wm)(z,{to:"/finance/suppliers",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:"q-ml-md",avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"badge"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[y])),_:1})])),_:1}),(0,a.Wm)(z,{to:"/finance/payment",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:"q-ml-md",avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"payment"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[_])),_:1})])),_:1}),(0,a.Wm)(z,{to:"/finance/expenses",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:"q-ml-md",avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"attach_money"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[v])),_:1})])),_:1})])),_:1},8,["to","model-value"]),(0,a.Wm)(z,{to:"/accounting",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"calculate"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[k])),_:1})])),_:1}),(0,a.Wm)(E,{icon:"work",label:"Projects",class:"text-grey",to:"projects"===e.$route.path.split("/")[1]||"tasks"===e.$route.path.split("/")[1]?e.$route.path:void 0,"active-class":"my-menu-link",onClick:t[2]||(t[2]=e=>l.isExpanded2=!l.isExpanded2),"model-value":l.isExpanded2},{default:(0,a.w5)((()=>[(0,a.Wm)(z,{to:"/projects",exact:"",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:"q-ml-md",avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"work"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[x])),_:1})])),_:1}),(0,a.Wm)(z,{to:"/projects/tasks",exact:"",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:"q-ml-md",avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"task"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[b])),_:1})])),_:1})])),_:1},8,["to","model-value"]),(0,a.Wm)(z,{exact:"",onClick:S.openChat,clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"chat"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[q])),_:1})])),_:1},8,["onClick"]),(0,a.Wm)(z,{to:"/profile",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"account_circle"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[W])),_:1})])),_:1}),(0,a.Wm)(z,{to:"/users",clickable:"",class:"text-grey","active-class":"my-menu-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"person"})])),_:1}),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[I])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)($,{class:"bg-silk"},{default:(0,a.w5)((()=>[(0,a.Wm)(J)])),_:1}),(0,a.Wm)(B,{position:"bottom-right",offset:[18,18]},{default:(0,a.w5)((()=>[(0,a.Wm)(j,{props:l.showChat,onMorph:S.show},null,8,["props","onMorph"])])),_:1})])),_:1})}var U=s(1959),D=s(3617),N=s(2323);const C={class:"relative-position",style:{height:"500px !important","z-index":"20 !important"}},Z={class:"bg-white text-white absolute-bottom-right",style:{width:"300px","border-bottom-right-radius":"2em",height:"500px !important","z-index":"20 !important"}},z={class:"q-mt-xl"},Q={key:0,class:"q-pa-md text-grey"},M={class:(0,N.C_)("q-pa-xs")},T={key:0,class:"flex"},R=["src"],L={class:"flex col"},H={class:"flex"},E={key:0,class:"q-mr-none text-black q-mt-none q-mb-none q-ml-sm"},O={key:1,class:"q-ma-none"},P={key:0,class:"q-ma-none"},J={class:"q-mt-xs q-ml-sm text-grey"},$={key:1,class:"flex"},j=["src"],B={style:{transform:"translateX(-35px) !important"},class:"items-center q-mt-md col"},A={class:"q-mr-none q-mt-none q-mb-none q-ml-sm text-black"},K={class:"q-mt-xs q-ml-sm text-grey"},Y={key:2,class:"flex items-center"},G=["src"],F={class:"flex col"},V={class:"flex q-mt-md"},X={key:0,class:"q-mr-none text-black q-mt-none q-mb-none q-ml-sm"},ee={key:1,class:"q-ma-none"},te={key:0,class:"q-ma-none"},se={class:"q-mt-xs q-ml-sm text-grey"},ae={key:3,class:"flex items-center"},oe=["src"],le={class:"items-center q-mt-md col"},ne={class:"q-mr-none q-mt-none q-mb-none text-black q-ml-sm"},me={class:"q-mt-xs q-ml-sm text-grey"},re={key:4,class:"flex"},ie={class:"flex items-center"},ce={key:0,class:"flex"},de=["src"],ue={class:"items-center q-mt-sm col"},ge={class:"q-mr-none q-mt-none q-mb-none text-black q-ml-sm"},pe={class:"q-mt-xs q-ml-sm text-grey"};function he(e,t,s,o,l,n){const m=(0,a.up)("q-btn"),r=(0,a.up)("q-avatar"),i=(0,a.up)("q-item-label"),c=(0,a.up)("q-item-section"),d=(0,a.up)("q-item"),u=(0,a.up)("q-list"),g=(0,a.up)("conversation"),p=(0,a.up)("q-icon"),h=(0,a.Q2)("morph"),f=(0,a.Q2)("ripple");return(0,a.wg)(),(0,a.iD)("div",C,[(0,a.wy)((0,a.Wm)(m,{class:"absolute-bottom-right",fab:"",color:"primary",size:"lg",icon:"chat",onClick:t[0]||(t[0]=t=>{o.nextMorph(),e.$emit("morph",o.morphGroupModel)}),style:{"z-index":"20 !important"}},null,512),[[h,o.morphGroupModel,"btn:mygroup:500",{resize:!0}]]),(0,a.wy)((0,a._)("div",Z,[(0,a._)("div",z,[l.showList?((0,a.wg)(),(0,a.j4)(u,{key:0,style:{height:"450px !important","overflow-y":"scroll !important","overflow-x":"hidden !important"}},{default:(0,a.w5)((()=>[0===l.rooms.length?((0,a.wg)(),(0,a.iD)("div",Q,"No rooms to show!")):((0,a.wg)(!0),(0,a.iD)(a.HY,{key:1},(0,a.Ko)(l.rooms,((t,s)=>((0,a.wg)(),(0,a.iD)("div",{key:s},[(0,a._)("div",M,[(0,a.wy)((0,a.Wm)(d,{style:{"border-radius":"10px"},class:(0,N.C_)(t.id===e.chat.id?"bg-blue-1":""),onClick:e=>n.getMessages(t,s),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>["channel"!==t.room_type||t.name||t.avatar?!t.avatar&&t.name?((0,a.wg)(),(0,a.iD)("div",$,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.users,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[t<2?((0,a.wg)(),(0,a.iD)("div",{key:0,style:(0,N.j5)(1===t?"transform: translate(-45px,20px) !important;":"transform: translate(10px) !important;"),class:"text-ellipses"},[(0,a.Wm)(r,{class:(0,N.C_)(1===t&&"q-ml-xs"),size:"40px"},{default:(0,a.w5)((()=>[(0,a._)("img",{src:e.avatar?e.avatar:"https://cdn-icons-png.flaticon.com/512/149/149071.png"},null,8,j)])),_:2},1032,["class"])],4)):(0,a.kq)("",!0)])))),128)),(0,a._)("div",B,[(0,a._)("p",A,(0,N.zw)(t.name),1),(0,a._)("p",K,(0,N.zw)(0!==t.messages.length?t.messages[t.messages.length-1].text:"No messages!"),1)])])):"channel"===t.room_type&&t.avatar&&!t.name?((0,a.wg)(),(0,a.iD)("div",Y,[(0,a.Wm)(r,{size:"50px"},{default:(0,a.w5)((()=>[(0,a._)("img",{src:t.avatar},null,8,G)])),_:2},1024),(0,a._)("div",F,[(0,a._)("div",V,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.users,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"flex",key:e.id},[t<2?((0,a.wg)(),(0,a.iD)("p",X,(0,N.zw)(e.name),1)):(0,a.kq)("",!0),t<1?((0,a.wg)(),(0,a.iD)("p",ee,",")):(0,a.kq)("",!0)])))),128)),t.users.length>2?((0,a.wg)(),(0,a.iD)("p",te,"...")):(0,a.kq)("",!0)]),(0,a._)("div",null,[(0,a._)("p",se,(0,N.zw)(0!==t.messages.length?t.messages[t.messages.length-1].text:"No messages!"),1)])])])):"channel"===t.room_type&&t.avatar&&t.name?((0,a.wg)(),(0,a.iD)("div",ae,[(0,a.Wm)(r,{size:"50px"},{default:(0,a.w5)((()=>[(0,a._)("img",{src:t.avatar},null,8,oe)])),_:2},1024),(0,a._)("div",le,[(0,a._)("p",ne,(0,N.zw)(t.name),1),(0,a._)("p",me,(0,N.zw)(0!==t.messages.length?t.messages[t.messages.length-1].text:"No messages!"),1)])])):((0,a.wg)(),(0,a.iD)("div",re,[(0,a._)("div",ie,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.users,(s=>((0,a.wg)(),(0,a.iD)("div",{key:s.id},[s.id!==e.user.id?((0,a.wg)(),(0,a.iD)("div",ce,[(0,a.Wm)(r,{size:"50px"},{default:(0,a.w5)((()=>[(0,a._)("img",{src:s.avatar?s.avatar:"https://cdn-icons-png.flaticon.com/512/149/149071.png"},null,8,de)])),_:2},1024),(0,a._)("div",ue,[(0,a._)("p",ge,(0,N.zw)(s.name),1),(0,a._)("p",pe,(0,N.zw)(0!==t.messages.length?t.messages[t.messages.length-1].text:"No messages!"),1)])])):(0,a.kq)("",!0)])))),128))])])):((0,a.wg)(),(0,a.iD)("div",T,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.users,((e,s)=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[s<2?((0,a.wg)(),(0,a.iD)("div",{key:0,style:(0,N.j5)(1===s&&t.users.length>1?"transform: translate(-45px,20px) !important;":`transform: translate(${t.users.length>1?"10":"0"}px) !important;`),class:"text-ellipses"},[(0,a.Wm)(r,{class:(0,N.C_)(1===s&&"q-ml-xs"),size:t.users.length>1?"40px":"50px"},{default:(0,a.w5)((()=>[(0,a._)("img",{src:e.avatar?e.avatar:"https://cdn-icons-png.flaticon.com/512/149/149071.png"},null,8,R)])),_:2},1032,["class","size"])],4)):(0,a.kq)("",!0)])))),128)),(0,a._)("div",{class:(0,N.C_)([t.users.length>1?"q-mt-md":"q-mt-sm","items-center col"]),style:(0,N.j5)(t.users.length>1&&"transform: translateX(-35px) !important;")},[(0,a._)("div",L,[(0,a._)("div",H,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.users,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"flex",key:e.id},[t<2?((0,a.wg)(),(0,a.iD)("p",E,(0,N.zw)(e.name),1)):(0,a.kq)("",!0),t<1?((0,a.wg)(),(0,a.iD)("p",O,",")):(0,a.kq)("",!0)])))),128)),t.users.length>2?((0,a.wg)(),(0,a.iD)("p",P,"...")):(0,a.kq)("",!0)])]),(0,a._)("p",J,(0,N.zw)(0!==t.messages.length?t.messages[t.messages.length-1].text:"No messages!"),1)],6)]))])),_:2},1024)])),_:2},1024),(0,a.Wm)(c,{side:"",top:""},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,N.zw)(0!==t.messages.length?n.format(t.messages[t.messages.length-1].created_at):""),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"]),[[f]])])])))),128))])),_:1})):((0,a.wg)(),(0,a.j4)(g,{key:1,onHideChat:t[1]||(t[1]=e=>l.showList=!0),popup:!0,bg:"white",hght:"height:400px !important;"}))]),(0,a.Wm)(m,{color:"black",class:"absolute-top-right",style:{"z-index":"20 !important"},icon:"close",round:"",flat:"",onClick:t[2]||(t[2]=t=>{o.nextMorph(),e.$emit("morph",o.morphGroupModel)})}),(0,a.Wm)(p,{class:"absolute-top-left q-ml-sm q-mt-sm",size:"md",name:"question_answer",color:"primary"})],512),[[h,o.morphGroupModel,"card1:mygroup:500",{resize:!0}]])])}s(7070);var fe=s(1082),we=s(1887),ye=s(5824),_e=s(52),ve=s.n(_e);const ke=new WebSocket("wss://oneconnect.it:4000"),xe={btn:"card1",card1:"btn"},be={setup(){const e=(0,U.iH)("btn");return{morphGroupModel:e,nextMorph(){e.value=xe[e.value]}}},data(){return{isLoggedIn:localStorage.getItem("accessToken"),isExpanded:!0,isExpanded2:!0,membToDelete:null,members:[],addMembers:!1,createRoom:!1,channelName:"",channelPhoto:null,changePhoto:!1,options:[],members1:[],options1:[],onlineUsers:[],allUsers:[],rooms:[],roomInfo:null,loading:!1,isLoading:!1,drawer:!1,drawer1:!1,cnfrm:!1,changeName:!1,chatId:null,path:"",showList:!0}},computed:{...(0,D.rn)("example",["user"]),...(0,D.rn)("userStore",["users"]),...(0,D.rn)("chatStore",["chat"]),getHeight(){return"height: 50vh !important;"}},components:{confirm:we.Z,conversation:ye["default"]},methods:{...(0,D.nv)("userStore",["getUsers"]),...(0,D.nv)("example",["getUser"]),...(0,D.nv)("chatStore",["getChat","clearChat"]),async changeChannelName(){let e=this;this.chatId=Number(e.chat.id),ke.send(JSON.stringify({editRoom:{id:Number(e.chat.id),avatar:e.roomInfo.avatar,name:e.channelName}}))},async changeChannelPhoto(){let e=this,t=new FormData;t.append("files",this.channelPhoto);try{let s=await ve().post("https://onconnect-backend-api.herokuapp.com/api/v1/chats/addFiles",t,{headers:{Authorization:localStorage.getItem("accessToken")}});s.data.success?(this.chatId=Number(e.chat.id),ke.send(JSON.stringify({editRoom:{id:Number(e.chat.id),name:e.roomInfo.name,avatar:s.data.data[0].url}}))):this.$q.notify({type:"negative",message:"Something went wrong!"})}catch(s){console.log(s),this.$q.notify({type:"negative",message:"Something went wrong!"})}},addNewMembers(){let e=this,t=[];for(let s=0;s<this.members1.length;s++)t.push(this.members1[s].id);ke.send(JSON.stringify({addRoomUsers:{id:e.chat.id,users:t}})),t=[],this.members1=[],this.addMembers=!1},deleteMemeber(){let e=this;ke.send(JSON.stringify({deleteRoomUsers:{id:e.chat.id,users:[e.membToDelete]}})),this.membToDelete=null,this.cnfrm=!1},checkType(e){return e.filter((e=>e.type.includes("image")))},onRejectedImage(){this.$q.notify({type:"negative",message:"Only images are allowed!"})},async getMessages(e,t){localStorage.setItem("roomIndex",t),this.roomInfo=e,ke.send(JSON.stringify({getMessagesByRoomId:{room_id:e.id}})),this.showList=!1},getMessagesImmediate(){let e=this;ke.send(JSON.stringify({getMessagesByRoomId:{room_id:Number(e.chat.id)}}))},format(e){return fe.ZP.formatDate(e,"HH:mm")},addMembs(){let e=[];for(let t=0;t<this.members.length;t++)e.push(Number(this.members[t].id));ke.send(JSON.stringify({createRoom:{users:e}})),e=[],this.members=[],this.createRoom=!1},updateScroll(){var e=document.getElementById("room-container");e.scrollTop=e.scrollHeight},logout(){localStorage.removeItem("accessToken"),localStorage.removeItem("tab"),localStorage.removeItem("isLoggedIn"),this.$router.push("/login")},getUserOptions(){let e=[];this.options=[],setTimeout((()=>{for(let t=0;t<this.users.length;t++)e.push({id:this.users[t].id,label:this.users[t].name,avatar:this.users[t].avatar})}),100),this.options=e,this.options1=e}},mounted(){this.path=this.$route.path},async beforeMount(){this.isLoading=!0;let e=this;ke.addEventListener("open",(async function(e){ke.send(JSON.stringify({accessToken:localStorage.getItem("accessToken").substring(7,localStorage.getItem("accessToken").length)}))})),ke.addEventListener("message",(async function(t){const s=JSON.parse(t.data);if(console.log(s),"addRoom"===s.reqType&&e.getMessages(s.rooms.rooms[s.rooms.rooms.length-1],0),s.onlineUsers){e.onlineUsers=s.onlineUsers;let t=e.chat.users.filter((({id:e})=>!s.onlineUsers.some((({id:t})=>t===e)))),a=e.chat.users.filter((({id:e})=>s.onlineUsers.some((({id:t})=>t===e))));e.allUsers=[];for(let s=0;s<a.length;s++)e.allUsers.push({...a[s],online:!0});for(let s=0;s<t.length;s++)e.allUsers.push({...t[s],online:!1})}if(s.messagesByRoomId&&e.roomInfo.id===s.messagesByRoomId.room_id&&(await e.getChat({id:e.roomInfo.id,name:e.roomInfo.name,avatar:e.roomInfo.avatar,room_type:e.roomInfo.room_type,users:e.roomInfo.users,messages:s.messagesByRoomId.roomMessages}),e.updateScroll(),ke.send(JSON.stringify({ping:!0}))),s.messagePerRoom)for(let a=0;a<e.rooms.length;a++)e.rooms[a].id===s.messagePerRoom.messfinal.room_id&&(e.rooms[a].messages.push(s.messagePerRoom.messfinal),await e.getMessagesImmediate());if(s.rooms){if(e.rooms=[],e.rooms=JSON.parse(t.data).rooms.rooms.reverse(),0===e.rooms.length)return void await e.clearChat();e.chat&&localStorage.getItem("roomIndex")&&Number(localStorage.getItem("roomIndex"))>=0&&e.rooms.length>=Number(localStorage.getItem("roomIndex"))?(setTimeout((()=>{ke.send(JSON.stringify({getMessagesByRoomId:{room_id:e.rooms[Number(localStorage.getItem("roomIndex"))].id}}))}),100),e.roomInfo=e.rooms[Number(localStorage.getItem("roomIndex"))]):(ke.send(JSON.stringify({getMessagesByRoomId:{room_id:e.rooms[0].id}})),e.roomInfo=e.rooms[0],localStorage.setItem("roomIndex",0))}else s.typing})),await this.getUser(),await this.getUsers(),this.getUserOptions(),this.isLoading=!1,setInterval((()=>{ke.send(JSON.stringify({ping:!0}))}),1e4)}};var qe=s(2165),We=s(7704),Ie=s(7011),Se=s(3414),Ue=s(2035),De=s(2350),Ne=s(5096),Ce=s(4554),Ze=s(9042),ze=s(860),Qe=s(7518),Me=s.n(Qe);be.render=he;const Te=be;Me()(be,"components",{QBtn:qe.Z,QScrollArea:We.Z,QList:Ie.Z,QItem:Se.Z,QItemSection:Ue.Z,QItemLabel:De.Z,QAvatar:Ne.Z,QIcon:Ce.Z}),Me()(be,"directives",{Morph:Ze.Z,Ripple:ze.Z});const Re={data(){return{isLoggedIn:localStorage.getItem("accessToken"),isExpanded:!0,isExpanded2:!0,showChat:!1}},computed:{...(0,D.rn)("example",["user"])},methods:{show(e){"card1"===e&&setTimeout((()=>{this.updateScroll()}),600)},...(0,D.nv)("example",["getUser"]),updateScroll(){var e=document.getElementById("room-container");e.scrollTop=e.scrollHeight},openChat(){window.open("https://www.oneconnect.it/oc_front_end/dist/spa/#/chat")},logout(){localStorage.removeItem("accessToken"),localStorage.removeItem("tab"),localStorage.removeItem("isLoggedIn"),this.$router.push("/login")}},components:{chat:Te},setup(){const e=(0,U.iH)(!1),t=(0,U.iH)(!1),s=(0,U.iH)(0);return{drawer:t,miniState:e,num:s}},async mounted(){await this.getUser()}};var Le=s(9214),He=s(3812),Ee=s(9570),Oe=s(3747),Pe=s(2025),Je=s(9721),$e=s(811),je=s(2901),Be=s(4615),Ae=s(2652),Ke=s(1007),Ye=s(677);Re.render=S;const Ge=Re;Me()(Re,"components",{QLayout:Le.Z,QHeader:He.Z,QToolbar:Ee.Z,QBtn:qe.Z,QToolbarTitle:Oe.Z,QSpace:Pe.Z,QBadge:Je.Z,QAvatar:Ne.Z,QMenu:$e.Z,QList:Ie.Z,QItem:Se.Z,QItemSection:Ue.Z,QDrawer:je.Z,QScrollArea:We.Z,QIcon:Ce.Z,QExpansionItem:Be.Z,QPageContainer:Ae.Z,QPageSticky:Ke.Z}),Me()(Re,"directives",{ClosePopup:Ye.Z})}}]);