"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[876],{3427:(e,t,l)=>{l.r(t),l.d(t,{default:()=>_e});l(246);var a=l(3673),s=l(2323),i=l(8880),o=l(3402),r=l.n(o);const d=e=>((0,a.dD)("data-v-54151914"),e=e(),(0,a.Cn)(),e),n={class:"flex justify-between items-center"},m={class:"text-h4"},c={class:"q-mt-md"},u={class:"text-h6"},p=d((()=>(0,a._)("p",{class:"text-subtitle2 q-mb-none"},"Deadline",-1))),h={class:"text-grey"},g=["innerHTML"],f=d((()=>(0,a._)("div",null,null,-1))),b={class:"text-h6 text-grey q-mt-lg"},w={class:"text-subtitle1 text-grey-5"},_={class:"row q-pb-xl"},y={class:"flex column flex-center q-pr-md q-pt-md"},j=["src"],q={class:"text-center text-caption text-black",style:{"max-width":"100px"}},W=["href"],k={class:"text-h6 text-grey q-mt-lg"},x={class:"text-subtitle1 text-grey-5"},v={class:"row q-pb-xl"},C={class:"flex column flex-center q-pr-md q-pt-md"},U={class:"text-center text-caption text-black",style:{"max-width":"100px"}},P=["href"],V={key:0,class:"text-h6"},I={key:1,class:"text-subtitle1 text-grey-5"},Z=d((()=>(0,a._)("img",{src:r()},null,-1))),F={key:2,class:"row"},Q=d((()=>(0,a._)("img",{src:r()},null,-1))),D={key:0,class:"text-h6"},z={key:1,class:"text-subtitle1 text-grey-5"},L=d((()=>(0,a._)("img",{src:r()},null,-1))),T={key:2,class:"row"},M=d((()=>(0,a._)("img",{src:r()},null,-1)));function R(e,t,l,o,r,d){const R=(0,a.up)("breadcrmps"),A=(0,a.up)("q-btn"),S=(0,a.up)("q-card"),N=(0,a.up)("q-badge"),O=(0,a.up)("q-avatar"),H=(0,a.up)("q-icon"),$=(0,a.up)("q-file"),B=(0,a.up)("q-banner"),E=(0,a.up)("q-popup-proxy"),K=(0,a.up)("q-item-label"),Y=(0,a.up)("q-item-section"),G=(0,a.up)("q-item"),J=(0,a.up)("q-select"),X=(0,a.up)("q-popup-edit"),ee=(0,a.up)("q-chip"),te=(0,a.up)("confirm"),le=(0,a.up)("q-dialog"),ae=(0,a.up)("modal"),se=(0,a.up)("q-page"),ie=(0,a.up)("q-spinner"),oe=(0,a.Q2)("close-popup");return r.loading?((0,a.wg)(),(0,a.j4)(se,{key:1,class:"flex flex-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(ie)])),_:1})):((0,a.wg)(),(0,a.j4)(se,{key:0,class:"q-pa-md"},{default:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a._)("div",null,[(0,a._)("p",m,(0,s.zw)(r.project.name),1),(0,a.Wm)(R,{map:r.crumps},null,8,["map"])]),(0,a.Wm)(A,{onClick:t[0]||(t[0]=e=>r.dialogue=!0),color:"grey-5",flat:"",icon:"edit",round:""})]),(0,a._)("div",c,[(0,a.Wm)(S,{class:"q-pa-md"},{default:(0,a.w5)((()=>[(0,a._)("p",u,(0,s.zw)(r.project.name),1),p,(0,a._)("p",h,(0,s.zw)(r.project.plannedEndDate&&r.project.plannedEndDate.split("T")[0]),1),(0,a._)("p",{class:"text-grey desc",innerHTML:r.project.description},null,8,g)])),_:1})]),f,(0,a.wy)((0,a._)("p",b,"Uploaded images",512),[[i.F8,0!==r.images.length]]),(0,a.Wm)(S,{class:"q-pa-md q-mt-md"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("p",w,"No images has been uploaded.",512),[[i.F8,0===r.images.length]]),(0,a.wy)((0,a._)("div",_,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.images,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[(0,a._)("div",y,[(0,a.Wm)(O,{square:"",size:"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{style:{background:"transparent !important"},transparent:"",floating:""},{default:(0,a.w5)((()=>[(0,a.Wm)(A,{onClick:t=>(r.fileId=e.id,r.confirm=!0),round:"",size:"7.5px",icon:"delete",color:"negative",class:"absolute-top-right"},null,8,["onClick"])])),_:2},1024),(0,a._)("img",{src:e.url},null,8,j)])),_:2},1024),(0,a._)("p",q,(0,s.zw)(e.name),1),(0,a._)("a",{href:e.url,target:"_blank"},[(0,a.Wm)(A,{class:"text-primary bg-blue-1",unelevated:"",label:"Download","no-caps":""})],8,W)])])))),128))],512),[[i.F8,0!==r.images.length]]),(0,a.Wm)(A,{label:"Upload images",icon:"backup",color:"grey","no-caps":"",push:"",flat:"",unelevated:"",class:"absolute-bottom-right q-mr-sm q-mb-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Wm)(B,null,{default:(0,a.w5)((()=>[(0,a.Wm)($,{filter:d.checkType,onRejected:d.onRejectedImage,clearable:"",label:"Image",outlined:"",modelValue:r.image,"onUpdate:modelValue":t[1]||(t[1]=e=>r.image=e)},{prepend:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"attach_file"})])),_:1},8,["filter","onRejected","modelValue"]),(0,a.wy)((0,a.Wm)(A,{label:"Upload",onClick:t[2]||(t[2]=e=>{d.addProjectFile("image"),r.image=null}),disable:!r.image,"no-caps":"",flat:"",color:"primary",class:"q-mt-sm",size:"md"},null,8,["disable"]),[[oe]])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.wy)((0,a._)("p",k,"Uploaded files",512),[[i.F8,0!==r.files.length]]),(0,a.Wm)(S,{class:"q-pa-md q-mt-md"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("p",x,"No files has been uploaded.",512),[[i.F8,0===r.files.length]]),(0,a.wy)((0,a._)("div",v,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.files,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[(0,a._)("div",C,[(0,a.Wm)(O,{square:"",size:"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{style:{background:"transparent !important"},transparent:"",floating:""},{default:(0,a.w5)((()=>[(0,a.Wm)(A,{onClick:t=>(r.fileId=e.id,r.confirm=!0),round:"",size:"7.5px",icon:"delete",color:"negative",class:"absolute-top-right"},null,8,["onClick"])])),_:2},1024),(0,a.Wm)(H,{color:"grey",name:"attach_file"})])),_:2},1024),(0,a._)("p",U,(0,s.zw)(e.name),1),(0,a._)("a",{href:e.url,target:"_blank"},[(0,a.Wm)(A,{class:"text-primary bg-blue-1",unelevated:"",label:"Download","no-caps":""})],8,P)])])))),128))],512),[[i.F8,0!==r.files.length]]),(0,a.Wm)(A,{label:"Upload files",icon:"backup",color:"grey","no-caps":"",push:"",flat:"",unelevated:"",class:"absolute-bottom-right q-mr-sm q-mb-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Wm)(B,null,{default:(0,a.w5)((()=>[(0,a.Wm)($,{filter:d.checkFileType,onRejected:d.onRejectedFile,clearable:"",label:"File",outlined:"",modelValue:r.file,"onUpdate:modelValue":t[3]||(t[3]=e=>r.file=e)},{prepend:(0,a.w5)((()=>[(0,a.Wm)(H,{name:"attach_file"})])),_:1},8,["filter","onRejected","modelValue"]),(0,a.wy)((0,a.Wm)(A,{label:"Upload",onClick:t[4]||(t[4]=e=>{d.addProjectFile("file"),r.file=null}),"no-caps":"",disable:!r.file,flat:"",color:"primary",class:"q-mt-sm",size:"md"},null,8,["disable"]),[[oe]])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(S,{class:"q-pa-md q-mt-lg"},{default:(0,a.w5)((()=>[0!==r.project.leaderUsers.length?((0,a.wg)(),(0,a.iD)("p",V,"Assigned leaders")):(0,a.kq)("",!0),0===r.project.leaderUsers.length?((0,a.wg)(),(0,a.iD)("p",I,"No leaders assigned.")):(0,a.kq)("",!0),(0,a.Wm)(A,{onClick:t[8]||(t[8]=e=>d.getLeaderOptions(r.project)),class:"absolute-bottom-right q-mr-sm q-mb-sm",size:"10px",color:"primary",round:"",icon:"add",unelevated:"",rounded:"","no-caps":""},{default:(0,a.w5)((()=>[(0,a.Wm)(X,{modelValue:r.leaders,"onUpdate:modelValue":t[7]||(t[7]=e=>r.leaders=e),style:{"min-width":"15rem !important"},cover:!1,offset:[0,10]},{default:(0,a.w5)((e=>[(0,a.Wm)(J,{rules:[e=>null!==e||"This field is required"],"bg-color":"white",outlined:"",counter:"",multiple:"","use-chips":"",modelValue:r.leaders,"onUpdate:modelValue":t[5]||(t[5]=e=>r.leaders=e),options:r.options,label:"Choose leaders",disable:0===r.options.length,hint:0===r.options.length?"All users has been added":""},{option:(0,a.w5)((e=>[(0,a.Wm)(G,(0,s.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(Y,{class:"avatar-list"},{default:(0,a.w5)((()=>[(0,a.Wm)(O,{class:"q-mr-xs",size:"30px"},{default:(0,a.w5)((()=>[Z])),_:1}),(0,a.Wm)(K,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:2},1032,["rules","modelValue","options","disable","hint"]),(0,a.wy)((0,a.Wm)(A,{onClick:t[6]||(t[6]=e=>d.addProjectLeaders(r.project.id)),"no-caps":"",flat:"",label:"submit",color:"primary",disable:0===r.leaders.length},null,8,["disable"]),[[oe]])])),_:1},8,["modelValue"])])),_:1}),0!==r.project.leaderUsers.length?((0,a.wg)(),(0,a.iD)("div",F,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.project.leaderUsers,((e,t)=>((0,a.wg)(),(0,a.j4)(ee,{onRemove:t=>{r.leaderId=e.userId,r.deleteLeaderConfirm=!0},key:e.userId,removable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(O,null,{default:(0,a.w5)((()=>[Q])),_:1}),(0,a.Uk)(" "+(0,s.zw)(e.name),1)])),_:2},1032,["onRemove"])))),128))])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(S,{class:"q-pa-md q-mt-lg"},{default:(0,a.w5)((()=>[0!==r.project.memberUsers.length?((0,a.wg)(),(0,a.iD)("p",D,"Assigned members")):(0,a.kq)("",!0),0===r.project.memberUsers.length?((0,a.wg)(),(0,a.iD)("p",z,"No members assigned.")):(0,a.kq)("",!0),(0,a.Wm)(A,{onClick:t[12]||(t[12]=e=>d.getUserOptions(r.project)),class:"absolute-bottom-right q-mr-sm q-mb-sm",size:"10px",color:"primary",round:"",icon:"add",unelevated:"",rounded:"","no-caps":""},{default:(0,a.w5)((()=>[(0,a.Wm)(X,{modelValue:r.members,"onUpdate:modelValue":t[11]||(t[11]=e=>r.members=e),style:{"min-width":"15rem !important"},cover:!1,offset:[0,10]},{default:(0,a.w5)((e=>[(0,a.Wm)(J,{ref:"clientRef",rules:[e=>null!==e||"This field is required"],"bg-color":"white",outlined:"",counter:"",multiple:"","use-chips":"",modelValue:r.members,"onUpdate:modelValue":t[9]||(t[9]=e=>r.members=e),options:r.options,label:"Choose members",disable:0===r.options.length,hint:0===r.options.length?"All users has been added":""},{option:(0,a.w5)((e=>[(0,a.Wm)(G,(0,s.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(Y,{class:"avatar-list"},{default:(0,a.w5)((()=>[(0,a.Wm)(O,{class:"q-mr-xs",size:"30px"},{default:(0,a.w5)((()=>[L])),_:1}),(0,a.Wm)(K,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:2},1032,["rules","modelValue","options","disable","hint"]),(0,a.wy)((0,a.Wm)(A,{onClick:t[10]||(t[10]=e=>d.addProjectMembers(r.project.id)),"no-caps":"",flat:"",label:"submit",color:"primary",disable:0===r.members.length},null,8,["disable"]),[[oe]])])),_:1},8,["modelValue"])])),_:1}),0!==r.project.memberUsers.length?((0,a.wg)(),(0,a.iD)("div",T,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.project.memberUsers,((e,t)=>((0,a.wg)(),(0,a.j4)(ee,{onRemove:t=>{r.memberId=e.userId,r.deleteMemberConfirm=!0},key:e.userId,removable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(O,null,{default:(0,a.w5)((()=>[M])),_:1}),(0,a.Uk)(" "+(0,s.zw)(e.name),1)])),_:2},1032,["onRemove"])))),128))])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(le,{modelValue:r.confirm,"onUpdate:modelValue":t[13]||(t[13]=e=>r.confirm=e),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(te,{onConfirm:d.deleteProjectFile},null,8,["onConfirm"])])),_:1},8,["modelValue"]),(0,a.Wm)(le,{modelValue:r.deleteLeaderConfirm,"onUpdate:modelValue":t[15]||(t[15]=e=>r.deleteLeaderConfirm=e),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(te,{onConfirm:t[14]||(t[14]=e=>d.deleteLeader({id:r.project.id,leaders:[r.leaderId]}))})])),_:1},8,["modelValue"]),(0,a.Wm)(le,{modelValue:r.deleteMemberConfirm,"onUpdate:modelValue":t[17]||(t[17]=e=>r.deleteMemberConfirm=e),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(te,{onConfirm:t[16]||(t[16]=e=>d.deleteMember({id:r.project.id,members:[r.memberId]}))})])),_:1},8,["modelValue"]),(0,a.Wm)(le,{seamless:"",position:"right",modelValue:r.dialogue,"onUpdate:modelValue":t[19]||(t[19]=e=>r.dialogue=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,{onCloseDialogue:t[18]||(t[18]=e=>{d.getProject(),r.dialogue=!1}),actionType:"Edit",body:r.project},null,8,["body"])])),_:1},8,["modelValue"])])),_:1}))}var A=l(52),S=l.n(A),N=l(6303),O=l(8288);const H=(0,a._)("div",{class:"text-h6"},"Are you sure?",-1);function $(e,t){const l=(0,a.up)("q-card-section"),s=(0,a.up)("q-btn"),i=(0,a.up)("q-card-actions"),o=(0,a.up)("q-card"),r=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(o,{style:{width:"300px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[H])),_:1}),(0,a.Wm)(i,{align:"right"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(s,{flat:"",label:"Cancel",color:"negative"},null,512),[[r]]),(0,a.wy)((0,a.Wm)(s,{flat:"",label:"Delete",onClick:t[0]||(t[0]=t=>e.$emit("confirm")),color:"primary"},null,512),[[r]])])),_:1})])),_:1})}var B=l(151),E=l(5589),K=l(9367),Y=l(2165),G=l(677),J=l(7518),X=l.n(J);const ee={};ee.render=$;const te=ee;X()(ee,"components",{QCard:B.Z,QCardSection:E.Z,QCardActions:K.Z,QBtn:Y.Z}),X()(ee,"directives",{ClosePopup:G.Z});var le=l(3617);const ae={components:{breadcrmps:N.Z,modal:O.Z,confirm:te},data(){return{project:{leaderUsers:[],memberUsers:[]},members:[],leaders:[],options:[],confirm:!1,deleteMemberConfirm:!1,deleteLeaderConfirm:!1,dialogue:!1,loading:!1,memberId:null,leaderId:null,files:[],images:[],fileId:null,crumps:[{id:1,name:"OneConnect",icon:"home",path:"/"},{id:2,name:"Project",icon:void 0,path:"/projects"}],file:null,image:null}},computed:{...(0,le.rn)("userStore",["users"])},methods:{...(0,le.nv)("projectStore",["addFiles","addProjectMember","deleteProjectMember","addProjectLeader","deleteProjectLeader"]),...(0,le.nv)("userStore",["getUsers"]),async deleteProjectFile(){await S().post("https://onconnect-backend-api.herokuapp.com/api/v1/projects/removeFile",{id:this.project.id,attachId:this.fileId},{headers:{Authorization:localStorage.getItem("accessToken")}});this.getProject()},checkType(e){return e.filter((e=>e.type.includes("image")))},checkFileType(e){return e.filter((e=>!e.type.includes("image")))},onRejectedImage(){this.$q.notify({type:"negative",message:"Only images are allowed!"})},onRejectedFile(){this.$q.notify({type:"negative",message:"Only files are allowed!"})},async addProjectMembers(e){let t=[];for(let l=0;l<this.members.length;l++)t.push(this.members[l].id);await this.addProjectMember({id:e,members:t}),this.members=[],await this.getProject()},async deleteMember(e){console.log(e),await this.deleteProjectMember(e),await this.getProject()},getUserOptions(e){let t=[],l=[];this.options=[],setTimeout((()=>{if(e){for(let a=0;a<this.users.length;a++){for(let t=0;t<e.memberUsers.length;t++)Number(e.memberUsers[t].userId)===Number(this.users[a].id)&&l.push({id:this.users[a].id,label:this.users[t].name});t.push({id:this.users[a].id,label:this.users[a].name})}this.options=t.filter((({id:e})=>!l.some((({id:t})=>t===e))))}}),200)},async addProjectLeaders(e){let t=[];for(let l=0;l<this.leaders.length;l++)t.push(this.leaders[l].id);await this.addProjectLeader({id:e,leaders:t}),this.leaders=[],await this.getProject()},async deleteLeader(e){await this.deleteProjectLeader(e),await this.getProject()},getLeaderOptions(e){let t=[],l=[];this.options=[],setTimeout((()=>{if(e){for(let a=0;a<this.users.length;a++){for(let t=0;t<e.leaderUsers.length;t++)Number(e.leaderUsers[t].userId)===Number(this.users[a].id)&&l.push({id:this.users[a].id,label:this.users[t].name});t.push({id:this.users[a].id,label:this.users[a].name})}this.options=t.filter((({id:e})=>!l.some((({id:t})=>t===e))))}}),200)},async addProjectFile(e){let t=new FormData;t.append("id",this.project.id),"file"===e?t.append("files",this.file):t.append("files",this.image),await this.addFiles(t),this.getProject()},async getProject(){let e=await S().get(`https://onconnect-backend-api.herokuapp.com/api/v1/projects/${this.$route.params.id}`,{headers:{Authorization:localStorage.getItem("accessToken")}});this.project=e.data.data,this.crumps[1].name=e.data.data.name,this.fileAndImages()},fileAndImages(){this.files=[],this.images=[];for(let e=0;e<this.project.attachments.length;e++)this.project.attachments[e].contentType.includes("image")?this.images.push(this.project.attachments[e]):this.files.push(this.project.attachments[e])}},async mounted(){this.loading=!0,await this.getProject(),await this.getUsers(),this.loading=!1}};var se=l(4379),ie=l(5096),oe=l(9721),re=l(3944),de=l(5607),ne=l(4974),me=l(4554),ce=l(1289),ue=l(3314),pe=l(3414),he=l(2035),ge=l(2350),fe=l(7030),be=l(6778),we=l(6833);ae.render=R,ae.__scopeId="data-v-54151914";const _e=ae;X()(ae,"components",{QPage:se.Z,QBtn:Y.Z,QCard:B.Z,QAvatar:ie.Z,QBadge:oe.Z,QPopupProxy:re.Z,QBanner:de.Z,QFile:ne.Z,QIcon:me.Z,QPopupEdit:ce.Z,QSelect:ue.Z,QItem:pe.Z,QItemSection:he.Z,QItemLabel:ge.Z,QChip:fe.Z,QDialog:be.Z,QSpinner:we.Z}),X()(ae,"directives",{ClosePopup:G.Z})}}]);