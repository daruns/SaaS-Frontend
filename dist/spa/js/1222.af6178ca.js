"use strict";(self["webpackChunkoc_front_end"]=self["webpackChunkoc_front_end"]||[]).push([[1222],{83916:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ke});i(90246);var o=i(83673),l=i(62323);const a={class:"full-width flex justify-between items-center q-px-md header-height-standard",style:{"border-bottom":"1px solid lightgrey"}},s=(0,o._)("div",{class:"text-h4"},"Expenses",-1),n={class:"flex items-center"},d={class:"q-px-md"},u={class:"text-h6",style:{"font-size":"15px",margin:"0 !important"}};function m(e,t,i,m,r,c){const p=(0,o.up)("q-btn"),h=(0,o.up)("breadcrumps"),g=(0,o.up)("router-link"),y=(0,o.up)("q-td"),v=(0,o.up)("q-icon"),b=(0,o.up)("q-item-section"),f=(0,o.up)("q-item"),x=(0,o.up)("q-separator"),w=(0,o.up)("q-list"),_=(0,o.up)("q-menu"),V=(0,o.up)("q-tr"),q=(0,o.up)("q-table"),C=(0,o.up)("modal"),k=(0,o.up)("q-dialog"),I=(0,o.up)("q-page"),D=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(I,{class:"q-py-none q-my-none"},{default:(0,o.w5)((()=>[(0,o._)("div",a,[s,(0,o._)("div",n,[(0,o.Wm)(p,{onClick:t[0]||(t[0]=e=>{r.action="Add",r.prompt=!0}),color:"primary",label:"Create Record",unelevated:"",rounded:"","no-caps":""})])]),(0,o.Wm)(h,{class:"q-pa-md full-width",map:r.crumps},null,8,["map"]),(0,o._)("div",d,[(0,o.Wm)(q,{rows:e.expenses,columns:r.columns,"row-key":"id",loading:r.loading,flat:"",class:"bg-secondary q-pt-md"},{body:(0,o.w5)((t=>[(0,o.Wm)(V,{class:(0,l.C_)(t.rowIndex%2!==0&&"bg-white"),props:t},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{key:"expenseNumber",props:t},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{style:{color:"black"},to:`/finance/expense/${t.row.id}`},{default:(0,o.w5)((()=>[(0,o._)("p",u,(0,l.zw)(t.row.expenseNumber),1)])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,o.Wm)(y,{key:"description",innerHTML:t.row.description,props:t},null,8,["innerHTML","props"]),(0,o.Wm)(y,{key:"date",props:t},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(c.dateConversion(t.row.date)),1)])),_:2},1032,["props"]),(0,o.Wm)(y,{key:"dueDate",props:t},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(c.dateConversion(t.row.dueDate)),1)])),_:2},1032,["props"]),(0,o.Wm)(y,{key:"status",props:t},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(t.row.status),1)])),_:2},1032,["props"]),(0,o.Wm)(y,{key:"totalAmount",props:t},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(t.row.totalAmount),1)])),_:2},1032,["props"]),(0,o.Wm)(y,{key:"actions",props:t},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{to:`/finance/expense/${t.row.id}`},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{dense:"","text-color":"dark",round:"",flat:"",icon:"visibility"})])),_:2},1032,["to"]),(0,o.Wm)(p,{disable:"Paid"===t.row.status,dense:"",round:"",flat:"",icon:"more_vert"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{"transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{style:{"min-width":"75px"}},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(f,{onClick:i=>e.deleteExpense({id:t.row.id}),style:{},clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{class:"flex flex-center"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{name:"delete",color:"negative",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[D]]),(0,o.Wm)(x),(0,o.wy)((0,o.Wm)(f,{onClick:e=>c.edit(t.row),clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{class:"flex flex-center"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{name:"edit",color:"warning",size:"xs"})])),_:1})])),_:2},1032,["onClick"]),[[D]])])),_:2},1024)])),_:2},1024)])),_:2},1032,["disable"])])),_:2},1032,["props"])])),_:2},1032,["class","props"])])),_:1},8,["rows","columns","loading"])]),(0,o.Wm)(k,{seamless:"",position:"right",modelValue:r.prompt,"onUpdate:modelValue":t[2]||(t[2]=e=>r.prompt=e),persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{onCloseDialogue:t[1]||(t[1]=e=>r.prompt=!1),action:r.action,body:r.body},null,8,["action","body"])])),_:1},8,["modelValue"])])),_:1})}var r=i(93617),c=i(25616),p=i(46303),h=i(98880);const g={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},y={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},v={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},b={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},f=(0,o._)("div",{class:"q-ma-none absolute q-ml-sm text-grey-7",style:{"z-index":"10","font-size":"12px","line-height":"20px","font-weight":"400"}},"Expense date",-1),x={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},w=(0,o._)("div",{class:"q-ma-none absolute q-ml-sm text-grey-7",style:{"z-index":"10","font-size":"12px","line-height":"20px","font-weight":"400"}},"Due date",-1),_={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},V={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},q={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},C={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},k={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},I={class:"col-lg-3 col-md-4 col-sm-6 col-xs-12 q-pa-sm"},D={class:"col-xl-4 col-lg-4 col-md-4 col-sm-4 col-xs-12 q-pa-md"},W={class:"col-12 q-pa-sm"},M=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{class:"text-left"},"#"),(0,o._)("th",{class:"text-left"},"Item"),(0,o._)("th",{class:"text-left"},"Description"),(0,o._)("th",{class:"text-left"},"Unit price"),(0,o._)("th",{class:"text-left"},"Quantity"),(0,o._)("th",{class:"text-left"},"Amount"),(0,o._)("th")])],-1),L={style:{"min-width":"20rem !important"}},T={style:{width:"7rem !important"}},U={style:{width:"5rem !important"}},O={style:{width:"7rem !important"}},Z={style:{width:"2rem !important"}},E={class:"q-pa-sm col-12"},N={class:"row bg-white q-pa-lg",style:{"border-radius":"4px"}},P=(0,o._)("div",{class:"col-9"},null,-1),R={class:"col-lg-3 col-md-3 col-sm-6 col-xs-12 q-pb-md column q-gutter-sm"},S={class:"q-pa-sm col-12"};function z(e,t,i,a,s,n){const d=(0,o.up)("q-toolbar-title"),u=(0,o.up)("q-btn"),m=(0,o.up)("q-toolbar"),r=(0,o.up)("q-select"),c=(0,o.up)("q-input"),p=(0,o.up)("Datepicker"),z=(0,o.up)("q-uploader"),Q=(0,o.up)("q-item-label"),A=(0,o.up)("q-item-section"),F=(0,o.up)("q-badge"),Y=(0,o.up)("q-item"),H=(0,o.up)("q-markup-table"),$=(0,o.up)("q-editor"),j=(0,o.up)("q-card-section"),B=(0,o.up)("q-card"),J=(0,o.up)("supplierModal"),G=(0,o.up)("q-dialog"),K=(0,o.up)("taxModal"),X=(0,o.up)("categoryModal"),ee=(0,o.up)("paymentTypeModal"),te=(0,o.up)("q-layout"),ie=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(te,{style:{width:"80vw !important"}},{default:(0,o.w5)((()=>[(0,o.Wm)(B,{class:"bg-secondary",style:{"max-width":"80vw","min-height":"100vh"},flat:"",square:""},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{class:"bg-grey-3 header-height-standard",style:{position:"sticky !important",top:"0","z-index":"15"}},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(i.action+" ")+" Expense ",1)])),_:1}),(0,o.wy)((0,o.Wm)(u,{icon:"close",flat:"",round:"",dense:""},null,512),[[ie]])])),_:1}),(0,o.Wm)(j,{class:"row q-pa-md"},{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,l.C_)("Add"===i.action?"col-xl-8 col-lg-8 col-md-8 col-sm-8 col-xs-12 q-pa-sm row":"col-12 row q-pa-sm")},[(0,o._)("div",g,[(0,o.Wm)(r,{style:{"min-width":"10rem !important"},outlined:"",modelValue:s.invoice.category,"onUpdate:modelValue":t[1]||(t[1]=e=>s.invoice.category=e),options:s.categoriesOptiopns,loading:s.categoryLoading,"bg-color":"white",label:"Category",ref:"categRef",rules:[e=>e&&e.length>0||"This field is required"],"bottom-slots":""},{hint:(0,o.w5)((()=>[(0,o.Wm)(u,{size:"sm",dense:"","no-caps":"",flat:"",color:"primary",label:"Add Cattegory",onClick:t[0]||(t[0]=e=>s.categoryDialogue=!0)})])),_:1},8,["modelValue","options","loading","rules"])]),(0,o._)("div",y,[(0,o.Wm)(r,{"bg-color":"white",outlined:"",clearable:"",modelValue:s.supplier,"onUpdate:modelValue":t[3]||(t[3]=e=>s.supplier=e),options:s.options,label:"Choose supplier",loading:s.supplierLoading,"bottom-slots":""},{hint:(0,o.w5)((()=>[(0,o.Wm)(u,{size:"sm",dense:"","no-caps":"",flat:"",color:"primary",label:"Add Supplier",onClick:t[2]||(t[2]=e=>s.supplierDialogue=!0)})])),_:1},8,["modelValue","options","loading"])]),(0,o._)("div",v,[(0,o.Wm)(c,{ref:"billingRef","bg-color":"white",outlined:"",modelValue:s.invoice.billingAddress,"onUpdate:modelValue":t[4]||(t[4]=e=>s.invoice.billingAddress=e),label:"Billing address"},null,8,["modelValue"])]),(0,o._)("div",b,[f,(0,o.Wm)(p,{autoApply:"",modelValue:s.invoice.date,"onUpdate:modelValue":t[5]||(t[5]=e=>s.invoice.date=e),showNowButton:""},null,8,["modelValue"])]),(0,o._)("div",x,[w,(0,o.Wm)(p,{autoApply:"",modelValue:s.invoice.dueDate,"onUpdate:modelValue":t[6]||(t[6]=e=>s.invoice.dueDate=e),showNowButton:""},null,8,["modelValue"])]),(0,o._)("div",_,[(0,o.Wm)(r,{"bg-color":"white",outlined:"",modelValue:s.tax,"onUpdate:modelValue":[t[8]||(t[8]=e=>s.tax=e),n.updateTaxRateValue],options:s.taxOptions,loading:s.taxLoading,clearable:"",label:"Choose Tax","bottom-slots":""},{hint:(0,o.w5)((()=>[(0,o.Wm)(u,{size:"sm",dense:"","no-caps":"",flat:"",color:"primary",label:"Add Tax",onClick:t[7]||(t[7]=e=>s.taxDialogue=!0)})])),_:1},8,["modelValue","options","loading","onUpdate:modelValue"])]),(0,o._)("div",V,[(0,o.Wm)(r,{ref:"paymentRef","bg-color":"white",outlined:"",modelValue:s.paymentMethod,"onUpdate:modelValue":t[10]||(t[10]=e=>s.paymentMethod=e),options:s.paymentOptions,clearable:"",loading:s.paymentLoading,label:"Choose Payment Method","bottom-slots":""},{hint:(0,o.w5)((()=>[(0,o.Wm)(u,{size:"sm",dense:"","no-caps":"",flat:"",color:"primary",label:"Add Payment Type",onClick:t[9]||(t[9]=e=>s.paymentDialogue=!0)})])),_:1},8,["modelValue","options","loading"])]),(0,o._)("div",q,[(0,o.Wm)(r,{ref:"statusRef",rules:[e=>e&&e.length>0||"This field is required"],"bg-color":"white",outlined:"",modelValue:s.invoice.status,"onUpdate:modelValue":t[11]||(t[11]=e=>s.invoice.status=e),disable:"Paid"===s.invoice.status,options:["Paid","Not paid","Sent"],label:"Status"},null,8,["rules","modelValue","disable"])]),(0,o._)("div",C,[(0,o.Wm)(r,{"bg-color":"white",outlined:"",modelValue:s.invoice.currencyCode,"onUpdate:modelValue":[t[12]||(t[12]=e=>s.invoice.currencyCode=e),n.updateCurrencyCode],"option-value":"value",ref:"currencyCodeRef",rules:[e=>e&&e.length>0||"This field is required"],options:s.currencyOptions,label:"Currency code"},null,8,["modelValue","onUpdate:modelValue","rules","options"])]),(0,o._)("div",k,[(0,o.Wm)(c,{"bg-color":"white",mask:"#",disable:s.invoice.currencyCode===s.defaultCurrency,"fill-mask":"0","reverse-fill-mask":"","model-value":"Number",outlined:"",modelValue:s.invoice.exchangeRate,"onUpdate:modelValue":t[13]||(t[13]=e=>s.invoice.exchangeRate=e),label:"Exchange rate"},null,8,["disable","modelValue"])]),(0,o._)("div",I,[(0,o.Wm)(c,{"bg-color":"white",mask:"#","fill-mask":"0","reverse-fill-mask":"","model-value":"Number",outlined:"",modelValue:s.bankFee,"onUpdate:modelValue":t[14]||(t[14]=e=>s.bankFee=e),label:"Bank Fee"},null,8,["modelValue"])])],2),(0,o.wy)((0,o._)("div",D,[(0,o.wy)((0,o.Wm)(z,{"max-files":"1","max-file-size":"1048576",class:"col-12 fit","max-total-size":"1048576",label:"Attachment",onRemoved:t[15]||(t[15]=e=>{n.saveFiles(e)}),"hide-upload-btn":"",onAdded:t[16]||(t[16]=e=>{n.saveFiles(e)}),multiple:!1},null,512),[[h.F8,"Add"===i.action]])],512),[[h.F8,"Add"===i.action]]),(0,o._)("div",W,[(0,o.Wm)(H,{flat:"",bordered:"",class:"q-mt-xl"},{default:(0,o.w5)((()=>[M,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.invoice.items,((e,t)=>((0,o.wg)(),(0,o.iD)("tr",{key:t},[(0,o._)("td",null,(0,l.zw)(t+1),1),(0,o._)("td",null,[(0,o.Wm)(r,{"use-input":"","input-debounce":"0",style:{"min-width":"10rem !important"},outlined:"",modelValue:s.invoice.items[t].label,"onUpdate:modelValue":[e=>s.invoice.items[t].label=e,e=>n.updateItem(e,t)],options:s.itemOptions,loading:s.joinedItemsLoading,"bg-color":"white","hide-selected":"","fill-input":"",label:"Item",onFilter:(e,i,o)=>n.filterItems(e,t,i,o)},{option:(0,o.w5)((e=>[(0,o.Wm)(Y,(0,l.vs)((0,o.F4)(e.itemProps)),{default:(0,o.w5)((()=>[(0,o.Wm)(A,null,{default:(0,o.w5)((()=>[(0,o.Wm)(Q,{innerHTML:e.opt.label},null,8,["innerHTML"])])),_:2},1024),(0,o.Wm)(A,{side:""},{default:(0,o.w5)((()=>[(0,o.Wm)(F,{dense:"",innerHTML:e.opt.category},null,8,["innerHTML"])])),_:2},1024)])),_:2},1040)])),_:2},1032,["modelValue","onUpdate:modelValue","options","loading","onFilter"])]),(0,o._)("td",L,[(0,o.Wm)(c,{"bg-color":"white",outlined:"",modelValue:s.invoice.items[t].description,"onUpdate:modelValue":e=>s.invoice.items[t].description=e},null,8,["modelValue","onUpdate:modelValue"])]),(0,o._)("td",T,[(0,o.Wm)(c,{style:{width:"7rem !important"},mask:"#","fill-mask":"0","reverse-fill-mask":"","model-value":"Number","bg-color":"white",onInputCapture:e=>n.evaluate(t),outlined:"",modelValue:s.invoice.items[t].unitPrice,"onUpdate:modelValue":e=>s.invoice.items[t].unitPrice=e},null,8,["onInputCapture","modelValue","onUpdate:modelValue"])]),(0,o._)("td",U,[(0,o.Wm)(c,{style:{width:"5rem !important"},"bg-color":"white",mask:"#","fill-mask":"0","reverse-fill-mask":"","model-value":"Number",onInputCapture:e=>n.evaluate(t),outlined:"",modelValue:s.invoice.items[t].qty,"onUpdate:modelValue":e=>s.invoice.items[t].qty=e},null,8,["onInputCapture","modelValue","onUpdate:modelValue"])]),(0,o._)("td",O,[(0,o.Wm)(c,{style:{width:"7rem !important"},"bg-color":"white",readonly:"",outlined:"",modelValue:s.invoice.items[t].amount,"onUpdate:modelValue":e=>s.invoice.items[t].amount=e,type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),(0,o._)("td",Z,[(0,o.Wm)(u,{"no-caps":"",icon:"add",flat:"",color:"primary",onClick:e=>n.addItemToInvoiceTable(t)},null,8,["onClick"]),0!==t?((0,o.wg)(),(0,o.j4)(u,{key:0,flat:"",icon:"delete",size:"md",color:"negative",onClick:e=>{s.invoice.items.splice(t,1),n.findTotal()}},null,8,["onClick"])):(0,o.kq)("",!0)])])))),128))])])),_:1})]),(0,o._)("div",E,[(0,o._)("div",N,[P,(0,o._)("div",R,[(0,o.Wm)(c,{mask:"#",type:"number","model-value":"Number","fill-mask":"0","reverse-fill-mask":"",readonly:"",modelValue:s.subtotal,"onUpdate:modelValue":t[17]||(t[17]=e=>s.subtotal=e),label:"Subtotal"},null,8,["modelValue"]),(0,o.Wm)(c,{mask:"#","model-value":"Number","fill-mask":"0","reverse-fill-mask":"",onInputCapture:n.updateValues,modelValue:s.invoice.taxRate,"onUpdate:modelValue":t[18]||(t[18]=e=>s.invoice.taxRate=e),label:"Tax Rate%"},null,8,["onInputCapture","modelValue"]),(0,o.Wm)(c,{mask:"#","model-value":"Number","fill-mask":"0","reverse-fill-mask":"",label:"Discount%",onInputCapture:n.updateValues,modelValue:s.invoice.discount,"onUpdate:modelValue":t[19]||(t[19]=e=>s.invoice.discount=e)},null,8,["onInputCapture","modelValue"]),(0,o.Wm)(c,{mask:"#",type:"number","model-value":"Number","fill-mask":"0","reverse-fill-mask":"",readonly:"",modelValue:s.total,"onUpdate:modelValue":t[20]||(t[20]=e=>s.total=e),label:"Grand total"},null,8,["modelValue"])])])]),(0,o._)("div",S,[(0,o.Wm)($,{modelValue:s.invoice.description,"onUpdate:modelValue":t[21]||(t[21]=e=>s.invoice.description=e),dense:!0,toolbar:[[{label:e.$q.lang.editor.align,icon:e.$q.iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]}],["bold","italic","strike","underline","subscript","superscript"],["token","hr","link","custom_btn"],["print","fullscreen"],[{label:e.$q.lang.editor.formatting,icon:e.$q.iconSet.editor.formatting,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{label:e.$q.lang.editor.fontSize,icon:e.$q.iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:e.$q.lang.editor.defaultFont,icon:e.$q.iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","toolbar"])])])),_:1})])),_:1}),(0,o.Wm)(m,{style:{position:"sticky !important",bottom:"0","z-index":"5"},class:"bg-grey-3"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(u,{loading:s.loading,onClick:n.submit,label:"Submit","no-caps":"",type:"reset",color:"primary",unelevated:"",class:"full-width"},null,8,["loading","onClick"]),[[ie,s.close]])])),_:1}),(0,o.Wm)(G,{seamless:"",position:"right",modelValue:s.supplierDialogue,"onUpdate:modelValue":t[24]||(t[24]=e=>s.supplierDialogue=e),persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(J,{onCloseDialogue:t[22]||(t[22]=e=>{s.supplierDialogue=!1,n.mountSuppliers()}),onUpdateForInvoice:t[23]||(t[23]=e=>n.mountSuppliers()),actionType:"Add"})])),_:1},8,["modelValue"]),(0,o.Wm)(G,{seamless:"",position:"right",modelValue:s.taxDialogue,"onUpdate:modelValue":t[27]||(t[27]=e=>s.taxDialogue=e),persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(K,{onCloseDialogue:t[25]||(t[25]=e=>{s.taxDialogue=!1,n.mountTaxes()}),onUpdateForInvoice:t[26]||(t[26]=e=>n.mountTaxes()),actionType:"Add"})])),_:1},8,["modelValue"]),(0,o.Wm)(G,{seamless:"",position:"right",modelValue:s.categoryDialogue,"onUpdate:modelValue":t[30]||(t[30]=e=>s.categoryDialogue=e),persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(X,{onCloseDialogue:t[28]||(t[28]=e=>{s.categoryDialogue=!1,n.mountCategories()}),onUpdateForInvoice:t[29]||(t[29]=e=>n.mountCategories()),actionType:"Add"})])),_:1},8,["modelValue"]),(0,o.Wm)(G,{seamless:"",position:"right",modelValue:s.paymentDialogue,"onUpdate:modelValue":t[33]||(t[33]=e=>s.paymentDialogue=e),persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(ee,{onCloseDialogue:t[31]||(t[31]=e=>{s.paymentDialogue=!1,n.mountPaymentTypes()}),onUpdateForInvoice:t[32]||(t[32]=e=>n.mountPaymentTypes()),action:"Add"})])),_:1},8,["modelValue"])])),_:1})}var Q=i(14093),A=i(9906),F=i(11966),Y=i(68716),H=i(16565),$=i(94789);const j={itemId:null,qty:0,category:!1,label:"",unitPrice:0,amount:0},B="USD",J={props:["action","body","invoiceType"],data(){return{defaultCurrency:B,scndEmpty:j,file:null,close:!1,isLoaded:!1,supplierDialogue:!1,taxDialogue:!1,categoryDialogue:!1,selectItemDialogue:!1,bankFee:null,paymentDialogue:!1,categoryLoading:!1,supplierLoading:!1,joinedItemsLoading:!1,currencyCodesLoading:!1,taxLoading:!1,paymentLoading:!1,loading:!1,id:null,subtotal:0,total:0,options:[],options0:[],categoriesOptiopns:[],currencyOptions:[B,"IQD"],taxOptions:[],paymentOptions:[],itemOptions:[],tax:null,paymentMethod:null,clientEMAIL:"",supplier:null,invoice:{supplierId:null,date:"",exchangeRate:null,discount:null,billingAddress:"",currencyCode:B,status:"Sent",paymentMethodId:null,taxId:null,taxRate:null,dueDate:"",bankFee:null,category:null,description:"Description",items:[]}}},computed:{...(0,r.rn)("financeStore",["suppliers","joinedCategories","taxes","paymentMethods","currencyCodes"]),...(0,r.rn)("accountingStore",["joinedItems"])},components:{supplierModal:Q.Z,taxModal:A.Z,selectItemModal:H.Z,paymentTypeModal:Y.Z,Datepicker:$.Z,categoryModal:F.Z},methods:{updateCurrencyCode(e){e===this.defaultCurrency&&(this.invoice.exchangeRate=0)},updateTaxRateValue(e){this.invoice.taxRate=null===e||void 0===e?void 0:e.rate,this.updateValues()},addItemToInvoiceTable(e){this.scndEmpty.itemId=null,this.scndEmpty.qty=0,this.scndEmpty.category=!1,this.scndEmpty.label="",this.scndEmpty.unitPrice=0,this.scndEmpty.amount=0,this.invoice.items.push({...this.scndEmpty}),this.scndEmpty=j},updateItem(e,t){const i=e;console.log("updateitems: ------ ",e),"object"===typeof i&&(this.invoice.items[t]=i),this.updateOptions(),this.evaluate(t)},filterItems(e,t,i,o){this.updateOptions();let l=this.itemOptions.filter((t=>t.label.indexOf(e)>-1));i((i=>{l.length>0&&(this.itemOptions=l),this.invoice.items[t].label=e}))},saveFiles(e){this.file=e[0]},async findTotal(){this.total=0;for(let e=0;e<this.invoice.items.length;e++)this.total+=this.invoice.items[e].amount;this.subtotal=parseFloat(this.total).toFixed(2),this.total=parseFloat(this.total+this.total*Number(this.invoice.taxRate/100)-this.invoice.discount/100*this.total).toFixed(2)},async updateValues(){setTimeout((async()=>{await this.findTotal()}),100)},evaluate(e){setTimeout((async()=>{0===Number(this.invoice.items[e].qty)&&"inventoryItem"!==this.invoice.items[e].category?this.invoice.items[e].amount=1*Number(this.invoice.items[e].unitPrice):this.invoice.items[e].amount=Number(this.invoice.items[e].unitPrice)*Number(this.invoice.items[e].qty)}),100),this.updateValues()},...(0,r.nv)("financeStore",["addExpense","editExpense","deleteInvoice","getSuppliers","getJoinedCategories","getPaymentMethods","getTaxes","getCurrencyCodes"]),...(0,r.nv)("accountingStore",["getJoinedItems"]),async submit(){var e,t,i;if(this.$refs.categRef.validate(),this.$refs.currencyCodeRef.validate(),this.$refs.statusRef.validate(),console.log(this.invoice.currencyCode),!(this.$refs.statusRef.hasError||this.$refs.currencyCodeRef.hasError||this.$refs.categRef.hasError))if(""!==this.invoice.items[0].label){this.loading=!0,this.invoice.discount=Number(this.invoice.discount)/100,this.invoice.taxRate=Number(this.invoice.taxRate)/100,this.invoice.bankFee=Number(this.bankFee),this.invoice.supplierId=this.supplier?Number(null===(e=this.supplier)||void 0===e?void 0:e.id):null,this.invoice.taxId=this.tax?Number(null===(t=this.tax)||void 0===t?void 0:t.id):null,this.invoice.paymentMethodId=this.paymentMethod?Number(null===(i=this.paymentMethod)||void 0===i?void 0:i.id):null,this.invoice.category=this.body.category,this.invoice.discount=Number(this.invoice.discount),this.invoice.exchangeRate=Number(this.invoice.exchangeRate),this.invoice.date=c.ZP.formatDate(new Date(this.invoice.date),"YYYY-MM-DD HH:mm"),this.invoice.dueDate=c.ZP.formatDate(new Date(this.invoice.dueDate),"YYYY-MM-DD HH:mm");for(let e=0;e<this.invoice.items.length;e++)this.invoice.items[e]={itemId:this.invoice.items[e].itemId,name:this.invoice.items[e].label,qty:Number(this.invoice.items[e].qty)||1,unitPrice:Number(this.invoice.items[e].unitPrice)||1,description:this.invoice.items[e].description};if("Edit"===this.action)try{await this.editExpense({invoice:{...this.invoice,id:this.body.id},file:this.file}),this.close=!0}catch(o){this.$q.notify({type:"negative",message:"something went wrong",color:"negative",position:"top",timeout:"500"})}else try{await this.addExpense({invoice:this.invoice,file:this.file}),this.close=!0}catch(o){this.$q.notify({type:"negative",message:"something went wrong",color:"negative",position:"top",timeout:"500"})}this.$emit("closeDialogue"),this.loading=!1}else alert("Please choose at least one item !")},async delInvoice(e){this.deleteInvoice(e)},mountSuppliers(){this.supplierLoading=!0,this.options=[];let e=this;this.getSuppliers().then((()=>{e.supplierLoading=!1,e.updateOptions()}))},mountTaxes(){this.taxLoading=!0,this.taxOptions=[];let e=this;this.getTaxes().then((()=>{e.taxLoading=!1,e.updateOptions()}))},mountCategories(){this.categoryLoading=!0,this.categoriesOptiopns=[];let e=this;this.getJoinedCategories().then((()=>{e.categoryLoading=!1,e.updateOptions()}))},mountPaymentTypes(){this.paymentLoading=!0,this.paymentOptions=[];let e=this;this.getPaymentMethods().then((()=>{e.paymentLoading=!1,e.updateOptions()}))},selectItemModal(){this.joinedItemsLoading=!0,this.itemOptions=[];let e=this;this.getJoinedItems().then((()=>{e.joinedItemsLoading=!1,e.updateOptions()}))},updateOptions(){var e,t;this.categoriesOptiopns.length=0,this.itemOptions.length=0,this.categoriesOptiopns=[],this.options=[],this.itemOptions=[],this.taxOptions=[],this.paymentOptions=[],this.currencyOptions=[],this.joinedCategories.forEach((e=>{this.categoriesOptiopns.push({label:e.name,id:e.id})})),this.joinedItems.forEach((e=>{this.itemOptions.push({label:e.name,itemId:e.id,category:e.category,description:e.description,qty:e.qty,unitPrice:e.unitPrice})})),this.taxes.forEach((e=>{this.taxOptions.push({label:e.name,id:e.id,rate:parseFloat(e.rate).toFixed(2)})})),this.paymentMethods.forEach((e=>{this.paymentOptions.push({label:e.name,id:e.id})})),this.suppliers.forEach((e=>{this.options.push({label:e.name,id:e.id})})),null===(e=this.currencyCodes)||void 0===e||null===(t=e.currencyCodes)||void 0===t||t.forEach(((e,t)=>{this.currencyOptions.push(e)}))},dateConversion(e){let t=new Date(e);return t.setHours(t.getHours()-3),c.ZP.formatDate(t,"YYYY-MM-DD HH:mm")}},async mounted(){this.invoice.items.push({...this.scndEmpty}),this.isLoaded=!0,this.currencyCodesLoading=!0,this.categoryLoading=!0,this.paymentLoading=!0,this.taxLoading=!0,this.joinedItemsLoading=!0,this.supplierLoading=!0;let e=this;if(this.getCurrencyCodes().then((()=>{e.currencyCodesLoading=!1,e.updateOptions()})),this.getJoinedCategories().then((()=>{e.categoryLoading=!1,e.updateOptions()})),this.getPaymentMethods().then((()=>{e.paymentLoading=!1,e.updateOptions()})),this.getTaxes().then((()=>{e.taxLoading=!1,e.updateOptions()})),this.getJoinedItems().then((()=>{e.joinedItemsLoading=!1,e.updateOptions()})),this.getSuppliers().then((()=>{e.supplierLoading=!1,e.updateOptions()})),console.log("body: ",this.body),"Edit"===this.action){var t,i,o,l,a,s,n,d,u;this.invoice.supplierId=this.body.supplier?this.body.supplier.id:null,this.invoice.date=this.dateConversion(this.body.date),this.invoice.dueDate=this.dateConversion(this.body.dueDate),this.invoice.billingAddress=this.body.billingAddress,this.invoice.paymentMethod=this.body.paymentMethod,this.invoice.category=this.body.category,this.bankFee=Number(this.body.bankFee),this.invoice.description=this.body.description,this.invoice.currencyCode=this.body.currencyCode,this.invoice.status=this.body.status,this.invoice.exchangeRate=Number(this.body.exchangeRate),this.invoice.discount=Number(this.body.discount),this.invoice.taxRate=Number(this.body.taxRate),this.supplier={label:null===(t=this.body.supplier)||void 0===t?void 0:t.name,id:null===(i=this.body.supplier)||void 0===i?void 0:i.id},this.invoice.taxId=null===(o=this.body.tax)||void 0===o?void 0:o.id,this.invoice.paymentMethodId=null===(l=this.body.paymentMethod)||void 0===l?void 0:l.id,this.paymentMethod={id:null===(a=this.body.paymentMethod)||void 0===a?void 0:a.id,label:null===(s=this.body.paymentMethod)||void 0===s?void 0:s.name},this.tax={id:null===(n=this.body.tax)||void 0===n?void 0:n.id,label:null===(d=this.body.tax)||void 0===d?void 0:d.name,rate:null===(u=this.body.tax)||void 0===u?void 0:u.rate},await this.updateValues();for(let e=0;e<this.body.expenseItems.length;e++)e+1!==this.body.expenseItems.length&&this.invoice.items.push({itemId:null,qty:null,category:null,label:{label:"",itemId:null,category:null,description:""},unitPrice:null,amount:0,description:""}),this.invoice.items[e].itemId=this.body.expenseItems[e].itemId,this.invoice.items[e].qty=Number(this.body.expenseItems[e].qty),this.invoice.items[e].category=this.body.expenseItems[e].category,this.invoice.items[e].label=this.body.expenseItems[e].name,this.invoice.items[e].unitPrice=Number(this.body.expenseItems[e].unitPrice),this.invoice.items[e].amount=Number(this.invoice.items[e].qty*this.invoice.items[e].unitPrice).toFixed(2),this.invoice.items[e].description=this.body.expenseItems[e].description;await this.updateValues()}else this.invoice.date=c.ZP.formatDate(new Date,"YYYY-MM-DD HH:mm"),this.invoice.dueDate=c.ZP.formatDate(new Date,"YYYY-MM-DD HH:mm");this.isLoaded=!1}};var G=i(19214),K=i(10151),X=i(39570),ee=i(13747),te=i(2165),ie=i(25589),oe=i(63314),le=i(64689),ae=i(568),se=i(30481),ne=i(83414),de=i(52035),ue=i(2350),me=i(69721),re=i(89989),ce=i(46778),pe=i(60677),he=i(7518),ge=i.n(he);J.render=z;const ye=J;ge()(J,"components",{QLayout:G.Z,QCard:K.Z,QToolbar:X.Z,QToolbarTitle:ee.Z,QBtn:te.Z,QCardSection:ie.Z,QSelect:oe.Z,QInput:le.Z,QUploader:ae.Z,QMarkupTable:se.Z,QItem:ne.Z,QItemSection:de.Z,QItemLabel:ue.Z,QBadge:me.Z,QEditor:re.Z,QDialog:ce.Z}),ge()(J,"directives",{ClosePopup:pe.Z});const ve={props:["type"],data(){return{prompt:!1,loading:!1,action:"",body:{},crumps:[{id:1,name:"OneConnect",icon:"home",path:"/"},{id:2,name:"Expense",icon:"attach_money",path:"/finance/expenses"}],columns:[{name:"expenseNumber",align:"left",label:"Expense number",field:"expenseNumber"},{name:"description",align:"left",label:"Description",field:"description"},{name:"date",align:"left",label:"Expense date",field:"date"},{name:"dueDate",align:"left",label:"Due date",field:"dueDate"},{name:"status",align:"left",label:"Status",field:"status"},{name:"totalAmount",align:"left",label:"Total amount",field:"totalAmount"},{name:"actions",align:"left",label:"Actions",field:"actions"}]}},computed:{...(0,r.rn)("financeStore",["expenses"])},components:{modal:ye,breadcrumps:p.Z},methods:{...(0,r.nv)("financeStore",["getExpenses","deleteExpense"]),rowColor(e){if(e.rowIndex%2!==0)return"background: #fff;"},dateConversion(e){let t=new Date(e);return t.setHours(t.getHours()-3),c.ZP.formatDate(t,"YYYY-MM-DD HH:mm")},edit(e){this.body=e,this.action="Edit",this.prompt=!0}},async mounted(){await this.getExpenses()}};var be=i(24379),fe=i(57678),xe=i(18186),we=i(83884),_e=i(20811),Ve=i(27011),qe=i(24554),Ce=i(65869);ve.render=m;const ke=ve;ge()(ve,"components",{QPage:be.Z,QBtn:te.Z,QTable:fe.Z,QTr:xe.Z,QTd:we.Z,QMenu:_e.Z,QList:Ve.Z,QItem:ne.Z,QItemSection:de.Z,QIcon:qe.Z,QSeparator:Ce.Z,QDialog:ce.Z}),ge()(ve,"directives",{ClosePopup:pe.Z})}}]);